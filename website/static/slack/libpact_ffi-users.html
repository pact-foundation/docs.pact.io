<html><body><style>
			* {
				font-family:sans-serif;
			}
			body {
				text-align:center;
				padding:1em;
			}
			.messages {
				width:100%;
				max-width:700px;
				text-align:left;
				display:inline-block;
			}
			.messages img {
				background-color:rgb(248,244,240);
				width:36px;
				height:36px;
				border-radius:0.2em;
				display:inline-block;
				vertical-align:top;
				margin-right:0.65em;
			}
			.messages .time {
				display:inline-block;
				color:rgb(200,200,200);
				margin-left:0.5em;
			}
			.messages .username {
				display:inline-block;
				font-weight:600;
				line-height:1;
			}
			.messages .message {
				display:inline-block;
				vertical-align:top;
				line-height:1;
				width:calc(100% - 3em);
			}
			.messages .message .msg {
				line-height:1.5;
			}
		</style><div class="messages"><div><a id="1629718089.000200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629718089.000200" ><div class="time">2021-08-23 11:28</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629718089.000300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629718089.000300" ><div class="time">2021-08-23 11:28</div></a><div class="msg">set the channel description: For developers working with libpact_ffi</div></div></div><br/>
<div><a id="1629718106.000500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629718106.000500" ><div class="time">2021-08-23 11:28</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629718614.000700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629718614.000700" ><div class="time">2021-08-23 11:36</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629718623.000900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629718623.000900" ><div class="time">2021-08-23 11:37</div></a><div class="msg">:wave:</div></div></div><br/>
<div><a id="1629718655.001100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629718655.001100" ><div class="time">2021-08-23 11:37</div></a><div class="msg">:wave: Welcome!</div></div></div><br/>
<div><a id="1629718669.001400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629718669.001400" ><div class="time">2021-08-23 11:37</div></a><div class="msg">Thanks :slightly_smiling_face:</div></div></div><br/>
<div><a id="1629718702.002500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629718702.002500" ><div class="time">2021-08-23 11:38</div></a><div class="msg">Good idea, I was using bits of conversations in various places</div></div></div><br/>
<div><a id="1629718707.002700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629718707.002700" ><div class="time">2021-08-23 11:38</div></a><div class="msg">I'm hoping this will be a good way to reduce re-discovery as people work with the ffi bindings</div></div></div><br/>
<div><a id="1629718719.003000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629718719.003000" ><div class="time">2021-08-23 11:38</div></a><div class="msg">Mee too :slightly_smiling_face:</div></div></div><br/>
<div><a id="1629718765.003200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1629718765.003200" ><div class="time">2021-08-23 11:39</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629718784.003400"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1629718784.003400" ><div class="time">2021-08-23 11:39</div></a><div class="msg">:wave:</div></div></div><br/>
<div><a id="1629719024.004400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719024.004400" ><div class="time">2021-08-23 11:43</div></a><div class="msg">Welcome!</div></div></div><br/>
<div><a id="1629719029.004600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629719029.004600" ><div class="time">2021-08-23 11:43</div></a><div class="msg">For sure! Matt and Ron especially must be quite tired of pasting the same links over and over :D</div></div></div><br/>
<div><a id="1629719053.004800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719053.004800" ><div class="time">2021-08-23 11:44</div></a><div class="msg">haha! Yes</div></div></div><br/>
<div><a id="1629719074.005300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719074.005300" ><div class="time">2021-08-23 11:44</div></a><div class="msg">We have the libpact_ffi verifier working end to end for pact-js (not released yet)</div></div></div><br/>
<div><a id="1629719116.006400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629719116.006400" ><div class="time">2021-08-23 11:45</div></a><div class="msg">Is there a "list" of current questions outstanding etc or just see what comes in?</div></div></div><br/>
<div><a id="1629719180.007300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719180.007300" ><div class="time">2021-08-23 11:46</div></a><div class="msg">I'm not aware of one - we're about to do the consumer bindings for pact-js</div></div></div><br/>
<div><a id="1629719185.007600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719185.007600" ><div class="time">2021-08-23 11:46</div></a><div class="msg">which I'm sure will generate questions</div></div></div><br/>
<div><a id="1629719214.008900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719214.008900" ><div class="time">2021-08-23 11:46</div></a><div class="msg">also maybe one outcome from having this channel might be some getting started documentation</div></div></div><br/>
<div><a id="1629719247.009900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719247.009900" ><div class="time">2021-08-23 11:47</div></a><div class="msg">The header files have quite a bit of documentation in them, but I didn't realise that to start with.</div></div></div><br/>
<div><a id="1629719285.010800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629719285.010800" ><div class="time">2021-08-23 11:48</div></a><div class="msg">Nice

I've been having a play with python but seem to be starting with trying to add to rust :thinking_face:

Have you used the pactffi_string_delete function? On my to-do list to add in before going too far</div></div></div><br/>
<div><a id="1629719311.011200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719311.011200" ><div class="time">2021-08-23 11:48</div></a><div class="msg">I haven't, because we don't currently get any strings back from the ffi.</div></div></div><br/>
<div><a id="1629719323.011400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719323.011400" ><div class="time">2021-08-23 11:48</div></a><div class="msg">but yes, it seems important</div></div></div><br/>
<div><a id="1629719331.011600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719331.011600" ><div class="time">2021-08-23 11:48</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-js-core/tree/master/src/verifier">https://github.com/pact-foundation/pact-js-core/tree/master/src/verifier</a></div></div></div><br/>
<div><a id="1629719375.012500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719375.012500" ><div class="time">2021-08-23 11:49</div></a><div class="msg">this is the verifier bound to JS. Interesting bits might be:

The mapper for the options to the CLI args that get passed in to the FFI binding:

<a href="https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/arguments.ts">https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/arguments.ts</a></div></div></div><br/>
<div><a id="1629719394.013000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719394.013000" ><div class="time">2021-08-23 11:49</div></a><div class="msg">and the part that gets the result back from the verifier:   <a href="https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/nativeVerifier.ts#L7">https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/nativeVerifier.ts#L7</a></div></div></div><br/>
<div><a id="1629719456.013700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629719456.013700" ><div class="time">2021-08-23 11:50</div></a><div class="msg">Also this might be directly useful - it downloads the libs for each arch:

<a href="https://github.com/pact-foundation/pact-js-core/blob/master/script/download-ffi.sh">https://github.com/pact-foundation/pact-js-core/blob/master/script/download-ffi.sh</a></div></div></div><br/>
<div><a id="1629722487.014100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629722487.014100" ><div class="time">2021-08-23 12:41</div></a><div class="msg">So, on the python side there is a python install_ffi_app function which will go and get them.
From a DRY pov, it could make sense to have for example a sh script like that in pact-reference and then say from the python Makefile just grab and execute that instead.
Here seems like a good place to start with asking other people from their respective languages as well if they think that would be a good idea :slightly_smiling_face:</div></div></div><br/>
<div><a id="1629722679.014400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629722679.014400" ><div class="time">2021-08-23 12:44</div></a><div class="msg">What did you think of the idea I posted in #pact-rust about trying to just expose as much as possible including data types via an FFI call?</div></div></div><br/>
<div><a id="1629725331.014700"><img src="https://avatars.slack-edge.com/2021-08-09/2361631297682_efc9a72070b3c52a3db7_72.jpg" /></a><div class="message"><div class="username">kyle.florence</div><a style="text-decoration: none" href="#1629725331.014700" ><div class="time">2021-08-23 13:28</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629726938.014900"><img src="https://avatars.slack-edge.com/2021-08-18/2394065273266_22752ed73b1fed0cfaf3_72.jpg" /></a><div class="message"><div class="username">andrew.patterson</div><a style="text-decoration: none" href="#1629726938.014900" ><div class="time">2021-08-23 13:55</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629727675.015100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1629727675.015100" ><div class="time">2021-08-23 14:07</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629727925.015200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629727925.015200" ><div class="time">2021-08-23 14:12</div></a><div class="msg">Oh, I haven't seen that! I'll check it out tomorrow - please feel free to hassle me if I don't report back</div></div></div><br/>
<div><a id="1629728061.015600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629728061.015600" ><div class="time">2021-08-23 14:14</div></a><div class="msg">The experience from pact-js is that pact users can be behind all manner of corporate firewalls / proxies, so bundling with the library for installation through the package manager is a much nicer experience. Of course, that doesn't work for all ecosystems - go, for example, I think enforces that libraries are only go code.</div></div></div><br/>
<div><a id="1629728621.015800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629728621.015800" ><div class="time">2021-08-23 14:23</div></a><div class="msg">Oh, I mean for the scripts to build from source rather than distribution if that's what you mean?
As in when you do a "make package" it will currently call the python function to download the libs from pact-reference, I'm suggesting it could be:
1. Makefile downloads the script which downloads the libs from pact-reference,
 2. Run that script to download libs from pact reference
Rather than just:
1. Makefile runs the python (or other code) to download the libs from pact-reference
Agreed about corp firewalls for end users</div></div></div><br/>
<div><a id="1629728800.016000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629728800.016000" ><div class="time">2021-08-23 14:26</div></a><div class="msg">Currently bemusing myself a little as after the "can I help with contributing some python code" my first two steps have been
? Here's some rust code, could we do this so I don't have to write python
? What about we don't write that in python and user a shell script so I don't have to write that in python
I can do python Dev, honest! :joy:</div></div></div><br/>
<div><a id="1629733297.016300"><img src="https://avatars.slack-edge.com/2021-07-26/2338440068672_28662fba9507e261930c_72.png" /></a><div class="message"><div class="username">matt682</div><a style="text-decoration: none" href="#1629733297.016300" ><div class="time">2021-08-23 15:41</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629759339.016500"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1629759339.016500" ><div class="time">2021-08-23 22:55</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629760991.016800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629760991.016800" ><div class="time">2021-08-23 23:23</div></a><div class="msg">:wave:</div></div></div><br/>
<div><a id="1629761007.017300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629761007.017300" ><div class="time">2021-08-23 23:23</div></a><div class="msg">thanks Tim - it was definitely time!</div></div></div><br/>
<div><a id="1629762721.017500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629762721.017500" ><div class="time">2021-08-23 23:52</div></a><div class="msg">&gt; Makefile downloads the script which downloads the libs from pact-reference,
I'm nervous about doing "download this script then run it" in CI. I've been thinking about writing some automatic actions for pact-js to do things like making sure that some boilerplate files (eg CONTRIBUTING.md) are in sync across all the JS repos - perhaps something like that would work here? Also, I'm sure keeping boilerplate in sync across several repos must be a common problem with some nice solutions</div></div></div><br/>
<div><a id="1629764062.017800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629764062.017800" ><div class="time">2021-08-24 00:14</div></a><div class="msg">In sync would probably better, I know what you mean about nervous running some "unknown" script (I'm assuming pact-reference repo would have a bit more oversight etc than in general, but still a fair point)

I haven't looked into repo level sync :thinking_face: I was wondering about trying cookie cutter (python) to be able to re-apply a template to do something like that. I don't think any of the people I have worked with have fine across a good solution, given the state of many code bases :joy:</div></div></div><br/>
<div><a id="1629764258.018000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629764258.018000" ><div class="time">2021-08-24 00:17</div></a><div class="msg">:thinking_face: thinking CI, you could lint style warn if some files are out of sync at least</div></div></div><br/>
<div><a id="1629764305.018200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629764305.018200" ><div class="time">2021-08-24 00:18</div></a><div class="msg">Possibly this is where the monorepo answer comes in :)</div></div></div><br/>
<div><a id="1629765007.018400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629765007.018400" ><div class="time">2021-08-24 00:30</div></a><div class="msg">[also re the nervous downloading and running, you could ofc have the expected checksum etc of the file to make sure it doesn't change unexpectedly... But maybe at that point for something relatively simple it is back to more comfortable to just maintain when needed :thinking_face:]</div></div></div><br/>
<div><a id="1629768569.018600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629768569.018600" ><div class="time">2021-08-24 01:29</div></a><div class="msg">&gt; Possibly this is where the monorepo answer comes in :slightly_smiling_face:
Yeah. JS doesn't have any really nice solutions for monorepo - there's a pretty well liked tool called lerna, but I believe that requires yarn, and they've been doing some weirdly opinionated things that break dependency management because they disagree with the way npm works. Which is... fine academically, but not helpful in practice.</div></div></div><br/>
<div><a id="1629796304.018800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629796304.018800" ><div class="time">2021-08-24 09:11</div></a><div class="msg">"Creating a default community health file - GitHub Docs" <a href="https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/creating-a-default-community-health-file">https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/creating-a-default-community-health-file</a> this looks promising for the original use case you mentioned, I haven't tried it yet to see what it does exactly, if it uses then only on creation of automagically has them there, I'm sure GitHub could display then when viewing the repo if they aren't actually committed to the repo itself but I'm not sure how it could work when you pull it, and you probably want it visible in the actual repo</div></div></div><br/>
<div><a id="1629796324.019000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629796324.019000" ><div class="time">2021-08-24 09:12</div></a><div class="msg">At risk of going OT from FFI already :)</div></div></div><br/>
<div><a id="1629813412.019200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629813412.019200" ><div class="time">2021-08-24 13:56</div></a><div class="msg">Oh, that's awesome!</div></div></div><br/>
<div><a id="1629813414.019400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629813414.019400" ><div class="time">2021-08-24 13:56</div></a><div class="msg">Thanks</div></div></div><br/>
<div><a id="1629877405.019800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629877405.019800" ><div class="time">2021-08-25 07:43</div></a><div class="msg">Has anyone got the ffi libs working on windows yet?</div></div></div><br/>
<div><a id="1629877409.020000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629877409.020000" ><div class="time">2021-08-25 07:43</div></a><div class="msg">How did you do it?</div></div></div><br/>
<div><a id="1629877462.020200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629877462.020200" ><div class="time">2021-08-25 07:44</div></a><div class="msg">oh wait! I did it!</div></div></div><br/>
<div><a id="1629877583.020800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629877583.020800" ><div class="time">2021-08-25 07:46</div></a><div class="msg">I?m _assuming_ one of the Pact .NET people did. It?s fair to assume most .NET people still use Windows, right?</div></div></div><br/>
<div><a id="1629878004.021000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629878004.021000" ><div class="time">2021-08-25 07:53</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-js-core/runs/3419514964?check_suite_focus=true">https://github.com/pact-foundation/pact-js-core/runs/3419514964?check_suite_focus=true</a></div></div></div><br/>
<div><a id="1629878009.021300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629878009.021300" ><div class="time">2021-08-25 07:53</div></a><div class="msg">I think this might actually pass</div></div></div><br/>
<div><a id="1629878020.021700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629878020.021700" ><div class="time">2021-08-25 07:53</div></a><div class="msg">wait, this isn't a PM with matt. Apologies everyone!</div></div></div><br/>
<div><a id="1629878065.021800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629878065.021800" ><div class="time">2021-08-25 07:54</div></a><div class="msg">For those playing along at home, you need `.dll` not `.dll.lib`. From the error messages, I suspect that `.dll.lib` is for 32 bit? I am not sure.</div></div></div><br/>
<div><a id="1629878099.022100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629878099.022100" ><div class="time">2021-08-25 07:54</div></a><div class="msg">That seems likely</div></div></div><br/>
<div><a id="1629878140.022400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629878140.022400" ><div class="time">2021-08-25 07:55</div></a><div class="msg">:laughing:</div></div></div><br/>
<div><a id="1629878149.022700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1629878149.022700" ><div class="time">2021-08-25 07:55</div></a><div class="msg">it?s best everybody sees how the sausage is made Tim</div></div></div><br/>
<div><a id="1629883609.022800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629883609.022800" ><div class="time">2021-08-25 09:26</div></a><div class="msg">Any thoughts? As with the other discussion on the .sh files, no point in progressing if it's considered a bad idea, I'm happy either way but especially since I've not actually "contributed" anything yet I'm a little wary of doing too much without input on good/bad direction :slightly_smiling_face: I didn't actually get the data type part going yet (although maybe that's not so important), works pulling out the args, defaults [e.g. http], allowed values [e.g. log]. Although a different route could be that since clap supports pulling in the config from a yaml, maybe that could be a better starting point than deconstructing afterwards :thinking_face:</div></div></div><br/>
<div><a id="1629884796.023000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629884796.023000" ><div class="time">2021-08-25 09:46</div></a><div class="msg">Largely it looks like a good idea! I like the idea that it will possibly simplify / genericise implementation. I'm not sure it would work for all cases (we can't easily, for example, generate the typescript types for it from the binary - although maybe we could make tooling that could)</div></div></div><br/>
<div><a id="1629884908.023200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629884908.023200" ><div class="time">2021-08-25 09:48</div></a><div class="msg">I think there might be some work on getting the ffi verifier going in Python already - I think I remember seeing @elliottmurray talking about it some time</div></div></div><br/>
<div><a id="1629884911.023500"><img src="https://secure.gravatar.com/avatar/cd450b2d68eda3db907327277a40a7d9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">elliottmurray</div><a style="text-decoration: none" href="#1629884911.023500" ><div class="time">2021-08-25 09:48</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629884999.023700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629884999.023700" ><div class="time">2021-08-25 09:49</div></a><div class="msg">&gt;  a little wary of doing too much without input on good/bad direction
I'd say anything that makes it easier to get value into user's hands is a good thing. The question for me would be how much easier would it be with the proposed interface vs the current one</div></div></div><br/>
<div><a id="1629885062.023900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629885062.023900" ><div class="time">2021-08-25 09:51</div></a><div class="msg">In the case of the verifier, if you look at the mapping code I linked earlier, it's not actually a lot of work to map it without helpers. However, the work that we did there will have to be re-implemented in the other languages each time. Of course, if we had a generic interface, a mapping is still necessary, but it might be simpler? I don't know.</div></div></div><br/>
<div><a id="1629885090.024100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629885090.024100" ><div class="time">2021-08-25 09:51</div></a><div class="msg">Do you have a specific thing you want to contribute, or just "I'd like to help out"?</div></div></div><br/>
<div><a id="1629885342.024300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629885342.024300" ><div class="time">2021-08-25 09:55</div></a><div class="msg">(I probably have different guidance depending on the answer there)</div></div></div><br/>
<div><a id="1629885378.024500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629885378.024500" ><div class="time">2021-08-25 09:56</div></a><div class="msg">Of course, as with any open source project, the main answer is "work on something you'd enjoy working on" and "yes please, we'd love extra contributors"</div></div></div><br/>
<div><a id="1629886907.024700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629886907.024700" ><div class="time">2021-08-25 10:21</div></a><div class="msg">Thanks for replies :slightly_smiling_face:

So I'm looking at python mostly [most comfortable language of choice] - have already briefly spoken to Elliott who suggested taking a look at the FFI stuff. I just started getting distracted with Rust early on :smile: My area of expertise is generally going off on tangents while looking to improve CI/CD, processes etc. Largely happy to help with whatever, long time in a closed corp environment, seemed like time to try and "give something back". The original purpose right now was because I wanted to do event testing of some AWS code I'm working on and it wasn't possible in python yet, but I think Elliott has recently made progress with that against the previous spec implementation.

Yeah, generating the types was going to be a next [in a few steps time] step to look at, I'm not quite sure how to nicely do that on the python side yet either. I'm thinking there might not be an easy way to create them directly but it could always be a step when retrieving the FFI libs themselves via script or code during packaging to generate *something*. I like things that write themselves, but opinions vary on keeping it pure vs kind of a hack, hence question of does anyone else like the concept :slightly_smiling_face:
For example [very quick google search, could be a non starter], <a href="https://github.com/cwacek/python-jsonschema-objects">https://github.com/cwacek/python-jsonschema-objects</a> this looks like it could work to get a bit of JSON [which would come from FFI, maybe with a bit of mangling] that could be grabbed at package time, and then use that for creating your object with typing

For the CLI part, since it's just "dumbly" calling the binary with the args more or less, it looks fairly simple for the wrapper, but there's still the actual verifier to look at directly which will probably be tricker!</div></div></div><br/>
<div><a id="1629887098.025000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629887098.025000" ><div class="time">2021-08-25 10:24</div></a><div class="msg">For sure not much work to map it, it's the ongoing has anyone noticed that something has changed and now that needs updating across the various languages, as with the contributor.md example where you have the...and why is it ever so slightly different over here that I'm thinking about</div></div></div><br/>
<div><a id="1629887895.025200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629887895.025200" ><div class="time">2021-08-25 10:38</div></a><div class="msg">Ah, or like this for typescript [again, quick google search, may be no good] <a href="https://quicktype.io/typescript">https://quicktype.io/typescript</a> - from a maintainer pov I think I would be more comfortable with a flow of download an updated external lib and then be able to see in an e.g. generated json file in the repo that something has changed from last time, than hoping my tests cover sufficiently a potentially fragile link to a lib and having to figure out why it now segfaults</div></div></div><br/>
<div><a id="1629933230.025500"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1629933230.025500" ><div class="time">2021-08-25 23:13</div></a><div class="msg">On Widows, `.dll.lib` is a static library that contains all the code to load the shared library `.dll`</div></div></div><br/>
<div><a id="1629933258.025700"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1629933258.025700" ><div class="time">2021-08-25 23:14</div></a><div class="msg">With languages like C/C++ and .Net, you probably need both</div></div></div><br/>
<div><a id="1629951004.000100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629951004.000100" ><div class="time">2021-08-26 04:10</div></a><div class="msg">hmm... it worked ok in CI with only .dll</div></div></div><br/>
<div><a id="1629951017.000300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629951017.000300" ><div class="time">2021-08-26 04:10</div></a><div class="msg">maybe the tests aren't fully functioned</div></div></div><br/>
<div><a id="1629951044.000500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1629951044.000500" ><div class="time">2021-08-26 04:10</div></a><div class="msg">(the node ffi bindings pretend it's C)</div></div></div><br/>
<div><a id="1629952452.000700"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1629952452.000700" ><div class="time">2021-08-26 04:34</div></a><div class="msg">Node can deal with just the `dll`</div></div></div><br/>
<div><a id="1629975307.003500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629975307.003500" ><div class="time">2021-08-26 10:55</div></a><div class="msg">Ok so, I've made a couple more changes to the FFI method to pull out the Rust CLI args: <a href="https://github.com/mikegeeves/pact-reference/pull/1/files#diff-0683cbee93e01f96b27383c0954421fc5be638947d54311f880ba9b84ba2cb61">https://github.com/mikegeeves/pact-reference/pull/1/files#diff-0683cbee93e01f96b27383c0954421fc5be638947d54311f880ba9b84ba2cb61</a> - that seems to be complete enough for me to construct the CLI args on the python side (the only missing bit is types to identify an int or str, I didn't see how to cleanly pull out something from the validator but I think that's ok to skip for now).
Does that look helpful for use elsewhere? I'll wait a bit then hit the PR button :slightly_smiling_face:
&gt; $ pact-verifier --help
&gt; Usage: pact-verifier [OPTIONS]
&gt; 
&gt; Options:
&gt;   --enable-pending                Enables Pending Pacts
&gt;   --disable-ssl-verification      Disables validation of SSL certificates
&gt;   --publish                       Enables publishing of verification results
&gt;                                   back to the Pact Broker. Requires the
&gt;                                   broker-url and provider-version parameters.
&gt; 
&gt; &lt;snip&gt;
&gt;   --scheme [http|https]           Provider URI scheme (defaults to http)
&gt;   -p, --port TEXT                 Provider port (defaults to protocol default
&gt; &lt;snip&gt;</div></div></div><br/>
<div><a id="1629975497.004400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1629975497.004400" ><div class="time">2021-08-26 10:58</div></a><div class="msg">The Rust change would largely be redundant if using clap from yml config which could be shared around instead, but that doesn't look like it supports validators. Types are hard :slightly_smiling_face:</div></div></div><br/>
<div><a id="1629976120.004600"><img src="https://secure.gravatar.com/avatar/a68542ba58871006f35019efd2577fca.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">edanielsen</div><a style="text-decoration: none" href="#1629976120.004600" ><div class="time">2021-08-26 11:08</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1629976197.004800"><img src="https://secure.gravatar.com/avatar/a68542ba58871006f35019efd2577fca.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">edanielsen</div><a style="text-decoration: none" href="#1629976197.004800" ><div class="time">2021-08-26 11:09</div></a><div class="msg">*tsk* *tsk*</div></div></div><br/>
<div><a id="1630005944.005000"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630005944.005000" ><div class="time">2021-08-26 19:25</div></a><div class="msg">Nah .Net just needed the `.dll` not the `.lib` as well</div></div></div><br/>
<div><a id="1630005973.005200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630005973.005200" ><div class="time">2021-08-26 19:26</div></a><div class="msg">You bet your bottom dollar we do :smile:</div></div></div><br/>
<div><a id="1630006074.005400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630006074.005400" ><div class="time">2021-08-26 19:27</div></a><div class="msg">Ah I wrote basically an identical thing to this script here...

<a href="https://github.com/pact-foundation/pact-net/blob/feature/4.0.0/build/download-native-libs.sh">https://github.com/pact-foundation/pact-net/blob/feature/4.0.0/build/download-native-libs.sh</a></div></div></div><br/>
<div><a id="1630006200.005600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630006200.005600" ><div class="time">2021-08-26 19:30</div></a><div class="msg">And we also bundle those inside the NuGet packages that PactNet generates, then it'll extract the appropriate one for your arch/OS when you install the dependency</div></div></div><br/>
<div><a id="1630027818.006100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630027818.006100" ><div class="time">2021-08-27 01:30</div></a><div class="msg">I'm afraid I don't (yet) read rust, so I can't tell very easily. If this is what we talked about earlier, yes it sounds useful.</div></div></div><br/>
<div><a id="1630048751.006300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630048751.006300" ><div class="time">2021-08-27 07:19</div></a><div class="msg">It is yep. That's ok I don't write rust as such either :thinking_face:</div></div></div><br/>
<div><a id="1630054988.006600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630054988.006600" ><div class="time">2021-08-27 09:03</div></a><div class="msg">Hitting the big red button after adding a test</div></div></div><br/>
<div><a id="1630055057.006800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630055057.006800" ><div class="time">2021-08-27 09:04</div></a><div class="msg">Memory management and pointers etc scare me :open_mouth:</div></div></div><br/>
<div><a id="1630072658.007000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630072658.007000" ><div class="time">2021-08-27 13:57</div></a><div class="msg">Ohh, I forgot envs, but no more time right now :thinking_face:</div></div></div><br/>
<div><a id="1630077418.007200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630077418.007200" ><div class="time">2021-08-27 15:16</div></a><div class="msg">[added :D]</div></div></div><br/>
<div><a id="1630155164.013300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630155164.013300" ><div class="time">2021-08-28 12:52</div></a><div class="msg">Following on from half a conversation with @pact544 about output from the FFI lib, could something like slog-json be useful, rather than stdout style logging from fern?

Something structured could then mean less mangling on the python/net/js etc side, which can be quite brittle if doing anything other than passing straight through. There seems to be some JSON output as well sometimes but not quite sure exactly when/why/how, I need to look through the code.
Not sure if that's all in progress, already considered etc, any thoughts @uglyog / anyone else on how they are planning on working with/using the output :slightly_smiling_face:</div></div></div><br/>
<div><a id="1630195141.013400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1630195141.013400" ><div class="time">2021-08-28 23:59</div></a><div class="msg">:man-shrugging: I don't have any opinion either way. What ever works to make it easier for users to be able to provide information to diagnose issues.</div></div></div><br/>
<div><a id="1630205214.013600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630205214.013600" ><div class="time">2021-08-29 02:46</div></a><div class="msg">There's also this, which I'm planning to bring the rust library in line with:

<a href="https://github.com/pact-foundation/pact-specification#logging-in-a-pact-library">https://github.com/pact-foundation/pact-specification#logging-in-a-pact-library</a></div></div></div><br/>
<div><a id="1630224089.013900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630224089.013900" ><div class="time">2021-08-29 08:01</div></a><div class="msg">Tim: I couldn't see anything by that other than "tldr: make sure logging levels are correct" (which absolutely makes sense, I think info when the pact test fails but not the lib/usage is an important distinction to clarify, for example :+1:)</div></div></div><br/>
<div><a id="1630224258.014100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630224258.014100" ><div class="time">2021-08-29 08:04</div></a><div class="msg">Was that it or did I miss something? :slightly_smiling_face:</div></div></div><br/>
<div><a id="1630297721.014300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630297721.014300" ><div class="time">2021-08-30 04:28</div></a><div class="msg">Tim?s put together some notes about what we *should* be logging at each level, and the purpose of log levels for the framework</div></div></div><br/>
<div><a id="1630297778.014500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630297778.014500" ><div class="time">2021-08-30 04:29</div></a><div class="msg">if everyone agrees on the terminology and meaning of a `debug` log, then we can more confidently create useful end-to-end experiences (i.e. have the client and rust libraries use the same meanings for each of the log levels,)</div></div></div><br/>
<div><a id="1630297804.014700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630297804.014700" ><div class="time">2021-08-30 04:30</div></a><div class="msg">but yes, basically those kinds of distinctions is the point</div></div></div><br/>
<div><a id="1630297821.014900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630297821.014900" ><div class="time">2021-08-30 04:30</div></a><div class="msg">it?s separate from fixing the logging itself, so that we can more usefully present them to users</div></div></div><br/>
<div><a id="1630305357.015100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630305357.015100" ><div class="time">2021-08-30 06:35</div></a><div class="msg">Yep. I was mentioning it as a side point, since we're talking about logging and making the logs available to different frameworks</div></div></div><br/>
<div><a id="1630305370.015300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630305370.015300" ><div class="time">2021-08-30 06:36</div></a><div class="msg">btw, what we're planning to do in pact js is to defer all logging to rust.</div></div></div><br/>
<div><a id="1630305385.015500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630305385.015500" ><div class="time">2021-08-30 06:36</div></a><div class="msg">this is fine, because in js land people expect logs on standard out</div></div></div><br/>
<div><a id="1630305410.015700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630305410.015700" ><div class="time">2021-08-30 06:36</div></a><div class="msg">it won't work for ecosystems like .NET though.</div></div></div><br/>
<div><a id="1630305459.015900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630305459.015900" ><div class="time">2021-08-30 06:37</div></a><div class="msg">and structured output lets us do lots of nice QoL things - like "hey, you're missing state change definitions for these states, here's a template you can paste into your code"</div></div></div><br/>
<div><a id="1630305708.016100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630305708.016100" ><div class="time">2021-08-30 06:41</div></a><div class="msg">I'm not sure of the value of structures log output, I haven't thought too much but that's a good example</div></div></div><br/>
<div><a id="1630305722.016300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630305722.016300" ><div class="time">2021-08-30 06:42</div></a><div class="msg">Structured verifier output though would be preferable, separate to structured logs</div></div></div><br/>
<div><a id="1630305768.016500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630305768.016500" ><div class="time">2021-08-30 06:42</div></a><div class="msg">I like having a consistent way to show verification results - that will make docs much easier ("here's how to interpret verification failures")</div></div></div><br/>
<div><a id="1630311683.016900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630311683.016900" ><div class="time">2021-08-30 08:21</div></a><div class="msg">yep</div></div></div><br/>
<div><a id="1630321221.017100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630321221.017100" ><div class="time">2021-08-30 11:00</div></a><div class="msg">Yeah that's what I was thinking, around the filtering. If you've got the structured log output it's then much easier (at least less brittle) to for example filter out the content relevent to verification logs. Especially if that's going to be info level rather than error for example (I think info does make the most sense)

If it's a structured log you can then use the language native functionality to filter and say stream the info logs of type verification out to a file and error logs to stdout and so on, as well as being able to have a more language consistent user experience if it 'looks like python logs"
Architect hat on here, I can see a few user cases where it could be beneficial, at least imo, but if it wouldn't be seen as valuable across various languages then it's over engineering</div></div></div><br/>
<div><a id="1630321289.017400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630321289.017400" ><div class="time">2021-08-30 11:01</div></a><div class="msg">:100: for consistent terminology etc, principle of least surprise</div></div></div><br/>
<div><a id="1630321570.017600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630321570.017600" ><div class="time">2021-08-30 11:06</div></a><div class="msg">? I would definitely go for Tim's guidelines on making the log levels consistent
? If  a structured log output is desired it would be effective looking at both together I think, e.g. if something was an ERROR and now it's an INFO, it's a good time to make sure you have e.g. a way to distinguish it from "just letting you know" (easier than doing later)</div></div></div><br/>
<div><a id="1630323166.017900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630323166.017900" ><div class="time">2021-08-30 11:32</div></a><div class="msg">Yeah I think the main thing I've found with the consumer logs we have is that they're very Rust-like. There's lots of `dbg!` style output where it'll say things like `header: Some(Header::ContentType("application/json"))`.

That's kinda fine for me because I know Rust, but to someone who primarily does C# that's all a bit weird. Those aren't the types of things you're expecting to see to help you work out why your test is failing.

Its good for debugging the Rust code itself, but I'd prefer a more human-readable style to display to users in the general case, and perhaps a flag or log level which enables the very Rust-specific output for cases where we think it's a genuine bug in Pact rather than a user's test failing properly.</div></div></div><br/>
<div><a id="1630323236.018100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630323236.018100" ><div class="time">2021-08-30 11:33</div></a><div class="msg">Especially if people have only just got the hang of what ruby output looks like :grinning:</div></div></div><br/>
<div><a id="1630323273.018300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630323273.018300" ><div class="time">2021-08-30 11:34</div></a><div class="msg">that should be `trace` based on Tim?s output</div></div></div><br/>
<div><a id="1630323276.018500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630323276.018500" ><div class="time">2021-08-30 11:34</div></a><div class="msg">trace == for maintainers</div></div></div><br/>
<div><a id="1630323283.018700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630323283.018700" ><div class="time">2021-08-30 11:34</div></a><div class="msg">debug == for users to be able to debug the problem</div></div></div><br/>
<div><a id="1630323293.018900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630323293.018900" ><div class="time">2021-08-30 11:34</div></a><div class="msg">but probably the use of `dbg!` is not good anyway</div></div></div><br/>
<div><a id="1630323299.019100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630323299.019100" ><div class="time">2021-08-30 11:34</div></a><div class="msg">Hopefully the bug in pact should be covered by error with failing pacts as info, but there's going to be quite a bit in info</div></div></div><br/>
<div><a id="1630323346.019300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630323346.019300" ><div class="time">2021-08-30 11:35</div></a><div class="msg">Nod</div></div></div><br/>
<div><a id="1630323416.019500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630323416.019500" ><div class="time">2021-08-30 11:36</div></a><div class="msg">I think it's probably either using `{:?}` or just deriving Debug/Display and logging the object itself. You get a Rust-specific representation</div></div></div><br/>
<div><a id="1630323574.019700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630323574.019700" ><div class="time">2021-08-30 11:39</div></a><div class="msg">I've not actually implemented structured logs myself as such btw, but consuming AWS CloudWatch logs.. it'smuch nicer being able to filter and work with than just a stream of text, from my experience with them at least</div></div></div><br/>
<div><a id="1630323661.019900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630323661.019900" ><div class="time">2021-08-30 11:41</div></a><div class="msg">I suppose the flip side of "hiding away" that is a rust log is it could make it slightly more opaque for debugging rust problems, if the end user logs are formatted differently depending on which language they're wrapped in? Possible downside but I wouldn't consider it a huge one</div></div></div><br/>
<div><a id="1630391825.020100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630391825.020100" ><div class="time">2021-08-31 06:37</div></a><div class="msg">Last night I started on a PR to fix up the rust logs</div></div></div><br/>
<div><a id="1630391859.020300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630391859.020300" ><div class="time">2021-08-31 06:37</div></a><div class="msg">I don't know rust though</div></div></div><br/>
<div><a id="1630391864.020500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630391864.020500" ><div class="time">2021-08-31 06:37</div></a><div class="msg">so probably it's not correct</div></div></div><br/>
<div><a id="1630391931.020700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630391931.020700" ><div class="time">2021-08-31 06:38</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-reference/compare/fix/cleanup-log">https://github.com/pact-foundation/pact-reference/compare/fix/cleanup-log</a></div></div></div><br/>
<div><a id="1630392014.020900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630392014.020900" ><div class="time">2021-08-31 06:40</div></a><div class="msg">&gt; for debugging rust problems
This is the purpose of the logging guidelines. If the log levels are used consistently across frameworks, we can pass the log level between frameworks and not be concerned about exposing the "wrong" thing. `TRACE` is what we'd want to use for "super detailed, you have to know the framework source"</div></div></div><br/>
<div><a id="1630392786.021200"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1630392786.021200" ><div class="time">2021-08-31 06:53</div></a><div class="msg">I'll review that, but I'm going to warn you now that I work on the principle: info is for the user, debug is for me and trace for when you need to know what is going on in detail. I'm not going to trawl through trace level logging to try diagnose an issue a user is having.</div></div></div><br/>
<div><a id="1630393689.021400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630393689.021400" ><div class="time">2021-08-31 07:08</div></a><div class="msg">It's not actually ready for review yet (I'm not even sure it compiles)</div></div></div><br/>
<div><a id="1630393765.021600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630393765.021600" ><div class="time">2021-08-31 07:09</div></a><div class="msg">&gt; I work on the principle: info is for the user, debug is for me 
This is why I asked about the guidelines before publishing them :confused: I think it's very useful to have a distinction between user's debugging of their own tests and maintainers debugging the framework.</div></div></div><br/>
<div><a id="1630393840.021800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630393840.021800" ><div class="time">2021-08-31 07:10</div></a><div class="msg"><a href="https://pact-foundation.slack.com/archives/G9VHV9VJ9/p1624921762104900?thread_ts=1624876877.103800&amp;cid=G9VHV9VJ9">https://pact-foundation.slack.com/archives/G9VHV9VJ9/p1624921762104900?thread_ts=1624876877.103800&amp;cid=G9VHV9VJ9</a> :wink:</div></div></div><br/>
<div><a id="1630394028.022000"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1630394028.022000" ><div class="time">2021-08-31 07:13</div></a><div class="msg">I'm happy to accept some logging changes, but there are some debug level statements that are essential to stay at that level</div></div></div><br/>
<div><a id="1630397111.022200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630397111.022200" ><div class="time">2021-08-31 08:05</div></a><div class="msg">I would add, I think you could hopefully address both sides with a structured log approach :thinking_face: Filtering the "kind" for example</div></div></div><br/>
<div><a id="1630429055.022500"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1630429055.022500" ><div class="time">2021-08-31 16:57</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1630456562.022700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630456562.022700" ><div class="time">2021-09-01 00:36</div></a><div class="msg">@uglyog I think your need to have a debug mode that isn't `trace` is a good one, but I'm not sure how to support it while also having a good debug mode for users.  What about having an extra environment variable (eg `PACT_FRAMEWORK_DEBUG` that enabled extra debug logging?</div></div></div><br/>
<div><a id="1630456594.022900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630456594.022900" ><div class="time">2021-09-01 00:36</div></a><div class="msg">One problem in rust is that it seems to pick up the loggers from dependencies too - the final pass in the logging PR would have to be to match those to the guidelines as well.</div></div></div><br/>
<div><a id="1630456620.023100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630456620.023100" ><div class="time">2021-09-01 00:37</div></a><div class="msg">I really would like a common set of guidelines for all frameworks, so if the proposed guideline doesn't work for you, let's find one that does.</div></div></div><br/>
<div><a id="1630456774.023300"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1630456774.023300" ><div class="time">2021-09-01 00:39</div></a><div class="msg">Rust logging doesn't let you filter dependencies (like you can on JVM). I'm sure eventually there will be support for it, but for now we get all the async and HTTP framework logs as well.</div></div></div><br/>
<div><a id="1630457285.023500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630457285.023500" ><div class="time">2021-09-01 00:48</div></a><div class="msg">hm ok</div></div></div><br/>
<div><a id="1630457317.023700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630457317.023700" ><div class="time">2021-09-01 00:48</div></a><div class="msg">maybe we need a different way to control the logging for rust</div></div></div><br/>
<div><a id="1630457326.023900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630457326.023900" ><div class="time">2021-09-01 00:48</div></a><div class="msg">`PACT_LOG_LEVEL` or something</div></div></div><br/>
<div><a id="1630457442.024100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630457442.024100" ><div class="time">2021-09-01 00:50</div></a><div class="msg">@matt.fellows did you say you hit a way to filter the logs in rust? I thought you did, but I can't find it in a search</div></div></div><br/>
<div><a id="1630457567.024300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630457567.024300" ><div class="time">2021-09-01 00:52</div></a><div class="msg">:thumbsdown:</div></div></div><br/>
<div><a id="1630457668.024500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630457668.024500" ><div class="time">2021-09-01 00:54</div></a><div class="msg">I'm going to say structured logs again :smile: but I have no idea complexity involved to set that up in rust / the impact it could have elsewhere :thinking_face: (happy to look when there's next some time for a tangent but skill level might not be quite there)
If you could add in tags against the types of errors you were interested in then worst case it's pretty straightforward to filter out those that don't have it when you're consuming</div></div></div><br/>
<div><a id="1630457752.024700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1630457752.024700" ><div class="time">2021-09-01 00:55</div></a><div class="msg">Structured logs could probably mean you can then filter out unknown packages i.e. dependencies if needed, which would be a crude way to achieve the above</div></div></div><br/>
<div><a id="1630458662.024900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630458662.024900" ><div class="time">2021-09-01 01:11</div></a><div class="msg">yeah that's what I'm thinking, <a href="https://substrate.dev/rustdocs/latest/slog/struct.Filter.html">https://substrate.dev/rustdocs/latest/slog/struct.Filter.html</a> as far as I understand this, if you have your "normal" rust drain [outputting say to stdout/stderr], you can then take that drain and wrap it with a filter on each record to then e.g. output to your ffi log buffer?</div></div></div><br/>
<div><a id="1630466269.025200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630466269.025200" ><div class="time">2021-09-01 03:17</div></a><div class="msg">@mike.geeves064 possibly! Although, in pact-js, we don't want an FFI log buffer. pact-js wants Rust to log to stdout.

So, I think the requirements are:

? Able to be rolled into a buffer for .net (and presumably others)
? Able to be logged to stdout for js (and presumably others)
? Not to have users needing to wade through logs that concern the implementation when debugging tests
? Not to have Ron / maintainers needing to wade through other package's trace logs when debugging pact.
Have I got that last point right, @uglyog?</div></div></div><br/>
<div><a id="1630472715.025700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630472715.025700" ><div class="time">2021-09-01 05:05</div></a><div class="msg">Awesome!

@mike.geeves064: Would this be something you're interested to take a look at? I'll wade in if you're not interested, but don't want to step on your toes if you had an approach in mind and were excited about looking into it</div></div></div><br/>
<div><a id="1630480678.026000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1630480678.026000" ><div class="time">2021-09-01 07:17</div></a><div class="msg">I am always interested at playing with new things and excited about looking into them, this is the cause of many of my problems :joy:
Where does it fit with priorities and timelines? If you're also interested and excited and it's blocking right now then it's probably best to wade in, if it's more on the chore side but needs doing to meet the log consistency goal I can take a look when I've finished the first bit of adding in tests for the python CLI wrapper, at least to get an initial poc of what I was thinking to see if it looks like a sensible direction or not</div></div></div><br/>
<div><a id="1630503334.027700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1630503334.027700" ><div class="time">2021-09-01 13:35</div></a><div class="msg">I?m not keen to release pact-js backed by rust without sorting out the logging, but it?s not urgent- we have plenty to get on with and the only thing this blocks is the release</div></div></div><br/>
<div><a id="1630503425.027900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1630503425.027900" ><div class="time">2021-09-01 13:37</div></a><div class="msg">Yeah likewise. Without really good logging support I'm not keen on releasing PactNet either. If tests fail then you need really good info on why</div></div></div><br/>
<div><a id="1630508588.028300"><img src="https://avatars.slack-edge.com/2019-04-16/598047417795_e9da0dc72d754a910b9d_72.jpg" /></a><div class="message"><div class="username">pact-slack</div><a style="text-decoration: none" href="#1630508588.028300" ><div class="time">2021-09-01 15:03</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1630691284.028600"><img src="https://avatars.slack-edge.com/2021-09-02/2436890769143_b6ca69bb4c3a74385374_72.jpg" /></a><div class="message"><div class="username">kumasaka.tk</div><a style="text-decoration: none" href="#1630691284.028600" ><div class="time">2021-09-03 17:48</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1631140709.040500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631140709.040500" ><div class="time">2021-09-08 22:38</div></a><div class="msg">Getting closer to looking at logging, still a while off so let me know if it's needed too urgently to wait any longer :slightly_smiling_face:

I've finished the next steps on the python side, trying to use the generic verifier arg functionality. It's working ok along with a couple of tests for the CLI pact-verifier and first steps of the method via code. Could do with some input on approach before taking it much further though.
Currently it's fairly light on tests as I've offloaded all the logic of what args are needed onto the requirements of the FFI call to avoid duplication, which seems to work well. Need to see what else would actually be of value to include.

What I've been wrangling with today is what to then do that works nicely on the code (i.e. not CLI) side. There are a few options I've been experimenting with, attempting to generate classes via different methods based on the FFI call, I've tried:
? via a library "python_jsonschema_objects" which makes the class from some JSON
? using the dataclasses "make_dataclass"
? [now removed] attempting to use pickle/dill/cloudpickle to save a generated class via those two and other approaches, hoping to then be able to generate and load "later"
? finally making some source code
For comparison, very incomplete but functional alternatives are in here: <a href="https://github.com/mikegeeves/pact-python/pull/1/files#diff-323d43ee17cc3973c5557456838b3406710ad8f9d395fc3117acbe24b5ec9058">https://github.com/mikegeeves/pact-python/pull/1/files#diff-323d43ee17cc3973c5557456838b3406710ad8f9d395fc3117acbe24b5ec9058</a> with the source code generated by that option currently here: <a href="https://github.com/mikegeeves/pact-python/pull/1/files#diff-cc76c1ff6a766e7d39a30eb0af4b35ec4d003594940b09bc295668426724a749">https://github.com/mikegeeves/pact-python/pull/1/files#diff-cc76c1ff6a766e7d39a30eb0af4b35ec4d003594940b09bc295668426724a749</a>
Generating some python source code (literally just containing the class) seems kind of clunky, but has been the only realistic way I've been able to then have something that will give type hints to users of the contents, since the other approaches are all generated at run time (I was hoping a serialised pickle would work round this, but seems not as it's still loaded at run time only). The idea being when downloading and packaging up the latest lib binaries, it could just generate then, meaning the maintainer would see if anything significantly changed as well. @tjones interested to hear your thoughts on that as an approach, we briefly discussed when first looking at it
@elliottmurray could still do with some general input on if the approach/structure looks ok so far or any significant areas to change: <a href="https://github.com/mikegeeves/pact-python/pull/1/files">https://github.com/mikegeeves/pact-python/pull/1/files</a> assuming not I'll clean up what's in there, subject to opinions on code generating code which is then packaged up etc</div></div></div><br/>
<div><a id="1631194810.046900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631194810.046900" ><div class="time">2021-09-09 13:40</div></a><div class="msg">Starting to try and read up on the logging a little:
?  as a first step I'm looking to swap out the println calls for logging, which I'm assuming should all end up as INFO (message to the user about their pacts)
? still output to stdout
? as well as ideally a stream and temporary file
? any of those print-&gt;info entries should be distinguishable from anything else that would try to log as INFO
Is that in line with needs/expectations or anything misunderstood etc?

First glance I can't see a stream to buffer with slog</div></div></div><br/>
<div><a id="1631236058.047000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631236058.047000" ><div class="time">2021-09-10 01:07</div></a><div class="msg">Do you mean in python or in the ffi?</div></div></div><br/>
<div><a id="1631236079.047200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631236079.047200" ><div class="time">2021-09-10 01:07</div></a><div class="msg">If you're asking about the python logging, this is probably not the right channel</div></div></div><br/>
<div><a id="1631236255.047400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631236255.047400" ><div class="time">2021-09-10 01:10</div></a><div class="msg">I'm not 100% sure I'm following here - let me see if I've understood:

? You're looking at generating types from the ffi
? This means that you could see at compile time if the interface of the ffi has broken (at least in terms of call signatures)
is that right?</div></div></div><br/>
<div><a id="1631254570.047600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631254570.047600" ><div class="time">2021-09-10 06:16</div></a><div class="msg">FFI</div></div></div><br/>
<div><a id="1631254729.047800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631254729.047800" ><div class="time">2021-09-10 06:18</div></a><div class="msg">Yes that's largely it. Can do dynamically at run time but then you lose IDE hints for users which would be a rubbish experience</div></div></div><br/>
<div><a id="1631254957.048000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631254957.048000" ><div class="time">2021-09-10 06:22</div></a><div class="msg">In theory if it's say a new flag added, the maintainer wouldn't need to do anything else at all, just commit, if something is different, "politely discuss" with the Rust maintainer why backwards compatibility has been broken</div></div></div><br/>
<div><a id="1631255114.048400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631255114.048400" ><div class="time">2021-09-10 06:25</div></a><div class="msg">What functionality if looking at swapping print for logging of some sorts would be desired across the language bases</div></div></div><br/>
<div><a id="1631263440.048600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263440.048600" ><div class="time">2021-09-10 08:44</div></a><div class="msg">In the FFI logs are already going to the logger</div></div></div><br/>
<div><a id="1631263447.048800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263447.048800" ><div class="time">2021-09-10 08:44</div></a><div class="msg">do you mean the test output?</div></div></div><br/>
<div><a id="1631263455.049000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263455.049000" ><div class="time">2021-09-10 08:44</div></a><div class="msg">I don't think the test output should go through a logger</div></div></div><br/>
<div><a id="1631263570.049200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263570.049200" ><div class="time">2021-09-10 08:46</div></a><div class="msg">You can see the logs that are already logged in here: <a href="https://github.com/pact-foundation/pact-reference/tree/fix/cleanup-log">https://github.com/pact-foundation/pact-reference/tree/fix/cleanup-log</a></div></div></div><br/>
<div><a id="1631263630.049400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263630.049400" ><div class="time">2021-09-10 08:47</div></a><div class="msg">I think test output is a different beast, because if it goes through a logger it would be harder to parse it. For test output, I think some kind of structured response is probably best (the consumer tests already have this, I believe)</div></div></div><br/>
<div><a id="1631263649.049600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263649.049600" ><div class="time">2021-09-10 08:47</div></a><div class="msg">:thinking_face:</div></div></div><br/>
<div><a id="1631263664.049800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263664.049800" ><div class="time">2021-09-10 08:47</div></a><div class="msg">That was where the suggestion of structured logging comes in, because it's then simple to pull out the message part</div></div></div><br/>
<div><a id="1631263676.050000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263676.050000" ><div class="time">2021-09-10 08:47</div></a><div class="msg">I may have misunderstood what you meant by:
&gt; `Info`: You probably want to know this every time you run pact, and if tests are failing here is an explanation</div></div></div><br/>
<div><a id="1631263689.050200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263689.050200" ><div class="time">2021-09-10 08:48</div></a><div class="msg">&gt; What functionality if looking at swapping print for logging of some sorts would be desired across the language bases
There's a comment on that above somewhere, I'm only partly here so I can't link it right now</div></div></div><br/>
<div><a id="1631263694.050400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263694.050400" ><div class="time">2021-09-10 08:48</div></a><div class="msg">So you're not thinking include that in the logs then?</div></div></div><br/>
<div><a id="1631263704.050600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263704.050600" ><div class="time">2021-09-10 08:48</div></a><div class="msg">For test output, we don't just want the "messages"</div></div></div><br/>
<div><a id="1631263726.050800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263726.050800" ><div class="time">2021-09-10 08:48</div></a><div class="msg">because it's like "given this state, and this request, this response was verified"</div></div></div><br/>
<div><a id="1631263735.051000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263735.051000" ><div class="time">2021-09-10 08:48</div></a><div class="msg">the problem with the logs is that they're super verbose right now</div></div></div><br/>
<div><a id="1631263756.051200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263756.051200" ><div class="time">2021-09-10 08:49</div></a><div class="msg">Might be worth more of a conversation when you / someone is more here :slightly_smiling_face: I think I've possibly got a completely different understanding currently</div></div></div><br/>
<div><a id="1631263757.051400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263757.051400" ><div class="time">2021-09-10 08:49</div></a><div class="msg">nod</div></div></div><br/>
<div><a id="1631263777.051600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263777.051600" ><div class="time">2021-09-10 08:49</div></a><div class="msg">timezones are hard :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631263789.051800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263789.051800" ><div class="time">2021-09-10 08:49</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-js/runs/3565253937#step:4:1400">https://github.com/pact-foundation/pact-js/runs/3565253937#step:4:1400</a></div></div></div><br/>
<div><a id="1631263795.052000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263795.052000" ><div class="time">2021-09-10 08:49</div></a><div class="msg">eg this</div></div></div><br/>
<div><a id="1631263840.052200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263840.052200" ><div class="time">2021-09-10 08:50</div></a><div class="msg">This doesn't fit the logging guidelines we're moving towards, but the problem is that we can't control logging for Rust libs easily. We get their debugs too</div></div></div><br/>
<div><a id="1631263846.052400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263846.052400" ><div class="time">2021-09-10 08:50</div></a><div class="msg">so probably we need our own logger</div></div></div><br/>
<div><a id="1631263856.052600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263856.052600" ><div class="time">2021-09-10 08:50</div></a><div class="msg">so it's about changing the currently logged things</div></div></div><br/>
<div><a id="1631263915.052900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263915.052900" ><div class="time">2021-09-10 08:51</div></a><div class="msg">there's already a logger, but the logger logs to stdout. .NET (I think?) doesn't want stdout logs. It wants to get the logs and do something with them</div></div></div><br/>
<div><a id="1631263923.053100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263923.053100" ><div class="time">2021-09-10 08:52</div></a><div class="msg">(probably print them itself)</div></div></div><br/>
<div><a id="1631263929.053300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263929.053300" ><div class="time">2021-09-10 08:52</div></a><div class="msg">so there, structured logs would work nicely</div></div></div><br/>
<div><a id="1631263937.053500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263937.053500" ><div class="time">2021-09-10 08:52</div></a><div class="msg">but it's not changing the printlns, because there aren't any</div></div></div><br/>
<div><a id="1631263965.053700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263965.053700" ><div class="time">2021-09-10 08:52</div></a><div class="msg">(I am thinking which is slow :slightly_smiling_face: )</div></div></div><br/>
<div><a id="1631263968.053900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263968.053900" ><div class="time">2021-09-10 08:52</div></a><div class="msg">hopefully that makes some kind of sense. I'll write more clearly when I'm not disappearing</div></div></div><br/>
<div><a id="1631263978.054100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263978.054100" ><div class="time">2021-09-10 08:52</div></a><div class="msg">I'll be back later and/or tomorrow</div></div></div><br/>
<div><a id="1631263981.054300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631263981.054300" ><div class="time">2021-09-10 08:53</div></a><div class="msg">hope you're well!</div></div></div><br/>
<div><a id="1631263985.054500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631263985.054500" ><div class="time">2021-09-10 08:53</div></a><div class="msg">sure</div></div></div><br/>
<div><a id="1631264002.054700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264002.054700" ><div class="time">2021-09-10 08:53</div></a><div class="msg">would a quick video call work better than typing long notes?</div></div></div><br/>
<div><a id="1631264009.054900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264009.054900" ><div class="time">2021-09-10 08:53</div></a><div class="msg">(whenever, not right now)</div></div></div><br/>
<div><a id="1631264026.055100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631264026.055100" ><div class="time">2021-09-10 08:53</div></a><div class="msg">sure</div></div></div><br/>
<div><a id="1631264028.055300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264028.055300" ><div class="time">2021-09-10 08:53</div></a><div class="msg">thinking of how time consuming it can be trying to give detail in a message</div></div></div><br/>
<div><a id="1631264065.055500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264065.055500" ><div class="time">2021-09-10 08:54</div></a><div class="msg">I think I'm possibly heading in a different direction on some things but I'm not sure they're necessarily different :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631264143.055700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264143.055700" ><div class="time">2021-09-10 08:55</div></a><div class="msg">when suits? or alternatively just ping when I'm online and you have time :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631264438.055900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264438.055900" ><div class="time">2021-09-10 09:00</div></a><div class="msg">I definitely have some wires crossed as I was thinking more around rolling into a single filterable source but still with stdout, possibly around confusing build tests with pact tests</div></div></div><br/>
<div><a id="1631264442.056100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264442.056100" ><div class="time">2021-09-10 09:00</div></a><div class="msg">anyway, talk another time then! :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631264759.056400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631264759.056400" ><div class="time">2021-09-10 09:05</div></a><div class="msg">&gt; when suits?
I'll get back to you on this. Others might be interested too, idk</div></div></div><br/>
<div><a id="1631264905.056700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631264905.056700" ><div class="time">2021-09-10 09:08</div></a><div class="msg">I'll probably pause for a bit then, no point going on a tangent if it's not of value</div></div></div><br/>
<div><a id="1631265010.056900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631265010.056900" ><div class="time">2021-09-10 09:10</div></a><div class="msg">:thinking_face: normally I'd go through on a miro board (for example) and just run through a bit of a flow of the different types of information, where they go and where people would like them to go / what they want to do with it</div></div></div><br/>
<div><a id="1631277655.057200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631277655.057200" ><div class="time">2021-09-10 12:40</div></a><div class="msg">I've made a quick board as a starting point: <a href="https://miro.com/app/board/o9J_lxta2uI=/">https://miro.com/app/board/o9J_lxta2uI=/</a>  - I'd like to try and understand when person of type x is doing y they would like info from a to go to b and c to go to d etc</div></div></div><br/>
<div><a id="1631277685.057400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631277685.057400" ><div class="time">2021-09-10 12:41</div></a><div class="msg">"so that they can..."</div></div></div><br/>
<div><a id="1631277708.057600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631277708.057600" ><div class="time">2021-09-10 12:41</div></a><div class="msg">tbc :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631317897.057900"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1631317897.057900" ><div class="time">2021-09-10 23:51</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1631626395.058600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631626395.058600" ><div class="time">2021-09-14 13:33</div></a><div class="msg">Has anyone had trouble with `--disable-ssl-verification` not disabling ssl verification? I'm not sure if we're invoking it incorrectly here:

<a href="https://github.com/pact-foundation/pact-js/issues/736#issuecomment-919147536">https://github.com/pact-foundation/pact-js/issues/736#issuecomment-919147536</a></div></div></div><br/>
<div><a id="1631660988.058800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631660988.058800" ><div class="time">2021-09-14 23:09</div></a><div class="msg">I?ll take a look today Tim</div></div></div><br/>
<div><a id="1631693973.061700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631693973.061700" ><div class="time">2021-09-15 08:19</div></a><div class="msg">Re the various issues Beth's created on 'Set "enable pending" to true by default', that's a good example of where I would see it being beneficial having that single source of info with the method I created on the Rust side (retrieving the args and their defaults etc), so all the updating work would then involve is use the new Rust FFI lib version. Could still do with some input if anyone else thinks it's remotely a good idea, since it would be probably a bad idea if just Python had that approach, nowhere else (and I still don't know if anyone likes that approach on the Python side either :thinking_face: )</div></div></div><br/>
<div><a id="1631694365.062400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631694365.062400" ><div class="time">2021-09-15 08:26</div></a><div class="msg">I'm still to catch up on that work, but how would that solve it?</div></div></div><br/>
<div><a id="1631694451.063600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631694451.063600" ><div class="time">2021-09-15 08:27</div></a><div class="msg">The clients still need to update the mapping right?</div></div></div><br/>
<div><a id="1631694453.063700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631694453.063700" ><div class="time">2021-09-15 08:27</div></a><div class="msg">reduction of effort required, it should then just be version bump to use the new lib, and it will then pull in the defaults from there</div></div></div><br/>
<div><a id="1631694471.064000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631694471.064000" ><div class="time">2021-09-15 08:27</div></a><div class="msg">I see</div></div></div><br/>
<div><a id="1631694485.064500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631694485.064500" ><div class="time">2021-09-15 08:28</div></a><div class="msg">It's more than just arg mapping but also defaults</div></div></div><br/>
<div><a id="1631694565.065800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631694565.065800" ><div class="time">2021-09-15 08:29</div></a><div class="msg">yeah, so for the python one, it pulls in the --long-name -l [short name], ENV to use if available, DEBUG|INFO etc for options and default e.g. http for scheme, and I'm using that to automatically "populate" the args to call by cli to then use them</div></div></div><br/>
<div><a id="1631694599.066400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631694599.066400" ><div class="time">2021-09-15 08:29</div></a><div class="msg">and more recently, looking at generating some argument class to then be able to have some form of type hinting</div></div></div><br/>
<div><a id="1631694640.067100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631694640.067100" ><div class="time">2021-09-15 08:30</div></a><div class="msg">hence it's very much a, i think this could be an interesting approach but i could totally understand dislike as an approach :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631694757.068000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631694757.068000" ><div class="time">2021-09-15 08:32</div></a><div class="msg">generating a class with the values in for example, I'm of two minds about, because "print out" something to make code kind of seems horrible but it actually works well :smile:</div></div></div><br/>
<div><a id="1631694858.069400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631694858.069400" ><div class="time">2021-09-15 08:34</div></a><div class="msg">(Just with kids rn but I'm digesting)</div></div></div><br/>
<div><a id="1631695025.069900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631695025.069900" ><div class="time">2021-09-15 08:37</div></a><div class="msg">:+1: np, focus on kids! I'm just heading off for a while anyway</div></div></div><br/>
<div><a id="1631697446.070800"><img src="https://secure.gravatar.com/avatar/cd450b2d68eda3db907327277a40a7d9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">elliottmurray</div><a style="text-decoration: none" href="#1631697446.070800" ><div class="time">2021-09-15 09:17</div></a><div class="msg">Hey Mike - so I have run through the code at a very high level and was 'digesting' this mentally. I've also just not had the headspace this last month or so for Pact generally so apologies  - wasn't ghosting you!</div></div></div><br/>
<div><a id="1631697535.072300"><img src="https://secure.gravatar.com/avatar/cd450b2d68eda3db907327277a40a7d9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">elliottmurray</div><a style="text-decoration: none" href="#1631697535.072300" ><div class="time">2021-09-15 09:18</div></a><div class="msg">While I do really like some of the suggestions - creates some nice pass thru and would in theory make all sdk's more aligned it also makes me a bit nervous when you go down this 'auto-generate' route. That's where I'm at really and haven't moved beyond that yet (well still trying to understand FFI tbh!)</div></div></div><br/>
<div><a id="1631697652.073800"><img src="https://secure.gravatar.com/avatar/cd450b2d68eda3db907327277a40a7d9.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">elliottmurray</div><a style="text-decoration: none" href="#1631697652.073800" ><div class="time">2021-09-15 09:20</div></a><div class="msg">Previously with Ruby there would occasionally be an issue with having to update an api it was often pretty easy to add it to click and change the code. Not saying this is optimal just wasn't my biggest pain point. So it's a trade off with some 'magic' versus a little more maintenance I guess?</div></div></div><br/>
<div><a id="1631699122.083100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631699122.083100" ><div class="time">2021-09-15 09:45</div></a><div class="msg">:100: it's very much a preference of approach, I like the idea of making the codebase as a whole much more DRY (across multiple languages) and overall reducing the amount of choice you need, it is adding in some magic. I'm totally with you on a bit nervous about auto-generated (imo I think overall it's ok, but it's not my codebase so I'm happy to keep in line) :slightly_smiling_face: 

In a "real world" situation, I'd generally try and have a call with a group to go through pros and cons of adding magic to determine if it's desirable to continue, bin the whole idea, continue if some concerns can be sufficiently addressed, or come to an agreement on the level/scope to implement something and where the line is
Not sure the best way here? :thinking_face: Fine with shelving if that's the preference, but then need some input on what to do instead

No problem about time, headspace is always tricky :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631714795.083300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631714795.083300" ><div class="time">2021-09-15 14:06</div></a><div class="msg">Part of the challenge of the auto-generation approach is that it's hard to come up with a good solution that produces idiomatic code in all the languages and frameworks (have a look at the mess of inconsistency that is autogenerated swagger clients + servers for an example).

I really like the idea of adding instrumentation to allow consumers of the ffi to "inspect" it, but I think it will be useful in different ways. For example, in pact-js, the CLI args are defined here: <a href="https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/arguments.ts">https://github.com/pact-foundation/pact-js-core/blob/master/src/verifier/arguments.ts</a> - I don't think there's a lot of value in autogenerating this code for JS (even if it were possible), because the calling code would have to be updated anyway - even if we exposed the autogenerated code right to the boundary of pact-js, we still have to update examples, documentation, etc. On the other hand, manually maintaining this code is not especially onerous.

We do occasionally have problems where the wrong argument is used (or arguments are removed / changed), so I see the arg-exposing functions you added being most useful in tests in pact-js - I'd love to have this implemented, and I think it's a clear improvement.</div></div></div><br/>
<div><a id="1631714980.083700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631714980.083700" ><div class="time">2021-09-15 14:09</div></a><div class="msg">The other thing that could be autogenerated is this type, which needs to match the declared functions:

<a href="https://github.com/pact-foundation/pact-js-core/blob/master/src/ffi/verifier.ts">https://github.com/pact-foundation/pact-js-core/blob/master/src/ffi/verifier.ts</a>

A risk is that this type is wrong and we don't pick it up during tests. If we autogenerated it, it would solve that problem. Perhaps this can be done automatically by parsing the .h file, or exported during the build of the ffi. That would be cool. But, on the other hand, maintaining this file is not a significant amount of work - and anything that breaks the definitions in here should technically be a breaking semver change in the ffi.</div></div></div><br/>
<div><a id="1631715132.084100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715132.084100" ><div class="time">2021-09-15 14:12</div></a><div class="msg">My summary from a pact-js perspective is:

? I think autogenerating the types would let us reduce some risks and may make maintenance easier (of course, it may make it harder, especially if the autogenerator required maintenance)
? However, I don't think those risks are especially large, and the maintenance gain seems small, so I'm unlikely to work on it as a matter of priority
? If someone else wanted to work on it, I'd welcome it
</div></div></div><br/>
<div><a id="1631715198.084300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715198.084300" ><div class="time">2021-09-15 14:13</div></a><div class="msg">(I love how FastAPI with pydantic actually nicely gives you the possibility of having validation "defined" which goes into your Swagger instead of the car crash of half assed Java annotations I dealt with in the past, but that's an aside :smile: )</div></div></div><br/>
<div><a id="1631715199.084500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715199.084500" ><div class="time">2021-09-15 14:13</div></a><div class="msg">It does bother me a bit that we're a contract testing framework, but don't have a clear way to test the contract between the the boundary of either the rust or the ruby core.</div></div></div><br/>
<div><a id="1631715229.084700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715229.084700" ><div class="time">2021-09-15 14:13</div></a><div class="msg">:joy:</div></div></div><br/>
<div><a id="1631715281.084900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715281.084900" ><div class="time">2021-09-15 14:14</div></a><div class="msg">I was thinking earlier actually, I'm sure it was in some Pact blog/tutorial I read about pitfalls and what you don't want to do is just duplicate the same thing in your Pact tests, there's no point in having identical tests of exactly the same thing in multiple places</div></div></div><br/>
<div><a id="1631715287.085100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715287.085100" ><div class="time">2021-09-15 14:14</div></a><div class="msg">&gt; I love how FastAPI with pydantic 
Right! So, this is what I meant by "a good solution that produces idiomatic approaches" - if we *have* some tooling for autogenerating, I don't think we can do a one size fits all</div></div></div><br/>
<div><a id="1631715309.085300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715309.085300" ><div class="time">2021-09-15 14:15</div></a><div class="msg">appropriate tests in the appropriate place</div></div></div><br/>
<div><a id="1631715399.085600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715399.085600" ><div class="time">2021-09-15 14:16</div></a><div class="msg">:thinking_face: I get your point, but I'm not sure it would be a "can't", it is essentially an interface so as long as the interface provides what is needed you can, but I do agree about maybe it doesn't add value</div></div></div><br/>
<div><a id="1631715491.085800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715491.085800" ><div class="time">2021-09-15 14:18</div></a><div class="msg">My summary from a pact-maintainer perspective would be:

? I think this is interesting but low priority for pact-js, because of the tradeoff of small amount of value for us, but probably medium-to-large time investment
? I think it might be more valuable to other pact implementations, depending on their idioms and maintenance challenges
? If it is more valuable to other pact implementations, I'm not going to argue against it</div></div></div><br/>
<div><a id="1631715632.086100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715632.086100" ><div class="time">2021-09-15 14:20</div></a><div class="msg">The tests area I think is interesting, because I would question the value around testing what does it do when you call it with arg x and y but not z, and having business logic in the JS/Python etc to deal with what combinations of arguments you need.. because this is covered on the Rust side, and if the Rust side can [and should, and should have tests] making sure it is called correctly, I'm not sure you add value on the calling implementation essentially doubling up on that, you're adding in a lot of duplicate code/functionality/tests [there's for sure a line somewhere, obviously you want to have some tests to make sure it works etc, but maybe you don't need to test so much]</div></div></div><br/>
<div><a id="1631715765.086300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715765.086300" ><div class="time">2021-09-15 14:22</div></a><div class="msg">Yes, that's very true. In pact-js, we're moving away from heavy validation of the arguments before passing to the binary, because otherwise it requires updates on both sides when they change.

However, this means that the "contract" is that the binary produces good error messages appropriately</div></div></div><br/>
<div><a id="1631715794.086500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715794.086500" ><div class="time">2021-09-15 14:23</div></a><div class="msg">which goes onto our other conversation around logging/output :smile:</div></div></div><br/>
<div><a id="1631715805.086700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715805.086700" ><div class="time">2021-09-15 14:23</div></a><div class="msg">I think the duplication of validation discussion is unrelated to the autogeneration of a calling interface, though</div></div></div><br/>
<div><a id="1631715835.087000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715835.087000" ><div class="time">2021-09-15 14:23</div></a><div class="msg">&gt; which goes onto our other conversation around logging/output 
Yes, exactly.</div></div></div><br/>
<div><a id="1631715926.087200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715926.087200" ><div class="time">2021-09-15 14:25</div></a><div class="msg">bedtime here - but if I had something to autogenerate the types for the JS side of the FFI boundary I would absolutely use it. I think maintenance tooling can save time or attention - and in this case it would save about 60 minutes of setup time, and no additional attention</div></div></div><br/>
<div><a id="1631715974.087400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631715974.087400" ><div class="time">2021-09-15 14:26</div></a><div class="msg">(for a better elaboration on the attention idea - here's an excellent talk that was here in Melbourne a few years ago: <a href="https://www.youtube.com/watch?v=6_q3kQUNpLA">https://www.youtube.com/watch?v=6_q3kQUNpLA</a> )</div></div></div><br/>
<div><a id="1631715978.087700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631715978.087700" ><div class="time">2021-09-15 14:26</div></a><div class="msg">:+1: thanks for the input, I'm having a look through there to see what I've missed/not come to yet</div></div></div><br/>
<div><a id="1631716011.087900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716011.087900" ><div class="time">2021-09-15 14:26</div></a><div class="msg">trying to figure out what else is there that would be problematic :thinking_face:</div></div></div><br/>
<div><a id="1631716038.088100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716038.088100" ><div class="time">2021-09-15 14:27</div></a><div class="msg">Apologies, it looks like that talk is from Sydney, not Melbourne. Unacceptable. Anyway, the talk is the same one, and it's still great.</div></div></div><br/>
<div><a id="1631716053.088300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716053.088300" ><div class="time">2021-09-15 14:27</div></a><div class="msg">and some of the why :thinking_face:  [for example deprecated could be useful to try and figure out how to put that in]</div></div></div><br/>
<div><a id="1631716076.088500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716076.088500" ><div class="time">2021-09-15 14:27</div></a><div class="msg">:joy:</div></div></div><br/>
<div><a id="1631716080.088700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716080.088700" ><div class="time">2021-09-15 14:28</div></a><div class="msg">I'll have a watch now</div></div></div><br/>
<div><a id="1631716231.088900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716231.088900" ><div class="time">2021-09-15 14:30</div></a><div class="msg">I don't think that verifier.js would be that hard to generate programatically [although I don't do JS, but then I don't do Rust either :smile: ]
The value thing is really hard, I think the pets vs cattle analogy might work here also, I liked moving away from even low maintenance servers that were manually rebuilt, to just something you can wipe and reproduce with confidence :thinking_face:</div></div></div><br/>
<div><a id="1631716258.089100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716258.089100" ><div class="time">2021-09-15 14:30</div></a><div class="msg">I wrote pact-js's custom arg mapper (linked above) precisely to allow arbitrary handling of arguments - we have convenience mappers for common cases (including "just print a warning if someone uses this"), but can also provide arbitrary functions, because sometimes we will want to do something really user friendly that is easy to express in a few lines of code</div></div></div><br/>
<div><a id="1631716275.089300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716275.089300" ><div class="time">2021-09-15 14:31</div></a><div class="msg">nod</div></div></div><br/>
<div><a id="1631716291.089500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716291.089500" ><div class="time">2021-09-15 14:31</div></a><div class="msg">&gt; I don't think that verifier.js would be that hard to generate programatically
It absolutely would be easy to generate. But, it would lose the ability to be very human if we did that.</div></div></div><br/>
<div><a id="1631716331.089700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716331.089700" ><div class="time">2021-09-15 14:32</div></a><div class="msg">I need to look more at the things using it aside from the CLI directly</div></div></div><br/>
<div><a id="1631716364.089900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716364.089900" ><div class="time">2021-09-15 14:32</div></a><div class="msg">for python as well that is
it works great for CLI just passing through args, but the generated objects and what to do with them is a lot more complicated</div></div></div><br/>
<div><a id="1631716378.090100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716378.090100" ><div class="time">2021-09-15 14:32</div></a><div class="msg">It's not hard to generate, but it's also not hard to manually maintain</div></div></div><br/>
<div><a id="1631716401.090300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716401.090300" ><div class="time">2021-09-15 14:33</div></a><div class="msg">for sure</div></div></div><br/>
<div><a id="1631716493.090500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716493.090500" ><div class="time">2021-09-15 14:34</div></a><div class="msg">I'm still on the fence about the whole idea in a way, because even if the CLI part is way improved... if you still have to do basically the same thing to call it via a method anyway, I'm not completely sure it's better overall because it's following two different approaches
-&gt; also trying to figure out what else is missing to see if it could work for both</div></div></div><br/>
<div><a id="1631716507.090700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716507.090700" ><div class="time">2021-09-15 14:35</div></a><div class="msg">In pact-js, I'm keen to find things that make things simpler for us. For example - @matt.fellows and I just lost two days of pact maintenance effort to:

? `npm link` doesn't always do the right thing with npm dependencies, and we use it to trial the existing examples against the current build
? For some reason, the musl version of the neon rust bindings for js doesn't build on node 16 (deep into mountain yak territory)</div></div></div><br/>
<div><a id="1631716523.090900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716523.090900" ><div class="time">2021-09-15 14:35</div></a><div class="msg">ouch</div></div></div><br/>
<div><a id="1631716540.091100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716540.091100" ><div class="time">2021-09-15 14:35</div></a><div class="msg">yeah I saw the abandon node 16 for now</div></div></div><br/>
<div><a id="1631716552.091300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716552.091300" ><div class="time">2021-09-15 14:35</div></a><div class="msg">neither of those things are specifically to do with things that provide value to pact users (other than "pact currently uses them to test / build")</div></div></div><br/>
<div><a id="1631716633.091500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716633.091500" ><div class="time">2021-09-15 14:37</div></a><div class="msg">So, as a maintainer, I'm mostly for anything that makes it easier to get value into user's hands. My recent experience is that more complexity is generally not the answer.</div></div></div><br/>
<div><a id="1631716711.091700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716711.091700" ><div class="time">2021-09-15 14:38</div></a><div class="msg">agreed on that one</div></div></div><br/>
<div><a id="1631716720.091900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716720.091900" ><div class="time">2021-09-15 14:38</div></a><div class="msg">neon was great for allowing us to easily spike a rust-backed pact-js and get it out into user's hands. But it made the build significantly more complex (and necessitated including rust directly in pact-js), which has in the longer term meant it's harder to get value out the door</div></div></div><br/>
<div><a id="1631716738.092100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716738.092100" ><div class="time">2021-09-15 14:38</div></a><div class="msg">The moment in that talk that talks about attention is around the 22 minute mark</div></div></div><br/>
<div><a id="1631716772.092300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716772.092300" ><div class="time">2021-09-15 14:39</div></a><div class="msg">```Simple is better than complex.
Complex is better than complicated.```
:slightly_smiling_face:</div></div></div><br/>
<div><a id="1631716775.092500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716775.092500" ><div class="time">2021-09-15 14:39</div></a><div class="msg">her point is something like "saving time is one thing, but this thing that doesn't save me time does save me attention, and that is better" (wildly paraphrasing from memory)</div></div></div><br/>
<div><a id="1631716821.092800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716821.092800" ><div class="time">2021-09-15 14:40</div></a><div class="msg">yeah that makes sense</div></div></div><br/>
<div><a id="1631716823.093000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716823.093000" ><div class="time">2021-09-15 14:40</div></a><div class="msg">Aaanyway, I really should get to bed. I'm supposed to be awake again in 6 hours</div></div></div><br/>
<div><a id="1631716828.093200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716828.093200" ><div class="time">2021-09-15 14:40</div></a><div class="msg">good chat!</div></div></div><br/>
<div><a id="1631716833.093400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716833.093400" ><div class="time">2021-09-15 14:40</div></a><div class="msg">I like automation, but not if it's obscure as a result</div></div></div><br/>
<div><a id="1631716848.093600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716848.093600" ><div class="time">2021-09-15 14:40</div></a><div class="msg">Right!</div></div></div><br/>
<div><a id="1631716903.093800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716903.093800" ><div class="time">2021-09-15 14:41</div></a><div class="msg">I'd like to automate the things that are regularly costing us time or attention. The typings to the ffi mostly cost us setup time and attention</div></div></div><br/>
<div><a id="1631716940.094000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631716940.094000" ><div class="time">2021-09-15 14:42</div></a><div class="msg">so if everyone thinks too obscure, bad idea :slightly_smiling_face: no objection there
I would think hopefully, if you can make it generate things itself that as you mentioned wouldn't probably take a hugely shorter time to make a branch, update a version number and run a script to generate than it would to go through release notes and pull out variables, but the attention definitely does apply there</div></div></div><br/>
<div><a id="1631716967.094200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631716967.094200" ><div class="time">2021-09-15 14:42</div></a><div class="msg">An example of a significant win there is when @bethskurrie automated the version bump of the ruby standalone so that pact-js gets a PR every time a new release is made. It is SO GOOD</div></div></div><br/>
<div><a id="1631717010.094400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631717010.094400" ><div class="time">2021-09-15 14:43</div></a><div class="msg">nod</div></div></div><br/>
<div><a id="1631717018.094700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631717018.094700" ><div class="time">2021-09-15 14:43</div></a><div class="msg">I'm going to stop replying for now so you go to sleep :joy:</div></div></div><br/>
<div><a id="1631717036.094900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717036.094900" ><div class="time">2021-09-15 14:43</div></a><div class="msg">Fair :joy:</div></div></div><br/>
<div><a id="1631717067.095100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631717067.095100" ><div class="time">2021-09-15 14:44</div></a><div class="msg">[one last one: there is still the balance with some, of if it is making new dtos etc you would possibly want to at least "code review" the changes before building and shipping, maybe]</div></div></div><br/>
<div><a id="1631717069.095300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631717069.095300" ><div class="time">2021-09-15 14:44</div></a><div class="msg">anyway, night :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631717079.095500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717079.095500" ><div class="time">2021-09-15 14:44</div></a><div class="msg">Also, I like that your message describing the auto version bump pretty much crossed with mine describing the same thing</div></div></div><br/>
<div><a id="1631717114.095700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717114.095700" ><div class="time">2021-09-15 14:45</div></a><div class="msg">with pact-js, we chose to review manually rather than automatically merge and release</div></div></div><br/>
<div><a id="1631717160.095900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717160.095900" ><div class="time">2021-09-15 14:46</div></a><div class="msg">which means the code review is a bit there</div></div></div><br/>
<div><a id="1631717175.096100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717175.096100" ><div class="time">2021-09-15 14:46</div></a><div class="msg">It would be excellent to get the same thing happening with the FFI</div></div></div><br/>
<div><a id="1631717185.096300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717185.096300" ><div class="time">2021-09-15 14:46</div></a><div class="msg">currently that's entirely manual</div></div></div><br/>
<div><a id="1631717189.096500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631717189.096500" ><div class="time">2021-09-15 14:46</div></a><div class="msg">anyway, yes. Goodnight!</div></div></div><br/>
<div><a id="1631717291.096700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631717291.096700" ><div class="time">2021-09-15 14:48</div></a><div class="msg">:joy: :wave:</div></div></div><br/>
<div><a id="1631742198.097000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631742198.097000" ><div class="time">2021-09-15 21:43</div></a><div class="msg">:thinking_face: I like to hunt yaks but I think I may accidentally farm a few thousand :thinking_face:</div></div></div><br/>
<div><a id="1631749476.097600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631749476.097600" ><div class="time">2021-09-15 23:44</div></a><div class="msg">Tim and I are professional yak shearers</div></div></div><br/>
<div><a id="1631749486.097800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631749486.097800" ><div class="time">2021-09-15 23:44</div></a><div class="msg">(I suppose Sheep, given Australia)</div></div></div><br/>
<div><a id="1631794219.098000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631794219.098000" ><div class="time">2021-09-16 12:10</div></a><div class="msg">(I like that video a lot, it also makes me happy that a woman can now give a talk on a subject like that, starting with "omg tangents what am I even doing" and not get shot down as "that's just because you're a woman so you can't be a good developer" progress! also I would not have the confidence to stand up in front of people and give a talk in my socks :joy: much respect :smile:)</div></div></div><br/>
<div><a id="1631802079.098200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631802079.098200" ><div class="time">2021-09-16 14:21</div></a><div class="msg">I think I watch it about once every 6 months.</div></div></div><br/>
<div><a id="1631871184.098400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631871184.098400" ><div class="time">2021-09-17 09:33</div></a><div class="msg">[:thinking_face: still not completely sure where to go with this especially on the python side, but while my model builds, I had a "quick" look at the identifying available functions from the library:
? looks like a pain trying to introspect within rust to pull it out via macros etc
? looking at the lib itself, there are some packages e.g. ffi-generate using clang to pull out, or swig which can generate the stubs and objects for just about everything other than JS :joy: but it all looks quite complicated
? so finally trying your suggestion of using the header itself [I did start with that one, found cbindgen, started looking at adding it, found it was already there, then saw the output and went elsewhere for a while :smile:), the ones setup in the build already are quite large and would be a pain to parse, so had a look at reducing that, and I can get cbindgen to produce a much smaller .h file with just the functions all nicely on one line, so with a quick grep it ends up as:
&gt; $ cat include/pact_stripped.h |grep -v -e "^$" -e struct | grep '('
&gt; const char *pactffi_version(void);
&gt; void pactffi_init(const char *log_env_var);
&gt; void pactffi_init_with_log_level(const char *level);
&gt; void pactffi_log_message(const char *source, const char *log_level, const char *message);
&gt; int pactffi_get_error_message(char *buffer, int length);
&gt; int pactffi_log_to_stdout(enum LevelFilter level_filter);
&gt; int pactffi_log_to_stderr(enum LevelFilter level_filter);
&gt; int pactffi_log_to_file(const char *file_name, enum LevelFilter level_filter);
&gt; int pactffi_log_to_buffer(enum LevelFilter level_filter);
&gt; void pactffi_logger_init(void);
&gt; int pactffi_logger_attach_sink(const char *sink_specifier, enum LevelFilter level_filter);
&gt; int pactffi_logger_apply(void);
&gt; const char *pactffi_fetch_log_buffer(const char *log_id);
&gt; void pactffi_string_delete(char *string);
&gt; int32_t pactffi_create_mock_server(const char *pact_str, const char *addr_str, bool tls);
&gt; char *pactffi_get_tls_ca_certificate(void);
&gt; bool pactffi_mock_server_matched(int32_t mock_server_port);
&gt; char *pactffi_mock_server_mismatches(int32_t mock_server_port);
&gt; bool pactffi_cleanup_mock_server(int32_t mock_server_port);
&gt; int32_t pactffi_write_pact_file(int32_t mock_server_port, const char *directory, bool overwrite);
&gt; const char *pactffi_mock_server_logs(int32_t mock_server_port);
&gt; bool pactffi_check_regex(const char *regex, const char *example);
&gt; void pactffi_free_string(char *s);
&gt; int32_t pactffi_verify(const char *args);
&gt; const char *pactffi_verifier_cli_args(void);
that I think that would be pretty straightforward to read in on the JS/python etc side and token match to produce the info for those types, it might even go in as-is with how the python one works
.... you meant that, right? :slightly_smiling_face:
]</div></div></div><br/>
<div><a id="1631875052.098900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875052.098900" ><div class="time">2021-09-17 10:37</div></a><div class="msg">&gt; even if we exposed the autogenerated code right to the boundary of pact-js, we still have to update examples, documentation, etc. On the other hand, manually maintaining this code is not especially onerous.
With the CLI example, why would there be any difference between the CLI provided by python, or the one provided by JS, .net, and so on? Unless I've missed something, I can't see why you would have any behaviour differences at all, you're wrapping up the functionality exposed by the shared lib, so if you end up with say python cli being `pact-verifier --some-user` but for the JS cli it is `pact-verifier --someUser` that seems like a very confusing direction, and I don't think that happens anywhere?</div></div></div><br/>
<div><a id="1631875159.099200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875159.099200" ><div class="time">2021-09-17 10:39</div></a><div class="msg">-&gt; why is there documentation and examples to update for each language anyway? vs a single source of the latest set of examples applicable to that version of the underlying library</div></div></div><br/>
<div><a id="1631875192.099400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875192.099400" ><div class="time">2021-09-17 10:39</div></a><div class="msg">&gt; that I think that would be pretty straightforward to read in on the JS/python etc side and token match to produce the info for those types, it might even go in as-is with how the python one works

My point is, yes we could do this ,but it would be a fair amount of engineering effort and moving parts (which means more maintenance effort in the future) to achieve something that is not currently difficult or onerous to do by hand, except for the first time.</div></div></div><br/>
<div><a id="1631875194.099600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875194.099600" ><div class="time">2021-09-17 10:39</div></a><div class="msg">(had a brief discussion with Matt around docs on this)</div></div></div><br/>
<div><a id="1631875259.099800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875259.099800" ><div class="time">2021-09-17 10:40</div></a><div class="msg">&gt; -&gt; why is there documentation and examples to update for each language anyway? 
We have no spec for the implementation features (eg, matchers that are composed of other matchers, developer productivity helpers etc). Having something like that would be amazing.</div></div></div><br/>
<div><a id="1631875262.100000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875262.100000" ><div class="time">2021-09-17 10:41</div></a><div class="msg">there's a lot of e.g. Pact docs have info on matchers, then each language then goes onto explain in the readme some similar but slightly different explanation, it's making a lot of work for everyone :smile:</div></div></div><br/>
<div><a id="1631875316.100200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875316.100200" ><div class="time">2021-09-17 10:41</div></a><div class="msg">:thinking_face: as in some languages can do matchers of matchers but others can't?</div></div></div><br/>
<div><a id="1631875364.100500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875364.100500" ><div class="time">2021-09-17 10:42</div></a><div class="msg">Yes, a single source of documentation on "this is how it works" with eg tabs for "show me this in each language" would be AMAZING</div></div></div><br/>
<div><a id="1631875370.100700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875370.100700" ><div class="time">2021-09-17 10:42</div></a><div class="msg">nod nod</div></div></div><br/>
<div><a id="1631875388.100900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875388.100900" ><div class="time">2021-09-17 10:43</div></a><div class="msg">I came across: <a href="https://docusaurus.io/docs/markdown-features/code-blocks#multi-language-support-code-blocks">https://docusaurus.io/docs/markdown-features/code-blocks#multi-language-support-code-blocks</a> when I was having a look the other day</div></div></div><br/>
<div><a id="1631875426.101200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875426.101200" ><div class="time">2021-09-17 10:43</div></a><div class="msg">sorry yes, ofc there are differences in the implementation of an example, syntax between languages, but that's just "translation" of the same thing, rather than one having an example while the other doesn't</div></div></div><br/>
<div><a id="1631875436.101400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875436.101400" ><div class="time">2021-09-17 10:43</div></a><div class="msg">Even ignoring the obvious benefits for users (and not needing to maintain multiple instances of the same documentation), the benefit of "oh! This feature isn't available in that implementation" would be super super great</div></div></div><br/>
<div><a id="1631875448.101600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875448.101600" ><div class="time">2021-09-17 10:44</div></a><div class="msg">Largely the reason we don't have this is "no one has had the time yet"</div></div></div><br/>
<div><a id="1631875452.101800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875452.101800" ><div class="time">2021-09-17 10:44</div></a><div class="msg">:smile:</div></div></div><br/>
<div><a id="1631875470.102000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875470.102000" ><div class="time">2021-09-17 10:44</div></a><div class="msg">I would wholeheartedly support any effort to do it</div></div></div><br/>
<div><a id="1631875491.102200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875491.102200" ><div class="time">2021-09-17 10:44</div></a><div class="msg">I'm up for docs, although a little wary of giving the impression I half start a dozen things and finish nothing :smile:</div></div></div><br/>
<div><a id="1631875557.102500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875557.102500" ><div class="time">2021-09-17 10:45</div></a><div class="msg">That's not (currently) my impression</div></div></div><br/>
<div><a id="1631875583.102700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875583.102700" ><div class="time">2021-09-17 10:46</div></a><div class="msg">that's good at least :smile:</div></div></div><br/>
<div><a id="1631875610.102900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875610.102900" ><div class="time">2021-09-17 10:46</div></a><div class="msg">I think the auto-generate-types-from-ffi project feels like a valuable spike, with the outcome that "actually this will work, but maybe not be as useful as it first looked"</div></div></div><br/>
<div><a id="1631875662.103100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875662.103100" ><div class="time">2021-09-17 10:47</div></a><div class="msg">which I think is a good contribution, that you could consider finished without feeling too guilty (unless you want to keep going because you think it might yield more value, idk)</div></div></div><br/>
<div><a id="1631875677.103300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875677.103300" ><div class="time">2021-09-17 10:47</div></a><div class="msg">back to those examples, so with CLI specifically, that is identical for each language wrapped up isn't it? I get the programatic verifier etc is going to have different examples :thinking_face:</div></div></div><br/>
<div><a id="1631875719.103500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875719.103500" ><div class="time">2021-09-17 10:48</div></a><div class="msg">Yes, although where you might put it differs between languages. For example, it's valid inside an npm script, because pact-js exposes it to npm.</div></div></div><br/>
<div><a id="1631875730.103700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875730.103700" ><div class="time">2021-09-17 10:48</div></a><div class="msg">you don't need a custom script to use the CLI in pact-js</div></div></div><br/>
<div><a id="1631875754.103900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875754.103900" ><div class="time">2021-09-17 10:49</div></a><div class="msg">(I may be lacking a bit of domain knowledge here across the various languages which probably doesn't help)</div></div></div><br/>
<div><a id="1631875854.104100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875854.104100" ><div class="time">2021-09-17 10:50</div></a><div class="msg">on the python side you have the pact-verifier "binary" you call from a shell as one part, but then also the python function for verifying you're calling in the code
I'm firstly talking about that binary, where the python code is literally taking the args you give it on the shell and then calling the ffi library with it
Secondly is the programatic .verify method(s), which is where the type generation comes in and gets more complicated</div></div></div><br/>
<div><a id="1631875878.104300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631875878.104300" ><div class="time">2021-09-17 10:51</div></a><div class="msg">&gt; (I may be lacking a bit of domain knowledge here across the various languages which probably doesn't help)
This is the IDEAL time to write docs. Because you'd be learning the concepts</div></div></div><br/>
<div><a id="1631875880.104500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631875880.104500" ><div class="time">2021-09-17 10:51</div></a><div class="msg">I'm torn between asking is that not the same on the pact-js side / telling myself to RTFM :smile:</div></div></div><br/>
<div><a id="1631876180.104800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631876180.104800" ><div class="time">2021-09-17 10:56</div></a><div class="msg">In terms of dropping or continuing, on the python side with the pact-verifier, I think that's simple and clean enough that I'm not sure why you (as in "one" rather than anyone specific!) wouldn't want to have the one less place to even have to think about
For the other part around types I think there could be value but I'd happily just drop, I think it might be "too late" for this time unless there's more of a "yes that looks useful" since as you say, it's largely already done the first time anyway

I've had fun finding out about Rust and FFI regardless so it's all good :slightly_smiling_face:</div></div></div><br/>
<div><a id="1631876792.105000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631876792.105000" ><div class="time">2021-09-17 11:06</div></a><div class="msg">&gt; wouldn't want to have the one less place to even have to think about
The challenge is that sometimes autogenerated implementations become more things to think about longer term. Of course, if it's valuable to you / pact-python, I'm definitely not suggesting stopping.

I'm also planning to use the introspection you added to the rust side to do sanity checks in pact-js. So, thank you!</div></div></div><br/>
<div><a id="1631924105.105200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924105.105200" ><div class="time">2021-09-18 00:15</div></a><div class="msg">Man, everytime I say ?I?m going to respond to Mike? I come back and there is a novel in front of me :laughing:</div></div></div><br/>
<div><a id="1631924128.105400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924128.105400" ><div class="time">2021-09-18 00:15</div></a><div class="msg">so, I?ve read most of the conversation. I?m currently on the side of ?it could probably be improved, but also it?s not the biggest pain point?.</div></div></div><br/>
<div><a id="1631924170.105600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924170.105600" ><div class="time">2021-09-18 00:16</div></a><div class="msg">which doesn?t mean it shouldn?t be solved, but it?s probably a little further down the list. Manually mapping arguments hasn?t been a big problem and from a time-to-market perspective, the proposal probably won?t shift that all to significantly.</div></div></div><br/>
<div><a id="1631924367.105800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924367.105800" ><div class="time">2021-09-18 00:19</div></a><div class="msg">If I could hijack the conversation toward big problems that cost us the most time / effort:

1. Documentation (as Mike has mentioned and we have discussed in a few places) having an actual guide that takes everyone from first consumer test, to completed Nirvana with the language specific examples and uses the CLI for key moments would be a massive win.
2. Getting onto v3 / rust core (which also needs some better documentation/guides for developers)
3. Having a feature spec (cucumber or otherwise) that each language should be implementing to ensure consistency with implementation and usage (2)
4. Consistent documentation across projects. Ideally, everyone goes to <a href="http://docs.pact.io/">http://docs.pact.io/</a>&lt;language url&gt;, instead of various GH repositories. This also goes for Pactflow documentation</div></div></div><br/>
<div><a id="1631924395.106000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924395.106000" ><div class="time">2021-09-18 00:19</div></a><div class="msg">Documentation is probably the highest priority, because it?s what leads to the most questions/time spent on slack, away from building new features (e.g. [2])</div></div></div><br/>
<div><a id="1631924435.106200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924435.106200" ><div class="time">2021-09-18 00:20</div></a><div class="msg">Getting onto the Rust core is strategically important, because having different specification versions and inconsistent experiences acrosns languages is another big class of confusion/problems</div></div></div><br/>
<div><a id="1631924459.106400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924459.106400" ><div class="time">2021-09-18 00:20</div></a><div class="msg">The biggest blocker to (1) is just time and getting headspace to do it. A good spike to iterate on the format is probably the starting point</div></div></div><br/>
<div><a id="1631924483.106600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924483.106600" ><div class="time">2021-09-18 00:21</div></a><div class="msg">Biggest blocker to (2) is the provider verification logging, and better developer documentation, and of course, implementation</div></div></div><br/>
<div><a id="1631924512.106800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924512.106800" ><div class="time">2021-09-18 00:21</div></a><div class="msg">(3) is something @greg595au has been agitating a bit about, and would love to give him some support around it if we think it?s a good idea</div></div></div><br/>
<div><a id="1631924550.107100"><img src="https://secure.gravatar.com/avatar/b06fdad31dc8b8491da545f87040fde6.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0001-72.png" /></a><div class="message"><div class="username">greg595au</div><a style="text-decoration: none" href="#1631924550.107100" ><div class="time">2021-09-18 00:22</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1631924605.107300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1631924605.107300" ><div class="time">2021-09-18 00:23</div></a><div class="msg">(4) requires coordination across Pactlow and OSS folks, and some thinking about the commercial and other impacts of doing so. We all agree it?s a bit messy though, and could be improved (we have some good data/user research on the Pactflow side to back it up though)</div></div></div><br/>
<div><a id="1631952195.107800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631952195.107800" ><div class="time">2021-09-18 08:03</div></a><div class="msg">&gt; Man, everytime I say ?I?m going to respond to Mike? I come back and there is a novel in front of me
You've heard of "two wrongs don't make a \"right\"" :smile:
(actually that wasn't as bad as it looked when I saw on Mobile :smile: )</div></div></div><br/>
<div><a id="1631953899.108000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631953899.108000" ><div class="time">2021-09-18 08:31</div></a><div class="msg">Tim and I had a call chat yesterday which was nice as well as helpful :slightly_smiling_face:
Where I'm currently up to:
? I'm thinking I'll leave the Python pact-verifier largely as-is, using the Rust method to auto-magically provide the args and so on, since it Just Works already (needs tidying up a little and maybe a few more tests, but there's not really anything to "go wrong" there)
? For the more contentious verifier programatically, shelve that for now, I will leave in a generate script for reference/manual use and use the class it's created so far but not progress wiring up to run the generate script during package etc, that needs tidying up of where it's up to
Logging:
? I think the stdout going via the logger [which can then just print straight to stdout if desired!] etc at least as an option could be beneficial, but now understand better the pain point around logging levels etc, so leave that for now
? Going to spike a little around what logger options there are to try and split out the rust/pact logs. It looked like some of the other loggers had a nice way to "if you already have logging this is how you can hook into/replace existing macros so you can use this logger instead with only 2 lines of code" for example, which might work to do something there. I came across some examples this morning that looked like it might be able to split out the logging levels based on crates which might be a really quick win but need to play around with it
Docs:
? I like docs, more than happy to focus there
? (3) I like that idea, why not try and structure the docs around that even? Then you can have consistent docs across all languages with examples of everything you want to do?
? (4) I think that needs some thought on what that would mean exactly, unless you're going down a round like CDK for example where the various language docs are largely autogenerated, I would think you would want as little as possible documentation in a language specific doc, and as much as possible in a Pact doc which has the examples for the various language syntax (thinking of the matcher for example), there's no point having copy pasted docs for each language, it's just another place to update and then improvements to one language don't benefit the other vs single source of truth</div></div></div><br/>
<div><a id="1631953968.108200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631953968.108200" ><div class="time">2021-09-18 08:32</div></a><div class="msg">(4) definitely needs a lot of coordination to avoid upset over "why are you deleting all my docs for language x" -&gt; "I'm not they're just over here now and I've added in all these other examples someone had done in language y"</div></div></div><br/>
<div><a id="1631968389.108600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1631968389.108600" ><div class="time">2021-09-18 12:33</div></a><div class="msg">As a JS maintainer, I certainly would welcome "here's a PR that deletes your docs and replaces them with templates to fill in for the central docs"</div></div></div><br/>
<div><a id="1631972313.108900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1631972313.108900" ><div class="time">2021-09-18 13:38</div></a><div class="msg">For sure, I just mean communicating what is happening so there aren't concerning surprises</div></div></div><br/>
<div><a id="1632078759.111300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1632078759.111300" ><div class="time">2021-09-19 19:12</div></a><div class="msg">#libpact_ffi-users Can someone please check the performance of consumer tests in their library using the Rust FFI approach on Windows please? In PactNet we get really poor performance (each test taking ~2s) with the mock server, but this doesn't happen on Linux or when there's a proxy in the way (using Fiddler) on Windows either. It's all just plain standard .Net Code and the performance is really poor.

There's some more detail about things I've done to try and work out why it happens here: <a href="https://github.com/pact-foundation/pact-net/issues/323">https://github.com/pact-foundation/pact-net/issues/323</a>

tl;dr it's only when you use the Pact mock server and only on Windows</div></div></div><br/>
<div><a id="1632081549.111600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1632081549.111600" ><div class="time">2021-09-19 19:59</div></a><div class="msg">Oooooooooookay... So turns out if I replace `localhost` with `127.0.0.1` then the tests are super fast. Why on earth are they slow with `localhost` then?!</div></div></div><br/>
<div><a id="1632089533.111800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632089533.111800" ><div class="time">2021-09-19 22:12</div></a><div class="msg">Hostname resolution?</div></div></div><br/>
<div><a id="1632092768.112100"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1632092768.112100" ><div class="time">2021-09-19 23:06</div></a><div class="msg">Must be doing a DNS lookup, which is timing out.</div></div></div><br/>
<div><a id="1632094167.112300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632094167.112300" ><div class="time">2021-09-19 23:29</div></a><div class="msg">I think it was first trying to bind to an ipv6 address</div></div></div><br/>
<div><a id="1632094187.112500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632094187.112500" ><div class="time">2021-09-19 23:29</div></a><div class="msg">i.e. `localhost` was mapped to  `::1` and then it falls back to other IPs</div></div></div><br/>
<div><a id="1632094194.112700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632094194.112700" ><div class="time">2021-09-19 23:29</div></a><div class="msg">Should we support ipv6 in the mock server?</div></div></div><br/>
<div><a id="1632125461.112900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632125461.112900" ><div class="time">2021-09-20 08:11</div></a><div class="msg">Oh I know this one! Windows is suuuuper slow at resolving ipv6 / 4 fallbacks because it actually follows the standards. Everyone else ignored them.</div></div></div><br/>
<div><a id="1632232630.114600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632232630.114600" ><div class="time">2021-09-21 13:57</div></a><div class="msg">Hm, not entirely clear on the FFI libs required, just comparing between what was in the python FFI download, and the js's sh script, js has:
'nix: linux-x86_64.so.gz osx-x86_64.dylib.gz osx-aarch64-apple-darwin.dylib.gz
win: windows-x86_64.dll.gz windows-x86_64.dll.lib.gz

On the python side I've got:
```PACT_FFI_FILENAMES = [
    "libpact_ffi-linux-x86_64.a.gz",
    "libpact_ffi-linux-x86_64.so.gz",
    "libpact_ffi-osx-aarch64-apple-darwin.a.gz",
    "libpact_ffi-osx-aarch64-apple-darwin.dylib.gz",
    "libpact_ffi-osx-x86_64.a.gz",
    "libpact_ffi-osx-x86_64.dylib.gz",
    "pact_ffi-windows-x86_64.dll.lib.gz",
    "pact_ffi-windows-x86_64.dll.gz",
    "pact_ffi-windows-x86_64.lib.gz",
]```
Does anyone know what/when the various additional files are required? :thinking_face:</div></div></div><br/>
<div><a id="1632233142.114700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233142.114700" ><div class="time">2021-09-21 14:05</div></a><div class="msg">One of those is static and one is dynamic</div></div></div><br/>
<div><a id="1632233160.114900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233160.114900" ><div class="time">2021-09-21 14:06</div></a><div class="msg">You don't need both from each pair, it just depends on how you link them I think</div></div></div><br/>
<div><a id="1632233210.115100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233210.115100" ><div class="time">2021-09-21 14:06</div></a><div class="msg">This is what we use in pact-js:</div></div></div><br/>
<div><a id="1632233234.115500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233234.115500" ><div class="time">2021-09-21 14:07</div></a><div class="msg">except we rename them so we know what version they were meant to be when they were downloaded</div></div></div><br/>
<div><a id="1632233241.115700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233241.115700" ><div class="time">2021-09-21 14:07</div></a><div class="msg">:thinking_face:</div></div></div><br/>
<div><a id="1632233281.115900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233281.115900" ><div class="time">2021-09-21 14:08</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-js-core/blob/master/script/lib/download-ffi.sh">https://github.com/pact-foundation/pact-js-core/blob/master/script/lib/download-ffi.sh</a></div></div></div><br/>
<div><a id="1632233286.116200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233286.116200" ><div class="time">2021-09-21 14:08</div></a><div class="msg">this downloads them</div></div></div><br/>
<div><a id="1632233303.116400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233303.116400" ><div class="time">2021-09-21 14:08</div></a><div class="msg">yus, that's the one I was looking at for the list above :slightly_smiling_face:</div></div></div><br/>
<div><a id="1632233312.116600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233312.116600" ><div class="time">2021-09-21 14:08</div></a><div class="msg">I do pay attention to your links sometimes :smile:</div></div></div><br/>
<div><a id="1632233332.116800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233332.116800" ><div class="time">2021-09-21 14:08</div></a><div class="msg">[actually, slightly earlier one before a refactor I think, earlier in the chan anyway]</div></div></div><br/>
<div><a id="1632233340.117000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233340.117000" ><div class="time">2021-09-21 14:09</div></a><div class="msg">Haha! Sorry, I was repeating myself from a PM so that others could see it too</div></div></div><br/>
<div><a id="1632233359.117200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233359.117200" ><div class="time">2021-09-21 14:09</div></a><div class="msg">Also yes, this time I cleaned it up a bit before linking it :wink:</div></div></div><br/>
<div><a id="1632233405.117400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233405.117400" ><div class="time">2021-09-21 14:10</div></a><div class="msg">yeah I meant the now broken link one, helpfully slack still had the contents, didn't know it did that</div></div></div><br/>
<div><a id="1632233480.117600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233480.117600" ><div class="time">2021-09-21 14:11</div></a><div class="msg">&gt; robust-bash.sh</div></div></div><br/>
<div><a id="1632233484.117800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233484.117800" ><div class="time">2021-09-21 14:11</div></a><div class="msg">bit of an oxymoron there :smile:</div></div></div><br/>
<div><a id="1632233508.118000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233508.118000" ><div class="time">2021-09-21 14:11</div></a><div class="msg">:stuck_out_tongue:</div></div></div><br/>
<div><a id="1632233528.118200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233528.118200" ><div class="time">2021-09-21 14:12</div></a><div class="msg">shellcheck + that lib, and you'll be laughing. I have a blog post about it somewhere</div></div></div><br/>
<div><a id="1632233566.118400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233566.118400" ><div class="time">2021-09-21 14:12</div></a><div class="msg">It includes the recommendation "don't write more than 200 lines in bash".</div></div></div><br/>
<div><a id="1632233577.118600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632233577.118600" ><div class="time">2021-09-21 14:12</div></a><div class="msg">....whooops.</div></div></div><br/>
<div><a id="1632233592.118800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632233592.118800" ><div class="time">2021-09-21 14:13</div></a><div class="msg">:smile:</div></div></div><br/>
<div><a id="1632234720.119000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1632234720.119000" ><div class="time">2021-09-21 14:32</div></a><div class="msg">ok so I should be able to lose the .a. ones then :+1:</div></div></div><br/>
<div><a id="1632341186.119900"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632341186.119900" ><div class="time">2021-09-22 20:06</div></a><div class="msg">hello everyone,
Can you tell me what other language implementations are shipping pre-compiled FFI libs as [package] artifacts?</div></div></div><br/>
<div><a id="1632342821.120000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632342821.120000" ><div class="time">2021-09-22 20:33</div></a><div class="msg">JS and .NET at the moment</div></div></div><br/>
<div><a id="1632342846.120200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632342846.120200" ><div class="time">2021-09-22 20:34</div></a><div class="msg">Oh and the dart package</div></div></div><br/>
<div><a id="1632342851.120400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632342851.120400" ><div class="time">2021-09-22 20:34</div></a><div class="msg">Python is WIP</div></div></div><br/>
<div><a id="1632342869.120600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632342869.120600" ><div class="time">2021-09-22 20:34</div></a><div class="msg">Go can't package anything other than source code, but it uses the FFI</div></div></div><br/>
<div><a id="1632342869.120800"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632342869.120800" ><div class="time">2021-09-22 20:34</div></a><div class="msg">wow, nice.

thank you for the response.</div></div></div><br/>
<div><a id="1632364539.121200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632364539.121200" ><div class="time">2021-09-23 02:35</div></a><div class="msg">Why do you ask?</div></div></div><br/>
<div><a id="1632367120.121400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632367120.121400" ><div class="time">2021-09-23 03:18</div></a><div class="msg">For context Tim, Perdo is looking at the Elixr implementation</div></div></div><br/>
<div><a id="1632367154.121600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632367154.121600" ><div class="time">2021-09-23 03:19</div></a><div class="msg">the previous work done by @pact-slack integrated rust code directly (similar to Pact JS) and now that work is recommencing there, I?ve been recommending moving away from that approach.</div></div></div><br/>
<div><a id="1632367189.121800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632367189.121800" ><div class="time">2021-09-23 03:19</div></a><div class="msg">It?s made even more difficult for Elixr users, because they?d actually have to have Rust/Cargo etc. installed on end-users machines (i.e. it?s not just a pain for maintainers, but also users)</div></div></div><br/>
<div><a id="1632368490.122000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632368490.122000" ><div class="time">2021-09-23 03:41</div></a><div class="msg">Right! Cool</div></div></div><br/>
<div><a id="1632407543.122300"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632407543.122300" ><div class="time">2021-09-23 14:32</div></a><div class="msg">ya, i can understand that.</div></div></div><br/>
<div><a id="1632449950.122600"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632449950.122600" ><div class="time">2021-09-24 02:19</div></a><div class="msg">What?s the strategy with raw FFI? We, @andrew.jensen and I, can think of two options:

1. Set up a CI pipeline for`pact_elixir`, so that every time we publish a new version of the library, we compile the Rust code for Windows, MacOS, and Linux, then include those compiled binaries in the packageExpect the developer to install the Rust toolchain on their computer, and have them compile the Rust code, even though they are interacting with it as if it is C code
2. Expect the developer to install the Rust toolchain on their computer, and have them compile the Rust code, even though they are interacting with it as if it is C code
Do you recommend either one of those approaches or yet a different one?</div></div></div><br/>
<div><a id="1632449981.122800"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632449981.122800" ><div class="time">2021-09-24 02:19</div></a><div class="msg">.</div></div></div><br/>
<div><a id="1632454508.123400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632454508.123400" ><div class="time">2021-09-24 03:35</div></a><div class="msg">we publish the artifacts here: <a href="https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.0.2">https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.0.2</a></div></div></div><br/>
<div><a id="1632454516.123600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632454516.123600" ><div class="time">2021-09-24 03:35</div></a><div class="msg">No need to compile rust!</div></div></div><br/>
<div><a id="1632454563.123800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632454563.123800" ><div class="time">2021-09-24 03:36</div></a><div class="msg">your strategy should be to download the OS-specific FFI bundles at build time, embedding them into your elixr package</div></div></div><br/>
<div><a id="1632454578.124000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632454578.124000" ><div class="time">2021-09-24 03:36</div></a><div class="msg">when developers install the elixr package, your code knows where to find the relative paths of the FFI libraries</div></div></div><br/>
<div><a id="1632454795.124200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632454795.124200" ><div class="time">2021-09-24 03:39</div></a><div class="msg">with the FFI interface, you don?t need to think about rust at all. The libraries expose a C interface that can be directly used by any language that can interface to C (I believe Elixr can based on my reading). You just need to pop the libraries into a known location (e.g. the equivalent of `./node_modules` or `~./pip` ) and then link to it</div></div></div><br/>
<div><a id="1632468654.124500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632468654.124500" ><div class="time">2021-09-24 07:30</div></a><div class="msg">Yes, definitely you shouldn't need to compile any rust. The binaries are already built for the architectures we support, you just need to link them using whatever C bindings Elixir has available</div></div></div><br/>
<div><a id="1632468709.124700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632468709.124700" ><div class="time">2021-09-24 07:31</div></a><div class="msg">From experience with the other pact frameworks, it's best if you can bundle the binaries directly in whatever package manager `pact_elixir` is stored in</div></div></div><br/>
<div><a id="1632477845.124900"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632477845.124900" ><div class="time">2021-09-24 10:04</div></a><div class="msg">Thank you fellas</div></div></div><br/>
<div><a id="1632499019.125400"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632499019.125400" ><div class="time">2021-09-24 15:56</div></a><div class="msg">&gt; your strategy should be to _*download*_ the OS-specific FFI bundles at build time, embedding them into your elixr package
(Emphasis mine :laughing:)

Aha! We hadn?t though of that being an ?option 3? but that seems like it should work. I?m not sure on all the details of how to do it idiomatically in Elixir but we can start looking into it.</div></div></div><br/>
<div><a id="1632521855.125600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632521855.125600" ><div class="time">2021-09-24 22:17</div></a><div class="msg">&gt; *at build time*
^ You can do this at the time you build the elixir package, not at the time the user builds</div></div></div><br/>
<div><a id="1632521930.125900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632521930.125900" ><div class="time">2021-09-24 22:18</div></a><div class="msg">In pact-js, we do this with bash - here's the script (it also downloads the standalone ruby binaries):

<a href="https://github.com/pact-foundation/pact-js-core/blob/master/script/download-libs.sh">https://github.com/pact-foundation/pact-js-core/blob/master/script/download-libs.sh</a></div></div></div><br/>
<div><a id="1632527457.126300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632527457.126300" ><div class="time">2021-09-24 23:50</div></a><div class="msg">Exactly. You want to ship a package that doesn't require anything special on the part of the user. No extra dependencies, or user build time downloads where proxies etc can get in the way</div></div></div><br/>
<div><a id="1632826695.126700"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632826695.126700" ><div class="time">2021-09-28 10:58</div></a><div class="msg">hello all,
I am on a mac
I cloned and build the `c` bindings/FFI project in <a href="https://github.com/pact-foundation/pact-reference">https://github.com/pact-foundation/pact-reference</a>
when i run.  I am getting a `dyld: Library not loaded: @rpath/libssh2.1.dylib` when I run the command

```src/consumer-verification basic src/libpact_ffi.dylib```
I copied `libpact_ffi.dylib` to the same directory where ?consumer-verification? is.

I?ve tried installing libssh2 using Brew, i recreated the links to point to where the library lives and still seeing that error.

I?ve tried other things like what?s in this article <a href="https://blog.krzyzanowskim.com/2018/12/05/rpath-what/">https://blog.krzyzanowskim.com/2018/12/05/rpath-what/</a> to no avail.

Can someone point me to how to get around this?  I am sorry, the setup appears to be trivial and it might be so but I can?t figure it out.</div></div></div><br/>
<div><a id="1632828735.127100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632828735.127100" ><div class="time">2021-09-28 11:32</div></a><div class="msg">how are you linking to the dylib?</div></div></div><br/>
<div><a id="1632828765.127300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632828765.127300" ><div class="time">2021-09-28 11:32</div></a><div class="msg">Are you using the c example in there, or are you writing your own FFI integration?</div></div></div><br/>
<div><a id="1632828810.127500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632828810.127500" ><div class="time">2021-09-28 11:33</div></a><div class="msg">I?d honestly start by downloading the dylib directly from Github, and creating a standalone script that can load the dylib and execute a function. Perhaps the verifier, because it will spit output if you don?t pass the correct args which means it worked</div></div></div><br/>
<div><a id="1632828854.127700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632828854.127700" ><div class="time">2021-09-28 11:34</div></a><div class="msg">That being said, dylib is a dynamically linked library - that seems to indicate it doesn?t know where libssh is</div></div></div><br/>
<div><a id="1632831273.127900"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632831273.127900" ><div class="time">2021-09-28 12:14</div></a><div class="msg">i am using the c example in there.

i also downloaded the library directly from GitHub.  Tried building it myself and the one i downloaded.

i think the error is due to yet another library `libssl` that somehow the system is not finding even though it is on my machine in `/usr/local/Cellar` that is being pointed to via a soft link from a file in `/usr/local/lib`</div></div></div><br/>
<div><a id="1632831300.128100"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632831300.128100" ><div class="time">2021-09-28 12:15</div></a><div class="msg">i thought I would start by looking at the `c` example in there.</div></div></div><br/>
<div><a id="1632831364.128300"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632831364.128300" ><div class="time">2021-09-28 12:16</div></a><div class="msg">i am following the directions in the `README.md` at ?c/consumer-verification/README.md?</div></div></div><br/>
<div><a id="1632831582.128500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632831582.128500" ><div class="time">2021-09-28 12:19</div></a><div class="msg">ah, I?m out - it?s C :laughing:</div></div></div><br/>
<div><a id="1632831627.128700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632831627.128700" ><div class="time">2021-09-28 12:20</div></a><div class="msg">This example made sense to me: <a href="https://andrealeopardi.com/posts/using-c-from-elixir-with-nifs/">https://andrealeopardi.com/posts/using-c-from-elixir-with-nifs/</a></div></div></div><br/>
<div><a id="1632831646.129000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632831646.129000" ><div class="time">2021-09-28 12:20</div></a><div class="msg">I think you can just skip to ?Loading NIFs in Elixir?</div></div></div><br/>
<div><a id="1632831708.129200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632831708.129200" ><div class="time">2021-09-28 12:21</div></a><div class="msg">See if you can call this: <a href="https://docs.rs/pact_ffi/0.0.2/pact_ffi/fn.pactffi_version.html">https://docs.rs/pact_ffi/0.0.2/pact_ffi/fn.pactffi_version.html</a></div></div></div><br/>
<div><a id="1632831710.129500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632831710.129500" ><div class="time">2021-09-28 12:21</div></a><div class="msg">and print it out</div></div></div><br/>
<div><a id="1632934638.130000"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632934638.130000" ><div class="time">2021-09-29 16:57</div></a><div class="msg">@matt.fellows are you thinking we should have a little bit of C code in the Elixir project in order to wrap the FFI lib, so it becomes a NIF? In order to make a C library into a NIF, it needs to be compiled with `#include "erl_nif.h"`  and NIF-related args on the available functions. (See ?Defining a NIF? in the doc you linked)

I see some downsides to doing it this way:

? Complexity of the pact_elixir library?s pipeline: we need to download the FFI bundle at package-time _and_ compile a C NIF wrapper around it at compile-time
? Complexity of the library?s code: we need to write NIF-friendly C shims around every FFI function, then Elixir shims around the NIF shims
? App build-time performance: We have to do the work to compile the C NIF around the FFI bundle
Maybe we plan on using the <a href="https://erlang.org/doc/tutorial/introduction.html">https://erlang.org/doc/tutorial/introduction.html</a> to raw C libs instead, like ports or port drivers, instead? That way we just rely on the FFI bundle itself.</div></div></div><br/>
<div><a id="1632957890.130200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632957890.130200" ><div class="time">2021-09-29 23:24</div></a><div class="msg">No you don't need to write C code, you can just link the library directly (hence skip the step about C)</div></div></div><br/>
<div><a id="1632957952.130400"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632957952.130400" ><div class="time">2021-09-29 23:25</div></a><div class="msg">Therefore, we should not write a NIF wrapper, right?

EDIT: to clarify, not sure I fully understand the implication in your message, so just wanted to double-check!</div></div></div><br/>
<div><a id="1632958024.130600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632958024.130600" ><div class="time">2021-09-29 23:27</div></a><div class="msg">This is where I am out of my depth and may well be giving bad advice.</div></div></div><br/>
<div><a id="1632958035.130800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632958035.130800" ><div class="time">2021-09-29 23:27</div></a><div class="msg">Most languages have a way to just link to a C library</div></div></div><br/>
<div><a id="1632958054.131100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632958054.131100" ><div class="time">2021-09-29 23:27</div></a><div class="msg">I don't fully appreciate the complexities of the NIF tho</div></div></div><br/>
<div><a id="1632958082.131300"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958082.131300" ><div class="time">2021-09-29 23:28</div></a><div class="msg">OK cool. Yeah I think we should be looking for those simpler approaches as well. I haven?t had to write one so I?m a little out of my depth too!</div></div></div><br/>
<div><a id="1632958166.131600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632958166.131600" ><div class="time">2021-09-29 23:29</div></a><div class="msg">Our libraries export a C Interface, so if you can make Elixr communicate with that you should be golden</div></div></div><br/>
<div><a id="1632958220.131800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958220.131800" ><div class="time">2021-09-29 23:30</div></a><div class="msg">So, in pact-js, we use a native wrapper provided by tooling that is designed to link from node. This means that:

1) We download the lib + bundle it before the pact-js package is published for users
2) When users install, there's a compile step (abstracted from us and users) provided by the node linking tooling

If that tooling doesn't exist in Elixir and there are hoops to jump through to call a C interface, you might have to do something custom</div></div></div><br/>
<div><a id="1632958256.132000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958256.132000" ><div class="time">2021-09-29 23:30</div></a><div class="msg">hopefully that isn't necessary, or whatever it is can be done automatically easily</div></div></div><br/>
<div><a id="1632958263.132200"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958263.132200" ><div class="time">2021-09-29 23:31</div></a><div class="msg">From the limited context I have at this point - Erlang+Elixir NIFs are an abstraction on top of FFI that give you more safety. You know how there are new classes of errors that can occur in FFI that wouldn?t otherwise happen in higher-level languages (segfaults, some types of memory leaks, etc.) so NIFs add some extra checking on inputs and outputs that go across the FFI bridge, so if something crazy happens in the FFI code, it?s less likely to blow up the higher-level runtime. But you have to opt into NIFs. In other words, you can?t create a NIF by just linking Elixir straight to a C lib, you need that C lib to have NIF headers.</div></div></div><br/>
<div><a id="1632958323.132500"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958323.132500" ><div class="time">2021-09-29 23:32</div></a><div class="msg">@tjones could you post a link to the source of that wrapper? That actually sounds pretty analogous to NIFs!</div></div></div><br/>
<div><a id="1632958336.132700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958336.132700" ><div class="time">2021-09-29 23:32</div></a><div class="msg">I... can, but we don't even touch it</div></div></div><br/>
<div><a id="1632958359.132900"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958359.132900" ><div class="time">2021-09-29 23:32</div></a><div class="msg">Oh, the wrapper code is _generated code_, that?s what you?re saying, right?</div></div></div><br/>
<div><a id="1632958361.133100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958361.133100" ><div class="time">2021-09-29 23:32</div></a><div class="msg">from pact-js' perspective, we just tell that wrapper to link the ffi lib (and describe the interface that we want)</div></div></div><br/>
<div><a id="1632958422.133500"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958422.133500" ><div class="time">2021-09-29 23:33</div></a><div class="msg">OK awesome, I?m hoping we can find something similar in the Elixir ecosystem</div></div></div><br/>
<div><a id="1632958433.133700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958433.133700" ><div class="time">2021-09-29 23:33</div></a><div class="msg">I'd be very surprised if there isn't</div></div></div><br/>
<div><a id="1632958458.133900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958458.133900" ><div class="time">2021-09-29 23:34</div></a><div class="msg">a quick google suggests that we _could_ parse the .h file and write a NIF wrapper fairly easily</div></div></div><br/>
<div><a id="1632958467.134100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958467.134100" ><div class="time">2021-09-29 23:34</div></a><div class="msg">sooo hopefully someone else has already done that</div></div></div><br/>
<div><a id="1632958503.134500"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958503.134500" ><div class="time">2021-09-29 23:35</div></a><div class="msg">Yeah I?d love to piggyback on a battle-tested implementation of that header parsing</div></div></div><br/>
<div><a id="1632958523.134700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958523.134700" ><div class="time">2021-09-29 23:35</div></a><div class="msg">For interest, this is how we define it (partial implementation):

<a href="https://github.com/pact-foundation/pact-js-core/blob/feat/ffi-consumer/src/ffi/declarations.ts">https://github.com/pact-foundation/pact-js-core/blob/feat/ffi-consumer/src/ffi/declarations.ts</a></div></div></div><br/>
<div><a id="1632958538.134900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632958538.134900" ><div class="time">2021-09-29 23:35</div></a><div class="msg">(but I don't think that's going to be useful to you)</div></div></div><br/>
<div><a id="1632958593.135100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1632958593.135100" ><div class="time">2021-09-29 23:36</div></a><div class="msg">Sorry I'm just getting jab #2... Will jump back in here later</div></div></div><br/>
<div><a id="1632958969.135300"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632958969.135300" ><div class="time">2021-09-29 23:42</div></a><div class="msg">Thanks for the link. I like seeing all the declarations there, that?s a good way to see the shape of the functions we need to call.

I?m trying to figure out what libs we might need that would behave similar to the `ref-napi` and `ref-struct-di` packages. I don?t fully grok what they?re doing yet but I can see they?re providing TS definitions and? emulations of C structs through JS buffers?</div></div></div><br/>
<div><a id="1632959083.135500"><img src="https://avatars.slack-edge.com/2021-08-12/2375184816402_08eb72bc6b3a829ac239_72.jpg" /></a><div class="message"><div class="username">andrew.jensen</div><a style="text-decoration: none" href="#1632959083.135500" ><div class="time">2021-09-29 23:44</div></a><div class="msg">Anyway, this gives us some great things to research. Thank you both for the help!</div></div></div><br/>
<div><a id="1632959154.135700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632959154.135700" ><div class="time">2021-09-29 23:45</div></a><div class="msg">They're providing the bindings of node types to C</div></div></div><br/>
<div><a id="1632959160.135900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632959160.135900" ><div class="time">2021-09-29 23:46</div></a><div class="msg">so, we don't have to do anything special with C strings</div></div></div><br/>
<div><a id="1632959168.136100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1632959168.136100" ><div class="time">2021-09-29 23:46</div></a><div class="msg">(for example)</div></div></div><br/>
<div><a id="1632997226.136700"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1632997226.136700" ><div class="time">2021-09-30 10:20</div></a><div class="msg">thanks matt a Timothy for your answers, thank you Andrew for the questions.  Now i have a better idea as to what approach to take.</div></div></div><br/>
<div><a id="1633002023.136900"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1633002023.136900" ><div class="time">2021-09-30 11:40</div></a><div class="msg">@matt.fellows you said
&gt;  Our libraries export a C Interface, so if you can make Elixir communicate with that you should be golden
Do you mean in the Pact Reference Project?  If not that project then which project?

on an unrelated note:
I cloned the pact-reference libpact ffi project and got the javascript and the c projects to build.  Just yesterday I got the `c` binary to run.    I did this with the hope of familiarizing how these languages define and then use the .dylib Pact libraries.

From what was said above I think I have ideas as to how to take our next steps.</div></div></div><br/>
<div><a id="1633002229.137100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633002229.137100" ><div class="time">2021-09-30 11:43</div></a><div class="msg">By C interface, I don?t me C code, I mean something that can interop with C itself (usually shipped in the form of a dynamic or static library. We suggest using one of the dynamic libs: .so, .dylib, .dll)</div></div></div><br/>
<div><a id="1633002244.137300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633002244.137300" ><div class="time">2021-09-30 11:44</div></a><div class="msg">But it sounds like you have a grasp on it! :clap:</div></div></div><br/>
<div><a id="1633008218.138500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633008218.138500" ><div class="time">2021-09-30 13:23</div></a><div class="msg">@uglyog is this what I think it is  <a href="https://github.com/pact-foundation/pact-reference/commit/42be9eb8">https://github.com/pact-foundation/pact-reference/commit/42be9eb8</a>? :eyes:

Do we need to migrate to the newer provider verifier methods for this to work, or is the second log extraction function (`pactffi_verifier_logs_for_provider`) that just uses the name of the provider sufficient?

<a href="https://github.com/pact-foundation/pact-reference/commit/42be9eb8#diff-0683cbee93e01f96b27383c0954421fc5be638947d54311f880ba9b84ba2cb61R652">https://github.com/pact-foundation/pact-reference/commit/42be9eb8#diff-0683cbee93e01f96b27383c0954421fc5be638947d54311f880ba9b84ba2cb61R652</a></div></div></div><br/>
<div><a id="1633008222.138700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633008222.138700" ><div class="time">2021-09-30 13:23</div></a><div class="msg">cc: @tjones</div></div></div><br/>
<div><a id="1633010688.139000"><img src="https://secure.gravatar.com/avatar/4a03f868d2d46a2862311449ede0534f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png" /></a><div class="message"><div class="username">pedroefajardo_pactio</div><a style="text-decoration: none" href="#1633010688.139000" ><div class="time">2021-09-30 14:04</div></a><div class="msg">ok great.  yeah, i think i got it.  thank you</div></div></div><br/>
<div><a id="1633045583.139800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633045583.139800" ><div class="time">2021-09-30 23:46</div></a><div class="msg">A warning for everyone - if you call `pactffi_write_pact_file`, it writes the pact file even if the test run was unsuccessful.</div></div></div><br/>
<div><a id="1633045644.139900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633045644.139900" ><div class="time">2021-09-30 23:47</div></a><div class="msg">Thanks. I don't think we need this for pact-js - what we do need is to be able to have the log levels standardised with pact-js.</div></div></div><br/>
<div><a id="1633045701.140200"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633045701.140200" ><div class="time">2021-09-30 23:48</div></a><div class="msg">but it's a problem because Rust's logs are very noisy. I think the solution probably lies in having two loggers - one for the pact framework, and then the library logger for maintainers</div></div></div><br/>
<div><a id="1633045868.140400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633045868.140400" ><div class="time">2021-09-30 23:51</div></a><div class="msg"><a href="https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1630466269025200?thread_ts=1630155164.013300&amp;cid=C02BXLDJ7JR">https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1630466269025200?thread_ts=1630155164.013300&amp;cid=C02BXLDJ7JR</a></div></div></div><br/>
<div><a id="1633060382.140900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633060382.140900" ><div class="time">2021-10-01 03:53</div></a><div class="msg">Yes, sorry I was confused about what you wanted the other day - have had too many of these chats with people recently</div></div></div><br/>
<div><a id="1633060449.141100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633060449.141100" ><div class="time">2021-10-01 03:54</div></a><div class="msg">I can look at the default noise (i suppose that would be INFO level). Anything there that is more about debugging a problem will go back to debug level. I?ll start there and we can iterate</div></div></div><br/>
<div><a id="1633060464.141300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633060464.141300" ><div class="time">2021-10-01 03:54</div></a><div class="msg">I?ll use the existing Ruby output as a guide also (there are many notices and I think they are important)</div></div></div><br/>
<div><a id="1633162820.142700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633162820.142700" ><div class="time">2021-10-02 08:20</div></a><div class="msg">Having a look at this, or rather attempting to but a bit stuck getting started :slightly_smiling_face:</div></div></div><br/>
<div><a id="1633162823.142900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633162823.142900" ><div class="time">2021-10-02 08:20</div></a><div class="msg">Right, trying to take a look at the logging, but I'm having some difficulty reproducing some of the issues, I'll reply in thread to myself here to avoid spamming with long copy/pastes :slightly_smiling_face: TLDR: can't get it to spew out noisy logs as expected</div></div></div><br/>
<div><a id="1633162869.143000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633162869.143000" ><div class="time">2021-10-02 08:21</div></a><div class="msg">So, I'm on this branch:
&gt; mgeeves@bearly:~/dev/GitHub/pact-foundation/pact-js-core$ git branch
&gt; * feat/ffi-consumer
&gt; master

I've changed the logLevel to trace:
&gt; mgeeves@bearly:~/dev/GitHub/pact-foundation/pact-js-core$ grep logLevel test/verifier.integration.spec.ts
&gt; logLevel: 'trace' as LogLevel,

And added in using the DEFAULT_ARGS to all the tests (was only used on 2?)
&gt; mgeeves@bearly:~/dev/GitHub/pact-foundation/pact-js-core$ git diff | head -40
&gt; diff --git a/test/verifier.integration.spec.ts b/test/verifier.integration.spec.ts
&gt; index 8f037b2..88a54e1 100644
&gt; --- a/test/verifier.integration.spec.ts
&gt; +++ b/test/verifier.integration.spec.ts
&gt; @@ -18,7 +18,7 @@ describe('Verifier Integration Spec', () =&gt; {
&gt; const pactBrokerBaseUrl = `<a href="http://localhost">http://localhost</a>:${PORT}`;
&gt; const monkeypatchFile: string = path.resolve(__dirname, 'monkeypatch.rb');
&gt; const DEFAULT_ARGS = {
&gt; - logLevel: 'debug' as LogLevel,
&gt; + logLevel: 'trace' as LogLevel,
&gt; providerVersion: 'VERSION',
&gt; };
&gt; 
&gt; @@ -52,6 +52,7 @@ describe('Verifier Integration Spec', () =&gt; {
&gt; it('should return a successful promise', () =&gt;
&gt; expect(
&gt; verifierFactory({
&gt; + ...DEFAULT_ARGS,
&gt; providerBaseUrl: providerBaseUrl,
&gt; pactUrls: [
&gt; path.resolve(__dirname, 'integration/me-they-success.json'),
&gt; @@ -64,6 +65,7 @@ describe('Verifier Integration Spec', () =&gt; {
&gt; it('should return a successful promise', () =&gt;
&gt; expect(
&gt; verifierFactory({
&gt; + ...DEFAULT_ARGS,

But if I try and look at the levels coming out:
&gt; mgeeves@bearly:~/dev/GitHub/pact-foundation/pact-js-core$ npx mocha test/verifier.integration.spec.ts 2&gt;&amp;1 | grep -E "DEBUG|ERROR|INFO|TRACE|WARN" | awk {'print $2'} | sort | uniq -c
&gt; 1 07:54:03.009
&gt; 1 07:54:03.035
&gt; 1 07:54:03.036
&gt; 2 07:54:03.038
&gt; 2 07:54:03.045
&gt; 1 07:54:03.046
&gt; 1 07:54:03.047
&gt; 3 07:54:03.048
&gt; 2 07:54:03.049
&gt; 2 07:54:03.051
&gt; 2 07:54:03.053
&gt; 2 07:54:03.056
&gt; 1 07:54:03.060
&gt; 1 07:54:03.061
&gt; 1 07:54:03.064
&gt; 1 07:54:03.065
&gt; 2 07:54:03.066
&gt; 2 07:54:03.068
&gt; 2 07:54:03.069
&gt; 1 07:54:03.070
&gt; 1 07:54:03.071
&gt; 1 07:54:03.072
&gt; 4 ERROR
&gt; 90 INFO
&gt; 34 WARN
Those timestamps are from a slightly different formatted entry:
&gt; mgeeves@bearly:~/dev/GitHub/pact-foundation/pact-js-core$ npx mocha test/verifier.integration.spec.ts 2&gt;&amp;1 | grep "+0000] INFO" | tail -2
&gt; [2021-10-02 07:54:28.500 +0000] INFO (1689259 on bearly): pact-core@13.1.7: Verifying Pact Files
&gt; [2021-10-02 07:54:28.501 +0000] INFO (1689259 on bearly): pact-core@13.1.7: Verification successful
[9:00 AM] I'm not getting anything producing excessive Rust logs:thinking_face:</div></div></div><br/>
<div><a id="1633162952.143200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633162952.143200" ><div class="time">2021-10-02 08:22</div></a><div class="msg">Logs like this one are the type Tim was talking about ideally being reduced since they are more verbose than you would probably want as INFO when looking as a pact user:
&gt; [2021-10-02T08:07:03Z INFOpact_verifier::provider_client] Received response: Response ( status: 200, headers: Some({"access-control-allow-origin": ["*"], "content-length": ["26"], "content-type": ["application/json; charset=utf-8"], "etag": ["W/\"1a-ztXXi0g2amFzJAkK4azzbA+THms\""], "date": ["Sat", "02 Oct 2021 08:07:03 GMT"], "connection": ["keep-alive"], "x-powered-by": ["Express"]}), body: Present(26 bytes, application/json;charset=utf-8) )
.... but I can't see even with it set to TRACE a huge amount of logs coming from the Rust libs</div></div></div><br/>
<div><a id="1633162997.143500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633162997.143500" ><div class="time">2021-10-02 08:23</div></a><div class="msg">I was expecting to get flooded with the low level lib logs, but don't seem to be getting any :thinking_face:</div></div></div><br/>
<div><a id="1633163057.143700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633163057.143700" ><div class="time">2021-10-02 08:24</div></a><div class="msg">I may have misunderstood the starting point with this, if for example the logs being sent back via ffi are specifically the pact ones, and the low level Rust logs are already excluded, in which case I'm starting in the wrong place :smile:</div></div></div><br/>
<div><a id="1633163134.143900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633163134.143900" ><div class="time">2021-10-02 08:25</div></a><div class="msg">Just on mobile (of course) but they definitely don't look like trace logs to me 

You could probably just invoke the provider verifier outside of node JS directly and just point at a pre canned pact file and any http server (whether it implements the pact or not)</div></div></div><br/>
<div><a id="1633163155.144100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633163155.144100" ><div class="time">2021-10-02 08:25</div></a><div class="msg">I.e. compile it locally or pull the latest binary down</div></div></div><br/>
<div><a id="1633163195.144300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633163195.144300" ><div class="time">2021-10-02 08:26</div></a><div class="msg">:thinking_face:</div></div></div><br/>
<div><a id="1633163312.144500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633163312.144500" ><div class="time">2021-10-02 08:28</div></a><div class="msg">When you say directly, the ffi still needs to be loaded in by something, JS, python etc</div></div></div><br/>
<div><a id="1633163824.145100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633163824.145100" ><div class="time">2021-10-02 08:37</div></a><div class="msg">The rust core also has a CLI you could use</div></div></div><br/>
<div><a id="1633164259.145300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633164259.145300" ><div class="time">2021-10-02 08:44</div></a><div class="msg">Yeah, the CLI is what I'm talking about. It's exactly the same code that fires. The only difference is how the arguments get there</div></div></div><br/>
<div><a id="1633165250.145700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633165250.145700" ><div class="time">2021-10-02 09:00</div></a><div class="msg">:thinking_face: so I've built pact_cli</div></div></div><br/>
<div><a id="1633165289.145900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633165289.145900" ><div class="time">2021-10-02 09:01</div></a><div class="msg">I assume not this one though</div></div></div><br/>
<div><a id="1633165291.146100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633165291.146100" ><div class="time">2021-10-02 09:01</div></a><div class="msg">&gt; mgeeves@bearly:~/dev/GitHub/pact-reference/rust$ ./target/debug/pact-file-verifier -d /home/mgeeves/dev/GitHub/pact-python/examples/pacts --loglevel trace
&gt; Verification result is OK
&gt; 
&gt;   1) /home/mgeeves/dev/GitHub/pact-python/examples/pacts/pact-consumer-one-pact-provider-one.json: OK
&gt; 
&gt; 
&gt; There were 0 error(s) and 0 warning(s) in 1 file(s)</div></div></div><br/>
<div><a id="1633165504.146300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633165504.146300" ><div class="time">2021-10-02 09:05</div></a><div class="msg">:facepalm: ok pact-verifier-cli, I didn't scroll</div></div></div><br/>
<div><a id="1633167071.146500"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633167071.146500" ><div class="time">2021-10-02 09:31</div></a><div class="msg">and for my reference later, so then:
&gt; $ ./target/debug/pact_verifier_cli -d /home/mgeeves/dev/GitHub/pact-python/examples/pacts --loglevel trace --port 35159
seems to be it</div></div></div><br/>
<div><a id="1633168155.146700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633168155.146700" ><div class="time">2021-10-02 09:49</div></a><div class="msg">js-core bugfix from Tim and I think we're almost ready to start :smile:</div></div></div><br/>
<div><a id="1633184110.147800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633184110.147800" ><div class="time">2021-10-02 14:15</div></a><div class="msg">Yes. Someone broke the logging in js-core. And by someone I mean me</div></div></div><br/>
<div><a id="1633460360.148600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633460360.148600" ><div class="time">2021-10-05 18:59</div></a><div class="msg">Quick question - the `include_wip_pacts_since` argument for the Pact Broker, is there any documentation on what form that can take? I've had a look and can't find any.</div></div></div><br/>
<div><a id="1633462634.148700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633462634.148700" ><div class="time">2021-10-05 19:37</div></a><div class="msg">Looks like it should be YYYY-MM-DD going by <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/verifier/mod.rs">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/verifier/mod.rs</a></div></div></div><br/>
<div><a id="1633462649.149000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633462649.149000" ><div class="time">2021-10-05 19:37</div></a><div class="msg">&gt;     /// If the `include_wip_pacts_since` option is provided, it needs to be a date formatted in
&gt;     /// ISO format (YYYY-MM-DD).</div></div></div><br/>
<div><a id="1633466759.149200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633466759.149200" ><div class="time">2021-10-05 20:45</div></a><div class="msg">I think it actually can take any date like thing, but ISO format is definitely supported</div></div></div><br/>
<div><a id="1633472662.149400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1633472662.149400" ><div class="time">2021-10-05 22:24</div></a><div class="msg">It is documented here: <a href="https://docs.pact.io/pact_broker/advanced_topics/wip_pacts/#to-start-using-the-wip-pacts-feature">https://docs.pact.io/pact_broker/advanced_topics/wip_pacts/#to-start-using-the-wip-pacts-feature</a></div></div></div><br/>
<div><a id="1633472729.149600"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1633472729.149600" ><div class="time">2021-10-05 22:25</div></a><div class="msg">Examples are all ISO format</div></div></div><br/>
<div><a id="1633500071.149900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633500071.149900" ><div class="time">2021-10-06 06:01</div></a><div class="msg">Sounds like a bug if it can accept anything other than ISO :grinning:</div></div></div><br/>
<div><a id="1633501365.150100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633501365.150100" ><div class="time">2021-10-06 06:22</div></a><div class="msg">I seem to recall that Beth said the gem it used could expect things like ?Wednesday 3rd March 2020?</div></div></div><br/>
<div><a id="1633501371.150300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633501371.150300" ><div class="time">2021-10-06 06:22</div></a><div class="msg">but I may be remembering wrong</div></div></div><br/>
<div><a id="1633594773.150500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633594773.150500" ><div class="time">2021-10-07 08:19</div></a><div class="msg">Yeah, weirdly in my test for this feature it uses `5d` (as in '5 days ago') to pass in. If it has to be a date then I can change the API to make sure we pass in a proper Date object since currently it's just a string</div></div></div><br/>
<div><a id="1633594832.150700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633594832.150700" ><div class="time">2021-10-07 08:20</div></a><div class="msg">:open_mouth:</div></div></div><br/>
<div><a id="1633594989.150900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633594989.150900" ><div class="time">2021-10-07 08:23</div></a><div class="msg">From an API/testing pov that sounds like something likely to get unexpected/difficult to reproduce etc behaviour :thinking_face:
Is that something with an actual use case people want? (Interested to understand rather than "that's horrible how could you!" :grinning: )</div></div></div><br/>
<div><a id="1633595026.151100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633595026.151100" ><div class="time">2021-10-07 08:23</div></a><div class="msg">Yeah I have no idea where I even got that from :joy: I'll fix it</div></div></div><br/>
<div><a id="1633595059.151300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633595059.151300" ><div class="time">2021-10-07 08:24</div></a><div class="msg">:joy:</div></div></div><br/>
<div><a id="1633595580.151500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633595580.151500" ><div class="time">2021-10-07 08:33</div></a><div class="msg">I think this confirms my suspicion about it dealing with "date like" formats</div></div></div><br/>
<div><a id="1633597505.151700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633597505.151700" ><div class="time">2021-10-07 09:05</div></a><div class="msg">OK I've made that a proper date in PactNet now:
<a href="https://github.com/pact-foundation/pact-net/pull/333">https://github.com/pact-foundation/pact-net/pull/333</a></div></div></div><br/>
<div><a id="1633600656.152900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633600656.152900" ><div class="time">2021-10-07 09:57</div></a><div class="msg">Has anyone upgraded to FFI v0.0.3 yet? As soon as I do the verifier starts panicking, but without any output in .Net I can't work out why... 0.0.2 and earlier is absolutely fine, and I'm literally just upgrading the library version with no other changes</div></div></div><br/>
<div><a id="1633600874.153000"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633600874.153000" ><div class="time">2021-10-07 10:01</div></a><div class="msg">Oh dear, this looks bad... I thik it's related to the change to use native cert stores:

```$ RUST_BACKTRACE=full /d/Downloads/pact_verifier_cli.exe --provider-name "Event API" --hostname localhost --port 9222 --
filter-consumer "Event API Consumer" --file 'C:\git\pact-net\samples\EventApi\Consumer.Tests\pacts\Event API Consumer-Ev
ent API.json' --state-change-url <a href="http://localhost:9222/provider-states">http://localhost:9222/provider-states</a>

Verifying a pact between Event API Consumer and Event API
thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: Custom { kind: InvalidData, error: Custom { kind: InvalidData, error: BadDER } }', C:\Users\runneradmin\.cargo\registry\src\github.com-1ecc6299db9ec823\reqwest-0.11.4\src\async_impl\<a href="http://client.rs:297:65">http://client.rs:297:65</a>
stack backtrace:
   0:     0x7ff66797537f - onig_get_regex_by_callout_args
   1:     0x7ff66798c23a - onig_get_regex_by_callout_args
   2:     0x7ff66796ec18 - onig_get_regex_by_callout_args
   3:     0x7ff667977f66 - onig_get_regex_by_callout_args
   4:     0x7ff667977a49 - onig_get_regex_by_callout_args
   5:     0x7ff6679785c5 - onig_get_regex_by_callout_args
   6:     0x7ff6679781b1 - onig_get_regex_by_callout_args
   7:     0x7ff667975c9f - onig_get_regex_by_callout_args
   8:     0x7ff667978109 - onig_get_regex_by_callout_args
   9:     0x7ff6679e18a0 - onig_unicode_define_user_property
  10:     0x7ff6679e19b3 - onig_unicode_define_user_property
  11:     0x7ff66767e528 - onig_get_options
  12:     0x7ff6672ef2f6 - &lt;unknown&gt;
  13:     0x7ff667347880 - &lt;unknown&gt;
  14:     0x7ff667323e3e - &lt;unknown&gt;
  15:     0x7ff6672fc7e0 - &lt;unknown&gt;
  16:     0x7ff66730cd28 - &lt;unknown&gt;
  17:     0x7ff66731467c - &lt;unknown&gt;
  18:     0x7ff6672d6b59 - &lt;unknown&gt;
  19:     0x7ff6673235bf - &lt;unknown&gt;
  20:     0x7ff6672f5472 - &lt;unknown&gt;
  21:     0x7ff667350283 - &lt;unknown&gt;
  22:     0x7ff66735996b - &lt;unknown&gt;
  23:     0x7ff6673200aa - &lt;unknown&gt;
  24:     0x7ff6673296a6 - &lt;unknown&gt;
  25:     0x7ff667350cd6 - &lt;unknown&gt;
  26:     0x7ff66730d97c - &lt;unknown&gt;
  27:     0x7ff667978b26 - onig_get_regex_by_callout_args
  28:     0x7ff6673297c7 - &lt;unknown&gt;
  29:     0x7ff6679c64d0 - onig_unicode_define_user_property
  30:     0x7ffdd0ab7034 - BaseThreadInitThunk
  31:     0x7ffdd1802651 - RtlUserThreadStart```</div></div></div><br/>
<div><a id="1633601444.153900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633601444.153900" ><div class="time">2021-10-07 10:10</div></a><div class="msg">I've raised the above issue here: <a href="https://github.com/pact-foundation/pact-reference/issues/156">https://github.com/pact-foundation/pact-reference/issues/156</a>. It's definitely something to do with cert stores as the error comes from `reqwest` and relates to DER certs.</div></div></div><br/>
<div><a id="1633603261.154700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1633603261.154700" ><div class="time">2021-10-07 10:41</div></a><div class="msg">If anyone has integration tests checking the pact file is written properly, also note that FFI outputs slightly different content on Windows and Linux:
<a href="https://github.com/pact-foundation/pact-reference/issues/157">https://github.com/pact-foundation/pact-reference/issues/157</a></div></div></div><br/>
<div><a id="1633605929.155600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633605929.155600" ><div class="time">2021-10-07 11:25</div></a><div class="msg">Yes, here's a verifier run with v0.0.3: <a href="https://github.com/pact-foundation/pact-js-core/runs/3755501336#step:4:1713">https://github.com/pact-foundation/pact-js-core/runs/3755501336#step:4:1713</a></div></div></div><br/>
<div><a id="1633605970.156500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633605970.156500" ><div class="time">2021-10-07 11:26</div></a><div class="msg">(note that the build fails because we're having trouble with the ffi wrapper on node 16, but I think that's unrelated. I tried upgrading to 0.0.3 on the off-chance it would fix it)</div></div></div><br/>
<div><a id="1633606063.156800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633606063.156800" ><div class="time">2021-10-07 11:27</div></a><div class="msg">(also, it doesn't mean it works - those tests are not especially intensive)</div></div></div><br/>
<div><a id="1633606266.157000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1633606266.157000" ><div class="time">2021-10-07 11:31</div></a><div class="msg">:open_mouth:</div></div></div><br/>
<div><a id="1633606352.157500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1633606352.157500" ><div class="time">2021-10-07 11:32</div></a><div class="msg">I mean, they do do real verification. But, I wouldn't say it's a full suite</div></div></div><br/>
<div><a id="1633607480.157800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607480.157800" ><div class="time">2021-10-07 11:51</div></a><div class="msg">Just tested the latest locally, and it works against a pactflow hosted account (good)</div></div></div><br/>
<div><a id="1633607495.158000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607495.158000" ><div class="time">2021-10-07 11:51</div></a><div class="msg">So I thought, i?ll just double check it?s not also susceptable to the Let?s Encyrpt issue</div></div></div><br/>
<div><a id="1633607498.158200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607498.158200" ><div class="time">2021-10-07 11:51</div></a><div class="msg">```11:50:26 [ERROR] Failed to load pact - Could not load pacts from the pact broker '<a href="https://host.with.letsencrypt.cert.com">https://host.with.letsencrypt.cert.com</a>' - IO Error - Failed to access pact broker path '/' - error sending request for url (<a href="https://host.with.letsencrypt.cert.com/">https://host.with.letsencrypt.cert.com/</a>): error trying to connect: invalid certificate: UnknownIssuer. URL: '<a href="https://host.with.letsencrypt.cert.com">https://host.with.letsencrypt.cert.com</a>'

Failures:```</div></div></div><br/>
<div><a id="1633607501.158400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607501.158400" ><div class="time">2021-10-07 11:51</div></a><div class="msg">Shit!</div></div></div><br/>
<div><a id="1633607622.158600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607622.158600" ><div class="time">2021-10-07 11:53</div></a><div class="msg">but then realised that isn?t a new Let?s Encrypt endpoint and was a bumsteer from a poster on GH. My mac doesn?t trust it, so I stopped panicking?</div></div></div><br/>
<div><a id="1633607729.159000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633607729.159000" ><div class="time">2021-10-07 11:55</div></a><div class="msg">Line 297 is <a href="https://docs.rs/reqwest/0.11.4/src/reqwest/async_impl/client.rs.html#297">https://docs.rs/reqwest/0.11.4/src/reqwest/async_impl/client.rs.html#297</a>, which is exactly where you?d expect to see problems in rustls-tls-native-roots</div></div></div><br/>
<div><a id="1633608177.159500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1633608177.159500" ><div class="time">2021-10-07 12:02</div></a><div class="msg">From what I can see, you must have an invalid DER certificates in your system which is causing that issue. Looking at the <a href="https://docs.rs/reqwest/0.11.4/src/reqwest/async_impl/client.rs.html#1695-1696">https://docs.rs/reqwest/0.11.4/src/reqwest/async_impl/client.rs.html#1695-1696</a>, it?s assuming that the native certs library doesn?t fail (hence the panic), but that just defers to this <a href="https://github.com/rustls/rustls-native-certs/blob/fb25baaf27c4e70793c1600c844d6a644d0813c0/src/rustls.rs#L31">https://github.com/rustls/rustls-native-certs/blob/fb25baaf27c4e70793c1600c844d6a644d0813c0/src/rustls.rs#L31</a>, which attempts to load each certificate into the trust store. but if ANY certificate is invalid, it instead bails out.

That seems strange to me, but perhaps there is a good reason for that.</div></div></div><br/>
<div><a id="1637365944.000200"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1637365944.000200" ><div class="time">2021-11-19 23:52</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1638396680.000300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1638396680.000300" ><div class="time">2021-12-01 22:11</div></a><div class="msg">Ohh, that's novel, I left a reference for myself and actually found it again :joy:</div></div></div><br/>
<div><a id="1641314358.002300"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641314358.002300" ><div class="time">2022-01-04 16:39</div></a><div class="msg">Is it true that if we use `pactffi_using_plugin` , then we have to use `pactffi_interaction_contents` , and we can't use other ffi functions like:
? `pactffi_message_with_contents`
? `pactffi_with_body`  
?</div></div></div><br/>
<div><a id="1641334848.002400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641334848.002400" ><div class="time">2022-01-04 22:20</div></a><div class="msg">Yes, but that is only for content from plugins</div></div></div><br/>
<div><a id="1641334880.002600"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641334880.002600" ><div class="time">2022-01-04 22:21</div></a><div class="msg">It should be integrated into the other methods at some point, I'm just not sure how it would work</div></div></div><br/>
<div><a id="1641432975.000900"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641432975.000900" ><div class="time">2022-01-06 01:36</div></a><div class="msg">Pact plugin driver doesn't give me the reason why the plugin can not be started:
&gt; 2022-01-06T01:30:14Z ERROR pact_plugin_driver::child_process] Timeout waiting to get plugin startup info: timed out waiting on channel
&gt; [2022-01-06T01:30:15Z ERROR pact_ffi::plugins] Could not load plugin - Plugin process did not output the correct startup message in 60 seconds: timed out waiting on channel</div></div></div><br/>
<div><a id="1641433007.001000"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641433007.001000" ><div class="time">2022-01-06 01:36</div></a><div class="msg">If I run the csv plugin manually, I got this error:</div></div></div><br/>
<div><a id="1641433048.001200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1641433048.001200" ><div class="time">2022-01-06 01:37</div></a><div class="msg">I saw this problem on my Mac a month or two ago, I think there was an issue Ron was working through</div></div></div><br/>
<div><a id="1641433048.001400"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641433048.001400" ><div class="time">2022-01-06 01:37</div></a><div class="msg">```./pact/plugins/csv-0.0.0/pact-plugin-csv                                                                                                                                                                                                                                                08:30:45
./pact/plugins/csv-0.0.0/pact-plugin-csv: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.32' not found (required by ./pact/plugins/csv-0.0.0/pact-plugin-csv)
./pact/plugins/csv-0.0.0/pact-plugin-csv: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.33' not found (required by ./pact/plugins/csv-0.0.0/pact-plugin-csv)
./pact/plugins/csv-0.0.0/pact-plugin-csv: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./pact/plugins/csv-0.0.0/pact-plugin-csv)```</div></div></div><br/>
<div><a id="1641433250.001600"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641433250.001600" ><div class="time">2022-01-06 01:40</div></a><div class="msg">Are you running it in Alpine Linux?</div></div></div><br/>
<div><a id="1641433262.001800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1641433262.001800" ><div class="time">2022-01-06 01:41</div></a><div class="msg">ahh</div></div></div><br/>
<div><a id="1641433356.002000"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641433356.002000" ><div class="time">2022-01-06 01:42</div></a><div class="msg">No, I am running on Linux Mint 20.2 (Based on Ubuntu 20.04)</div></div></div><br/>
<div><a id="1641433483.002200"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641433483.002200" ><div class="time">2022-01-06 01:44</div></a><div class="msg">Quick google: <a href="https://superuser.com/questions/537683/how-to-fix-lib-x86-64-linux-gnu-libc-so-6-version-glibc-2-14-not-found">https://superuser.com/questions/537683/how-to-fix-lib-x86-64-linux-gnu-libc-so-6-version-glibc-2-14-not-found</a></div></div></div><br/>
<div><a id="1641433501.002500"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641433501.002500" ><div class="time">2022-01-06 01:45</div></a><div class="msg">Can you confirm what version of glibc you have?</div></div></div><br/>
<div><a id="1641433545.002700"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641433545.002700" ><div class="time">2022-01-06 01:45</div></a><div class="msg">You will probably need to install 2.14, or build the plugin against the older version</div></div></div><br/>
<div><a id="1641434073.002900"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641434073.002900" ><div class="time">2022-01-06 01:54</div></a><div class="msg">&gt; ldd --version
&gt; ldd (Ubuntu GLIBC 2.31-0ubuntu9.2) 2.31</div></div></div><br/>
<div><a id="1641434149.003200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641434149.003200" ><div class="time">2022-01-06 01:55</div></a><div class="msg">right behind 2.32</div></div></div><br/>
<div><a id="1641435343.003400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641435343.003400" ><div class="time">2022-01-06 02:15</div></a><div class="msg">Probably easier just to build the plugin on your OS</div></div></div><br/>
<div><a id="1641448502.003600"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641448502.003600" ><div class="time">2022-01-06 05:55</div></a><div class="msg">I built it myself and it work fine.</div></div></div><br/>
<div><a id="1641448522.003800"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641448522.003800" ><div class="time">2022-01-06 05:55</div></a><div class="msg">I'm just not sure if it's user friendly</div></div></div><br/>
<div><a id="1641448668.004600"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641448668.004600" ><div class="time">2022-01-06 05:57</div></a><div class="msg">Yeah, we will probably need to support the LTS Linux versions, so will need to build it for different glibc versions</div></div></div><br/>
<div><a id="1641448677.004800"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641448677.004800" ><div class="time">2022-01-06 05:57</div></a><div class="msg">How can we verify provider with pacts created by plugins?</div></div></div><br/>
<div><a id="1641448679.004900"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641448679.004900" ><div class="time">2022-01-06 05:57</div></a><div class="msg">But this one is just a prototype</div></div></div><br/>
<div><a id="1641448725.005100"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641448725.005100" ><div class="time">2022-01-06 05:58</div></a><div class="msg">The verifier will try load any plugin required. It will have been written to the pact file</div></div></div><br/>
<div><a id="1641448762.005300"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641448762.005300" ><div class="time">2022-01-06 05:59</div></a><div class="msg">The plugin will need to be installed where the verifier runs</div></div></div><br/>
<div><a id="1641448847.005500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641448847.005500" ><div class="time">2022-01-06 06:00</div></a><div class="msg">Are there any extra steps or I just run like normal?

I asked because the provider verifier failed without any reason.

```Xdebug: [Step Debug] Could not connect to debugging client. Tried: 127.0.0.1:9003 (through xdebug.client_host/xdebug.client_port) :-(
PHPUnit 9.4.2 by Sebastian Bergmann and contributors.

Test 'Provider\PactVerifyTest::testPactVerifyConsumer' started

Verifying a pact between test_consumer and test_provider
  Given a message
  Given You can hear happiness staggering on down the street

  an alligator named Mary exists
    generates a message which
      includes metadata
        "routing_key" with value "wind cries" (OK)
        "queue" with value "wind cries" (OK)
      has a matching body (OK)

  footprints dressed in red
    generates a message which
      includes metadata
        "routing_key" with value "And the clowns have all gone to bed" (OK)
        "queue" with value "And the clowns have all gone to bed" (OK)
      has a matching body (OK)

Test 'Provider\PactVerifyTest::testPactVerifyConsumer' ended


Time: 01:40.082, Memory: 20.00 MB

There was 1 failure:

1) Provider\PactVerifyTest::testPactVerifyConsumer
Failed asserting that false is true.

/home/tien/Projects/pact-php/example/tests/Provider/PactVerifyTest.php:63```</div></div></div><br/>
<div><a id="1641449358.005700"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641449358.005700" ><div class="time">2022-01-06 06:09</div></a><div class="msg">Maybe the reason is I didn't set the value for `PACT_PLUGIN_DIR` env in provider verify tests. I will test later today.

But the output does not contains any clue make it hard to debug.</div></div></div><br/>
<div><a id="1641481062.005900"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641481062.005900" ><div class="time">2022-01-06 14:57</div></a><div class="msg">That's exactly the issue. I added the env `PACT_PLUGIN_DIR` and it work fine now</div></div></div><br/>
<div><a id="1641629967.010500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641629967.010500" ><div class="time">2022-01-08 08:19</div></a><div class="msg">I'm testing protobuf plugin and here are some problems I got:
? I downloaded this <a href="https://github.com/pact-foundation/pact-plugins/releases/download/protobuf-plugin-0.0.0/pact-protobuf-plugin-0.0.0.zip">https://github.com/pact-foundation/pact-plugins/releases/download/protobuf-plugin-0.0.0/pact-protobuf-plugin-0.0.0.zip</a> and extract to `/custom/path/to/pact/plugins/protobuf-0.0.0` (configured by `PACT_PLUGIN_DIR`), but it does not work, then I realized that I need to move `bin` and `lib` directories inside `pact-protobuf-plugin-0.0.0` directory up to parent directory(to `protobuf-0.0.0`)
? The file `/custom/path/to/pact/plugins/protobuf-0.0.0/bin/pact-protobuf-plugin` need to be executable (it's not by default)
Do I need to create tickets in github for them?</div></div></div><br/>
<div><a id="1641630359.012000"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641630359.012000" ><div class="time">2022-01-08 08:25</div></a><div class="msg">Does Pact Protobuf Plugin support `oneof` feature? I'm getting these error messages:
? `Failed to call out to plugin - Request to configure interaction failed: Message ShapeMessage has no field implementation`
?  `Failed to call out to plugin - Request to configure interaction failed: Message ShapeMessage has no field shape`
 Here is my proto file:
```syntax = "proto3";

package plugins;

option php_generic_services = true;

service Calculator {
    rpc calculate (ShapeMessage) returns (AreaResponse) {}
}

message ShapeMessage {
  oneof shape {
    Square square = 1;
    Rectangle rectangle = 2;
    Circle circle = 3;
    Triangle triangle = 4;
    Parallelogram parallelogram = 5;
  }
}

message Square {
  float edge_length = 1;
}

message Rectangle {
  float length = 1;
  float width = 2;
}

message Circle {
  float radius = 1;
}

message Triangle {
  float edge_a = 1;
  float edge_b = 2;
  float edge_c = 3;
}

message Parallelogram {
  float base_length = 1;
  float height = 2;
}

message AreaResponse {
    float value = 1;
}```</div></div></div><br/>
<div><a id="1641688383.012100"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641688383.012100" ><div class="time">2022-01-09 00:33</div></a><div class="msg">There is not much we can do about that, those bundles are produced that way by the Gradle application plugin.

I've ported the plugin to one that is written in Rust. <a href="https://github.com/pactflow/pact-protobuf-plugin">https://github.com/pactflow/pact-protobuf-plugin</a></div></div></div><br/>
<div><a id="1641688462.012400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641688462.012400" ><div class="time">2022-01-09 00:34</div></a><div class="msg">oneOf is not supported yet. See <a href="https://github.com/pactflow/pact-protobuf-plugin#supported-features">https://github.com/pactflow/pact-protobuf-plugin#supported-features</a></div></div></div><br/>
<div><a id="1641688605.012700"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641688605.012700" ><div class="time">2022-01-09 00:36</div></a><div class="msg">I didn't know this repository exist. Let me try</div></div></div><br/>
<div><a id="1641688819.012900"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641688819.012900" ><div class="time">2022-01-09 00:40</div></a><div class="msg">You will have to build it yourself, as you will also have the glibc issue</div></div></div><br/>
<div><a id="1641688846.013100"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641688846.013100" ><div class="time">2022-01-09 00:40</div></a><div class="msg">But I'll update the CI build to create a LTS version as well</div></div></div><br/>
<div><a id="1641688921.013300"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641688921.013300" ><div class="time">2022-01-09 00:42</div></a><div class="msg">I will. Thanks for your support. You can do it later. Enjoy your holidays.</div></div></div><br/>
<div><a id="1641689012.013500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641689012.013500" ><div class="time">2022-01-09 00:43</div></a><div class="msg">I figured out how to use it properly (at least what I think). So `oneof` is not a problem for now.</div></div></div><br/>
<div><a id="1641699670.013700"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641699670.013700" ><div class="time">2022-01-09 03:41</div></a><div class="msg">Actually `pact-protobuf-plugin` work fine on my machine, I don't need to build</div></div></div><br/>
<div><a id="1641705892.015500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641705892.015500" ><div class="time">2022-01-09 05:24</div></a><div class="msg">Replaced protobuf plugin java version by rust version, I can see that the `body` and `matchingRules` of `request` section is removed. I think it's a bug.</div></div></div><br/>
<div><a id="1641765939.015800"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641765939.015800" ><div class="time">2022-01-09 22:05</div></a><div class="msg">Can you raise an issue for that</div></div></div><br/>
<div><a id="1641824585.016000"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641824585.016000" ><div class="time">2022-01-10 14:23</div></a><div class="msg">I can't reproduce this different, so I can't report it.

But because my test passed with java version, then now failed with rust version, so I think something wrong here, but I don't know why.

I managed to print out `mismatches` :
```[{"method":"POST","mismatches":[{"actual":"","expected":"","mismatch":"Failed to compare the Protobuf messages - Did not find a field with number 2 in the descriptor, Message is Some(\"AreaResponse\"), Fields are {\"value\"}","path":"","type":"BodyMismatch"}],"path":"/calculate","type":"request-mismatch"}]```</div></div></div><br/>
<div><a id="1641824642.016200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641824642.016200" ><div class="time">2022-01-10 14:24</div></a><div class="msg">Can you tell me how to show/get plugin's log (or debug info) when running consumer or provider tests?</div></div></div><br/>
<div><a id="1641853484.016400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641853484.016400" ><div class="time">2022-01-10 22:24</div></a><div class="msg">The logs are captured at the level that your test runs as, so you shouldn't have to do anything. Just set your logging to debug.</div></div></div><br/>
<div><a id="1641861090.016600"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641861090.016600" ><div class="time">2022-01-11 00:31</div></a><div class="msg">you means `LOG_LEVEL=debug` ?
I think it does not work for me
`LOG_LEVEL=debug phpunit --debug -c example/phpunit.plugins.xml`</div></div></div><br/>
<div><a id="1641861259.016800"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641861259.016800" ><div class="time">2022-01-11 00:34</div></a><div class="msg">Oh, sorry, it is invoked via FFI. You need to set the log level via <a href="https://docs.rs/pact_ffi/0.1.5/pact_ffi/log/fn.pactffi_log_to_stdout.html">https://docs.rs/pact_ffi/0.1.5/pact_ffi/log/fn.pactffi_log_to_stdout.html</a></div></div></div><br/>
<div><a id="1641861277.017100"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641861277.017100" ><div class="time">2022-01-11 00:34</div></a><div class="msg">Ideally, it should be set to the log level set in php</div></div></div><br/>
<div><a id="1641861440.017300"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641861440.017300" ><div class="time">2022-01-11 00:37</div></a><div class="msg">Let me try</div></div></div><br/>
<div><a id="1641862537.017500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641862537.017500" ><div class="time">2022-01-11 00:55</div></a><div class="msg">I tried ffi functions and it seem does not work for me
```
$this-&gt;ffi-&gt;pactffi_init('PACT_LOGLEVEL');
//$this-&gt;ffi-&gt;pactffi_logger_init();
//$this-&gt;ffi-&gt;pactffi_logger_apply();
//$this-&gt;ffi-&gt;pactffi_log_to_stdout($this-&gt;ffi-&gt;LevelFilter_Debug);
//$this-&gt;ffi-&gt;pactffi_log_to_stderr($this-&gt;ffi-&gt;LevelFilter_Trace);
$this-&gt;ffi-&gt;pactffi_log_to_file(__DIR__ . '/log.txt', $this-&gt;ffi-&gt;LevelFilter_Debug);```</div></div></div><br/>
<div><a id="1641862558.017700"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641862558.017700" ><div class="time">2022-01-11 00:55</div></a><div class="msg">The file `log.txt` is empty for me</div></div></div><br/>
<div><a id="1641863115.018000"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641863115.018000" ><div class="time">2022-01-11 01:05</div></a><div class="msg">You need to call `pactffi_logger_apply` at the end</div></div></div><br/>
<div><a id="1641863626.018200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641863626.018200" ><div class="time">2022-01-11 01:13</div></a><div class="msg">It work now by combining `pactffi_log_to_stdout` and `pactffi_logger_apply`


Then I realized `$this-&gt;ffi-&gt;pactffi_init('PACT_LOGLEVEL')` output same log, but with colors so it look better.

All I need to do is using `PACT_LOGLEVEL=debug` , not `LOG_LEVEL=debug`

Silly me.</div></div></div><br/>
<div><a id="1641914973.018500"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1641914973.018500" ><div class="time">2022-01-11 15:29</div></a><div class="msg">I reported the issue here <a href="https://github.com/pactflow/pact-protobuf-plugin/issues/1">https://github.com/pactflow/pact-protobuf-plugin/issues/1</a></div></div></div><br/>
<div><a id="1641940057.018900"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1641940057.018900" ><div class="time">2022-01-11 22:27</div></a><div class="msg">Thank you!</div></div></div><br/>
<div><a id="1641967233.019200"><img src="https://avatars.slack-edge.com/2021-08-09/2361631297682_efc9a72070b3c52a3db7_72.jpg" /></a><div class="message"><div class="username">kyle.florence</div><a style="text-decoration: none" href="#1641967233.019200" ><div class="time">2022-01-12 06:00</div></a><div class="msg">@kyle.florence has left the channel</div></div></div><br/>
<div><a id="1643013184.001100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643013184.001100" ><div class="time">2022-01-24 08:33</div></a><div class="msg">Are there any other docs for the new verifier FFI handles approach? There aren't many docs on the functions themselves (the only arg docs are basically for when it's a number interpreted as a boolean). I'm struggling to work out how to actually use this</div></div></div><br/>
<div><a id="1643015369.001200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643015369.001200" ><div class="time">2022-01-24 09:09</div></a><div class="msg">Maybe I'm just grumpy this morning, but I'm finding the FFI approach really difficult to work with. I've upgraded to the latest FFI (0.1.6) in order to start moving to verifier handles, and now all the existing verifier tests fail with an error code which just says they panicked. I have nothing to go off there.

I don't have an awful lot of time to work on it, so now most of that is gonna be taken up trying to debug what breaking change there is in the FFI. Do we publish a changelog or an upgrade guide or something to help guide maintainers through breaking changes to the FFI?

It's very difficult to dip in and out as an open source volunteer otherwise, and just kinda makes me not want to do it.</div></div></div><br/>
<div><a id="1643016232.001400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643016232.001400" ><div class="time">2022-01-24 09:23</div></a><div class="msg">Well at least the CLI panics as well
```$ pact_verifier_cli \
&gt;     --provider-name \
&gt;     "Event API" \
&gt;     --hostname \
&gt;     localhost \
&gt;     --port \
&gt;     9222 \
&gt;     --file \
&gt;     "C:\dev\<a href="http://github.com">http://github.com</a>\pact-net\samples\EventApi\Consumer.Tests\pacts\Event API Consumer-Event API.json" \
&gt;     --state-change-url \
&gt;     <a href="http://localhost:9222/provider-states">http://localhost:9222/provider-states</a>

Verifying a pact between Event API Consumer and Event API
thread 'main' panicked at 'Client::new(): reqwest::Error { kind: Builder, source: MissingOrMalformedExtensions }',
C:\Users\runneradmin\.cargo\registry\src\github.com-1ecc6299db9ec823\reqwest-0.11.7\src\async_impl\<a href="http://client.rs:1251:38">http://client.rs:1251:38</a>
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace```</div></div></div><br/>
<div><a id="1643016282.001600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643016282.001600" ><div class="time">2022-01-24 09:24</div></a><div class="msg">Oh no, I think it's native TLS certs again...</div></div></div><br/>
<div><a id="1643017593.001800"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643017593.001800" ><div class="time">2022-01-24 09:46</div></a><div class="msg">&gt; It's very difficult to dip in and out as an open source volunteer otherwise, and just kinda makes me not want to do it.
This was my experience too</div></div></div><br/>
<div><a id="1643017895.002000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643017895.002000" ><div class="time">2022-01-24 09:51</div></a><div class="msg">I think it's worth taking a step back and designing the interface to the shared core so that it has first-class support for the client frameworks.

For example, at the moment it's hard to know what the lifecycle is intended to be for the different methods (eg, some methods can be called more than once, some silently clobber information - see <a href="https://github.com/pact-foundation/pact-reference/issues/172">https://github.com/pact-foundation/pact-reference/issues/172</a>). A related issue is that if a password is passed via an environment variable as well as via the options, then the verifier fails with an error message that doesn't really describe the situation unless you know how it is implemented.

At the moment, we have to implement this all client-side, which would mean re-implementation in every framework. I don't think this is the intention of the shared core, but without documentation I can't tell if it is the intention or not.</div></div></div><br/>
<div><a id="1643017916.002400"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643017916.002400" ><div class="time">2022-01-24 09:51</div></a><div class="msg">I also can't tell what preconditions are meant to be met for each method.</div></div></div><br/>
<div><a id="1643017962.002600"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643017962.002600" ><div class="time">2022-01-24 09:52</div></a><div class="msg">I'm leaving the project at the end of the month anyway, but my current feeling for pact-js is that it would be less trouble to have our own native JS core.</div></div></div><br/>
<div><a id="1643019493.002800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643019493.002800" ><div class="time">2022-01-24 10:18</div></a><div class="msg">:thinking_face: I really like the idea of shared etc, but I can see how that's really hard to do from an open source pov, imo you need to be able to have "group" discussions and have everyone on board with a direction etc, which seems very hard in an "async" way of working :thinking_face:</div></div></div><br/>
<div><a id="1643019787.003000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643019787.003000" ><div class="time">2022-01-24 10:23</div></a><div class="msg">&gt;  A related issue is that if a password is passed via an environment variable as well as via the options, then the verifier fails with an error message that doesn?t really describe the situation unless you know how it is implemented.
that is not an issue with the handle based interface that Adam is moving towards. The previous one was just a slimy interface on top of the CLI, but the new one is different altogether and doesn?t have this problem (and others).</div></div></div><br/>
<div><a id="1643019843.003200"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643019843.003200" ><div class="time">2022-01-24 10:24</div></a><div class="msg">&gt;  Oh no, I think it?s native TLS certs again...
I need to refresh where that issue got to. I seemed to recall reqwest needed an update to the latest and/or there was a PR to reqwest that solved the problem. I?ll add to review this week</div></div></div><br/>
<div><a id="1643019910.003400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643019910.003400" ><div class="time">2022-01-24 10:25</div></a><div class="msg">The new FFI has some confusing points as well though (that don't lend to a fluent interface), and some args that I just can't work out. e.g. this will use basic auth over token auth if you provide both:

```fn pactffi_verifier_broker_source(
      handle: *mut handle::VerifierHandle,
      url: *const c_char,
      provider_name: *const c_char,
      username: *const c_char,
      password: *const c_char,
      token: *const c_char
    )```</div></div></div><br/>
<div><a id="1643019995.003600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643019995.003600" ><div class="time">2022-01-24 10:26</div></a><div class="msg">And I can't work out what the last param of this one does:

```    fn pactffi_verifier_set_filter_info(
      handle: *mut handle::VerifierHandle,
      filter_description: *const c_char,
      filter_state: *const c_char,
      filter_no_state: c_uchar
    )```</div></div></div><br/>
<div><a id="1643020037.003800"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643020037.003800" ><div class="time">2022-01-24 10:27</div></a><div class="msg">Oh does that mean "only run interactions if they have no provider state"? But then what if you pass a `filter_state` as well?</div></div></div><br/>
<div><a id="1643020106.004000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020106.004000" ><div class="time">2022-01-24 10:28</div></a><div class="msg">&gt;  I?m leaving the project at the end of the month anyway, but my current feeling for pact-js is that it would be less trouble to have our own native JS core.
Let?s try and be constructive here. The shared core is a very large beast and any attempt to rebuild it will run into issues of backwards compatibility, interface design, teething issues etc. Unless we can get the whole community to build together, and even then?

It was largely built in personal time (similar to Adam?s comment) and that makes it even more difficult. We?re investing more into it now since Pactflow has been a thing, which has led to several important advancements.

This being said, I think it would be wise to try and get our collective thoughts for improvement together. What do we think the best way of doing that is?</div></div></div><br/>
<div><a id="1643020113.004200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643020113.004200" ><div class="time">2022-01-24 10:28</div></a><div class="msg">To answer my own question - if you specify both then the filter wins and the final arg is ignored</div></div></div><br/>
<div><a id="1643020191.004500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020191.004500" ><div class="time">2022-01-24 10:29</div></a><div class="msg">Sadly Adam I?m not really across the handle based interface, but hopefully Ron can chip in with some guidance. I just know that it apparently solves the existing interface problem (what other issues it might produce I can?t yet say!)</div></div></div><br/>
<div><a id="1643020239.004700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020239.004700" ><div class="time">2022-01-24 10:30</div></a><div class="msg">I do know a few of the models changed (I tagged you in a thread a while back, which I know, is not ideal). We discovered a few of the structs were exposing their insides, and Ron converted them to Opaque types (essentially, a uint)</div></div></div><br/>
<div><a id="1643020438.004900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643020438.004900" ><div class="time">2022-01-24 10:33</div></a><div class="msg">I think one big hurdle to have this used in prod at a wide scale is that when it fails I just got an "it panicked" return code. To debug that I had to run my test in the debugger to start my API, set a breakpoint to stop the test actually running and then manually call the API with the verifier CLI (which is using a different version of the crates to the FFI afaict).

That's quite an involved debugging process, especially for an issue which probably only happens on specific machines (because of the native cert store). We can't really ask users to do that when they have issues, but without that panic info we're pretty stuck with support.</div></div></div><br/>
<div><a id="1643020577.005100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020577.005100" ><div class="time">2022-01-24 10:36</div></a><div class="msg">Yeah, it looks like there are a couple of libraries that have OS/platform type switches in them</div></div></div><br/>
<div><a id="1643020603.005300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020603.005300" ><div class="time">2022-01-24 10:36</div></a><div class="msg">TLS native certs is one, and there is a magic mime detection one that has different behaviour depending on runtime shared libraries. As a principal, I think we want to avoid this</div></div></div><br/>
<div><a id="1643020605.005500"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643020605.005500" ><div class="time">2022-01-24 10:36</div></a><div class="msg">&gt; The previous one was just a slimy interface on top of the CLI, but the new one is different altogether and doesn?t have this problem (and others).
I'm not complaining about that specifically, I'm saying the problem of error messages that might only make sense if you know how the implementation works seems to exist throughout the core.</div></div></div><br/>
<div><a id="1643020661.006100"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643020661.006100" ><div class="time">2022-01-24 10:37</div></a><div class="msg">I think in general, it would benefit from sitting down and thinking about what the best experience for clients would be</div></div></div><br/>
<div><a id="1643020667.006300"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643020667.006300" ><div class="time">2022-01-24 10:37</div></a><div class="msg">and what that boundary looks like</div></div></div><br/>
<div><a id="1643020776.007000"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643020776.007000" ><div class="time">2022-01-24 10:39</div></a><div class="msg">For me, the approach I would like is to agree on some values that guide the design - like I proposed for the logging levels</div></div></div><br/>
<div><a id="1643020857.007300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020857.007300" ><div class="time">2022-01-24 10:40</div></a><div class="msg">I?m sure there are a bunch of principles, so articulating those might be a good start and then we can iterate from there</div></div></div><br/>
<div><a id="1643020889.007500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643020889.007500" ><div class="time">2022-01-24 10:41</div></a><div class="msg">It's weird because we've got like libraries depending on libraries, and I know the core is at the 0.x stage which says "breaking changes can happen".

We really do need to keep those breaking changes to a minimum though, and write upgrade guides for maintainers if we do introduce them. Otherwise we've all got to go digging into the core every time we upgrade and it breaks, and as we've said it's a big beast</div></div></div><br/>
<div><a id="1643020916.007700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020916.007700" ><div class="time">2022-01-24 10:41</div></a><div class="msg">The feedback on the ?doesn?t lend to fluent interface? is interesting, because we?ve seen feedback that suggests it encourgase that (which in the context was a negative). The point here, is we ought to seek feedback from the community on what?s goig to work best, make a decision and move forward</div></div></div><br/>
<div><a id="1643020964.008000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643020964.008000" ><div class="time">2022-01-24 10:42</div></a><div class="msg">&gt;  We really do need to keep those breaking changes to a minimum though, and write upgrade guides for maintainers if we do introduce them. Otherwise we?ve all got to go digging into the core every time we upgrade and it breaks, and as we?ve said it?s a big beast(edited)
I think in the 0.y.z line there were some, but in the x.1.z line the position is no breaking changes. But yes, I agree</div></div></div><br/>
<div><a id="1643021008.008300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021008.008300" ><div class="time">2022-01-24 10:43</div></a><div class="msg">The one I was specifically thinking about was this one:

```    fn pactffi_verifier_set_verification_options(
      handle: *mut handle::VerifierHandle,
      publish: c_uchar,
      provider_version: *const c_char,
      build_url: *const c_char,
      disable_ssl_verification: c_uchar,
      request_timeout: c_ulong,
      provider_tags: *const *const c_char,
      provider_tags_len: c_ushort
    )```</div></div></div><br/>
<div><a id="1643021028.008500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021028.008500" ><div class="time">2022-01-24 10:43</div></a><div class="msg">That's just one big multi-purpose function, instead of more fine-grained ones which you'd typically get in a fluent interface</div></div></div><br/>
<div><a id="1643021052.008800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643021052.008800" ><div class="time">2022-01-24 10:44</div></a><div class="msg">yep. If we add a new option, that method will break. (well, depends on the defaults, but probably not ideal)</div></div></div><br/>
<div><a id="1643021097.009100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643021097.009100" ><div class="time">2022-01-24 10:44</div></a><div class="msg">back to the async issue, responsive to "this is weird, having problems with this change" vs a more planned "we are going to look at doing this, does it make sense", and getting some feedback before changes maybe?</div></div></div><br/>
<div><a id="1643021098.009300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021098.009300" ><div class="time">2022-01-24 10:44</div></a><div class="msg">Yeah that :+1: And the break will manifest as a segfault or something equally unhelpful at runtime, which isn't a great devex for maintainers</div></div></div><br/>
<div><a id="1643021262.009900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643021262.009900" ><div class="time">2022-01-24 10:47</div></a><div class="msg">:smile: it's kind of sad, the whole rust......you can't get null pointers, they all have to be handled, everything is safe, right up to the point where you have to say FFI, unsafe, oh well :smiling_face_with_tear:</div></div></div><br/>
<div><a id="1643021304.010400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643021304.010400" ><div class="time">2022-01-24 10:48</div></a><div class="msg">How would we like to collaborate on this? I think we?re going to have to accept async, because physics, but we could probably get a few face-to-face sessions (e.g. using Miro / google docs) and get a plan down. And then we can use tools like GH projects to manage things.</div></div></div><br/>
<div><a id="1643021355.010700"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643021355.010700" ><div class="time">2022-01-24 10:49</div></a><div class="msg">&gt; The feedback on the ?doesn?t lend to fluent interface? is interesting, because we?ve seen feedback that suggests it encourages....
I would absolutely agree that I don't think it leads to a fluent interface, at least not from a pact-js perspective. Critically, the "test name" part is promoted to a first class concept, whereas the ruby binaries don't seem to care about the name.</div></div></div><br/>
<div><a id="1643021389.010900"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1643021389.010900" ><div class="time">2022-01-24 10:49</div></a><div class="msg">In pact-js, we'll have to write something into the DSL that catches the test names and warns the user about repeat names</div></div></div><br/>
<div><a id="1643021432.011100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021432.011100" ><div class="time">2022-01-24 10:50</div></a><div class="msg">From my perspective, probably all I need right now is some more guidance about how the verifier handles work, unless we're planning to split those up into more fine-grained APIs soon. Even just docs on the functions would be fine for now (documenting what each arg does, which ones are exclusive, what happens if you specify 2 exclusive args, etc)</div></div></div><br/>
<div><a id="1643021522.011400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021522.011400" ><div class="time">2022-01-24 10:52</div></a><div class="msg">I'll follow the fluent API pattern in C#, and then I'll just have to store some stuff in memory and pass it all off to the FFI at the end I think, e.g. for that big options func</div></div></div><br/>
<div><a id="1643021554.011700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021554.011700" ><div class="time">2022-01-24 10:52</div></a><div class="msg">It'll be annoying if you do something weird though, because the error won't occur at the point where you expect it to</div></div></div><br/>
<div><a id="1643021701.012000"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643021701.012000" ><div class="time">2022-01-24 10:55</div></a><div class="msg">[I still like the idea of magic code based on rust introspection generating the interface]</div></div></div><br/>
<div><a id="1643021834.012200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643021834.012200" ><div class="time">2022-01-24 10:57</div></a><div class="msg">I think you'd quickly end up with non-idiomatic code if you did that though. That's how Google do all their C# client libraries and they're _rubbish_</div></div></div><br/>
<div><a id="1643022349.012400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643022349.012400" ><div class="time">2022-01-24 11:05</div></a><div class="msg">I think it depends on how you wrap it up, it looked promising on the python side at least to end up being able to generate the fluent interface, just depends on what you can do with the magic bit in the middle. Non-issue now anyway, I gave up with trying to progress it for python

I think a miro board of some sort and bit of a GH project approach would be helpful somewhere, even to just be able to get an idea of what languages need to do what, and try and make sure feedback can be covered across them, if some proposed approach would be for some reason problematic in something</div></div></div><br/>
<div><a id="1643023919.012600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643023919.012600" ><div class="time">2022-01-24 11:31</div></a><div class="msg">:thinking_face:
re @pact544?s point on usage, would it help to have integration level reference implementation test examples, so the various languages could then perform those tests to get a better idea of overall compliance and behaviour?</div></div></div><br/>
<div><a id="1643102697.014300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643102697.014300" ><div class="time">2022-01-25 09:24</div></a><div class="msg">Sorry, I have loads of questions about the FFI that I'm just not getting.

First one - What's the difference between these things? Can I use them all at the same time? Provider tags is similar from the broker snippet, is that filtering by provider tags or setting provider tags for verification results?</div></div></div><br/>
<div><a id="1643103586.014800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643103586.014800" ><div class="time">2022-01-25 09:39</div></a><div class="msg">I think filters is a method that is analogous to the `--filter-consumer` CLI option. It looks to take an array of strings
The `consumer_version_selectors`  is the newer way of specifying which contracts should come from the broker. It looks to accept an array of strings, each string being the same JSON shape that the CLI takes.

`consumer_version_tags` is the old way of specifying the pacts to select, which only uses tagcs.

I believe they can all be used simultaneously, albeit you usually would not want to use tags if you are using the other method.

@tien.xuan.vo looks like a lot of these handles were via PR #145. Are you able to shed some light on them?</div></div></div><br/>
<div><a id="1643103710.015000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643103710.015000" ><div class="time">2022-01-25 09:41</div></a><div class="msg">Apologies, today got away from me.</div></div></div><br/>
<div><a id="1643103817.015200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643103817.015200" ><div class="time">2022-01-25 09:43</div></a><div class="msg">So is provider tags also a filter?</div></div></div><br/>
<div><a id="1643103858.016100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643103858.016100" ><div class="time">2022-01-25 09:44</div></a><div class="msg">In this one, is this the name of the provider or the consumer? And I'm assuming `scheme` is a typo there, because it's parsed to `version`.  Again, is that the consumer or provider version?</div></div></div><br/>
<div><a id="1643103960.016500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643103960.016500" ><div class="time">2022-01-25 09:46</div></a><div class="msg">oh, `provider_tags` are about describing the current provider that is verifying the pacts, and is used in pending pacts calculations</div></div></div><br/>
<div><a id="1643104021.016700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104021.016700" ><div class="time">2022-01-25 09:47</div></a><div class="msg">i.e. consumer version selectars are about finding consumers that match a certain tag/branch/environment etc.
provider tags (and related option like `provider_branch` ) are about communicating details about the provider.

The pending status is calculated based on the details of the provider doing the verification</div></div></div><br/>
<div><a id="1643104026.016900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104026.016900" ><div class="time">2022-01-25 09:47</div></a><div class="msg">Oh, well then what does this do?</div></div></div><br/>
<div><a id="1643104057.017400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104057.017400" ><div class="time">2022-01-25 09:47</div></a><div class="msg">You can see my confusion right? :smile:</div></div></div><br/>
<div><a id="1643104077.017600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104077.017600" ><div class="time">2022-01-25 09:47</div></a><div class="msg">The terms all appear to be overloaded and it's often unclear which you should be using, and there's hardly any docs explainnig it</div></div></div><br/>
<div><a id="1643104311.017900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104311.017900" ><div class="time">2022-01-25 09:51</div></a><div class="msg">yes, it?s unclear to me too</div></div></div><br/>
<div><a id="1643104359.018100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104359.018100" ><div class="time">2022-01-25 09:52</div></a><div class="msg">I'll try to soldier on with the bit I can do. The internal state that's being built up is already huge though and I've not started the broker options yet :open_mouth:</div></div></div><br/>
<div><a id="1643104378.018300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104378.018300" ><div class="time">2022-01-25 09:52</div></a><div class="msg">It _looks_ like the `..with_selectors` method was the original all in one method, and then other more granular methods came along via the PR mentioned above.</div></div></div><br/>
<div><a id="1643104418.019000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104418.019000" ><div class="time">2022-01-25 09:53</div></a><div class="msg">~yes, I believe it is a typo/copy-pasta and should be version. I?d say it?s the provider name based on context~</div></div></div><br/>
<div><a id="1643104485.019300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104485.019300" ><div class="time">2022-01-25 09:54</div></a><div class="msg">oh, no!</div></div></div><br/>
<div><a id="1643104544.020000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104544.020000" ><div class="time">2022-01-25 09:55</div></a><div class="msg">That should be populated with `pact-net` and the version of the Pact .NET library. It will be used to emit anonymous usage metrics to GA (see #)</div></div></div><br/>
<div><a id="1643104651.020200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1643104651.020200" ><div class="time">2022-01-25 09:57</div></a><div class="msg">I'm working so I can't answer quickly.

Yes, I created MR to add those missing ffi functions, but I'm same with you, still learning pact by create some simple merge requests, so I don't understand much.

Here are something that I understand:
? `set_consumer_filters` filter pacts by consumer. I have an example here in PHP if you interested in <a href="https://github.com/pact-foundation/pact-reference/blob/master/php/src/provider.php#L41">https://github.com/pact-foundation/pact-reference/blob/master/php/src/provider.php#L41</a>
? `consumer_version_selectors` All I know it's a new way to filter pacts by consumer. There is a doc for it here <a href="https://docs.pact.io/pact_broker/advanced_topics/consumer_version_selectors/">https://docs.pact.io/pact_broker/advanced_topics/consumer_version_selectors/</a>. I didn't use it yet.
? `consumer_version_tags` I don't know this, but Matt just said above it's just an old way to filter pacts
? `provider_tags` Also I don't know this one. This comment is from `Rust` code: `Tags to use when publishing results` </div></div></div><br/>
<div><a id="1643104685.020600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104685.020600" ><div class="time">2022-01-25 09:58</div></a><div class="msg">Oh! OK that wasn't clear at all. Cheers for that</div></div></div><br/>
<div><a id="1643104713.020800"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643104713.020800" ><div class="time">2022-01-25 09:58</div></a><div class="msg">We need to be able to disable those usage metrics as well then don't we? I don't see an option for that on the FFI</div></div></div><br/>
<div><a id="1643104902.021000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104902.021000" ><div class="time">2022-01-25 10:01</div></a><div class="msg">It can be disabled via an environment variable (it will actually print it out to users)</div></div></div><br/>
<div><a id="1643104943.021200"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1643104943.021200" ><div class="time">2022-01-25 10:02</div></a><div class="msg">I don't know this one. It's new to me too. And I think you are right about typo. I think you can create merge request to fix it</div></div></div><br/>
<div><a id="1643104978.021400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643104978.021400" ><div class="time">2022-01-25 10:02</div></a><div class="msg">```pact_do_not_track=true```</div></div></div><br/>
<div><a id="1643105008.021600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643105008.021600" ><div class="time">2022-01-25 10:03</div></a><div class="msg">This makes it consistent across other languages (we currently support that in pact-node to track downloads)</div></div></div><br/>
<div><a id="1643105038.021800"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1643105038.021800" ><div class="time">2022-01-25 10:03</div></a><div class="msg">I can confirm it's printed out. But I didn't try to disable it yet.</div></div></div><br/>
<div><a id="1643105039.022000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643105039.022000" ><div class="time">2022-01-25 10:03</div></a><div class="msg">We really appreciate your enthusiasm and help so far Tien!</div></div></div><br/>
<div><a id="1643105745.022300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643105745.022300" ><div class="time">2022-01-25 10:15</div></a><div class="msg">Gotcha</div></div></div><br/>
<div><a id="1643111925.026300"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643111925.026300" ><div class="time">2022-01-25 11:58</div></a><div class="msg">I just don't think this API makes sense. It forces you to specify the `provider_name` again, but you already had to supply that in the `set_provider_info` call (and in the PactNet code, you no longer have access to it because of the typestate pattern).

It doesn't force you to set `provider_version` even though that's required for publishing results, and then `provider_version` is on a different func `set_verification_options` which you can call even if you aren't using a pact broker source, which would make no sense. If it's not intended to specify publishing options on this func, it's unclear why `provider_branch` and `provider_tags` are on there as those are publishing options.

I'm having to try to tie my API code in knots to conform to that API whilst still making it usable and safe, which probably means other library maintainers will also.

Is this the final API we're sticking with and we just need to get used to dealing with its quirks or are we planning on changing it to express its invariants properly?</div></div></div><br/>
<div><a id="1643112199.026700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643112199.026700" ><div class="time">2022-01-25 12:03</div></a><div class="msg">And then this func doesn't make sense either. Some of those are applicable even if you aren't publishing results (like SSL verification and request timeout), but others only make sense if you are publishing results, like provider version and tags</div></div></div><br/>
<div><a id="1643112260.027100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643112260.027100" ><div class="time">2022-01-25 12:04</div></a><div class="msg">In fact, the SSL and timeout options are applicable regardless of which source you're using, whereas the others only make sense if you're using a broker source</div></div></div><br/>
<div><a id="1643112577.027300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643112577.027300" ><div class="time">2022-01-25 12:09</div></a><div class="msg">&gt;  Is this the final API we?re sticking with and we just need to get used to dealing with its quirks or are we planning on changing it to express its invariants properly?(edited)
with this feedback, I can?t see us not wanting to change it, unless there is something I?m missing. Tien wrote it for Pact PHP, so may have some maintainer implementation advice</div></div></div><br/>
<div><a id="1643113411.027500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643113411.027500" ><div class="time">2022-01-25 12:23</div></a><div class="msg">The only way I can see it working is if you keep one huuuge state object and then try to build it up as you go, then try to do all the FFI calls at the end. That's very error prone though, e.g. you could set both a file source and a URL source.

At first count I was up to 26 parameters on the state object doing it that way, which just felt totally wrong</div></div></div><br/>
<div><a id="1643113468.027700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643113468.027700" ><div class="time">2022-01-25 12:24</div></a><div class="msg">I've had to make a breaking change to PactNet to support this atm, and I can definitely see some more coming. e.g. request timeout and SSL verification could really do with being split from the publish options</div></div></div><br/>
<div><a id="1643114530.027900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643114530.027900" ><div class="time">2022-01-25 12:42</div></a><div class="msg">Arghghgh all that and the logs still don't work</div></div></div><br/>
<div><a id="1643117567.028100"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643117567.028100" ><div class="time">2022-01-25 13:32</div></a><div class="msg">:worried: I did start trying to look at the logging, I wanted to get a bit of a baseline with some examples to compete between what happens currently Vs with ffi for the various languages, and what would be a good solution for all, e.g. logfiles Vs stderr, I think there are some differences between languages making that more complicated than one size fits all</div></div></div><br/>
<div><a id="1643117692.028300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643117692.028300" ><div class="time">2022-01-25 13:34</div></a><div class="msg">Do you have any good (shareable) examples to figure out what's there now/used to be there/would like to be there?</div></div></div><br/>
<div><a id="1643118470.028500"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643118470.028500" ><div class="time">2022-01-25 13:47</div></a><div class="msg">I think I'm gonna try setting the log sink to write to file at the moment just to help me debug, but that's not really a good long-term solution because people do things like run tests in a Docker container with a read-only filesystem</div></div></div><br/>
<div><a id="1643120623.028700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643120623.028700" ><div class="time">2022-01-25 14:23</div></a><div class="msg">OK, so I do get logs via the buffer, but only at TRACE level. There are no logs at DEBUG or higher... And there are no verification errors or anything like that either :disappointed:</div></div></div><br/>
<div><a id="1643120853.028900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643120853.028900" ><div class="time">2022-01-25 14:27</div></a><div class="msg">Ah, all the calls inside the `pact_verifier` crate are just `println!` instead of `info!` or whatever, so they never end up going to the log buffer. They're just going to stdout, which is no good</div></div></div><br/>
<div><a id="1643121062.029100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643121062.029100" ><div class="time">2022-01-25 14:31</div></a><div class="msg">And lots of the messages have ANSI colour code stuff in them, so it's not an easy find and replace of `println!` with info/log/etc either :disappointed: Well, still no logs for PactNet then!</div></div></div><br/>
<div><a id="1643123160.030400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643123160.030400" ><div class="time">2022-01-25 15:06</div></a><div class="msg">When the Rust lib triggers the provider state endpoint, how come it's not providing a `Content-Length` or `Transfer-Encoding` header? .Net will reject all requests that don't do that, which is why my CI is currently failing</div></div></div><br/>
<div><a id="1643123460.030700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643123460.030700" ><div class="time">2022-01-25 15:11</div></a><div class="msg">Here's the relevant CI logs, but it's getting back a HTTP 411 Length Required
<a href="https://github.com/pact-foundation/pact-net/runs/4938617118?check_suite_focus=true#step:8:814">https://github.com/pact-foundation/pact-net/runs/4938617118?check_suite_focus=true#step:8:814</a></div></div></div><br/>
<div><a id="1643124223.031900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643124223.031900" ><div class="time">2022-01-25 15:23</div></a><div class="msg">I've published a draft PR for moving to the new verifier handles approach here: <a href="https://github.com/pact-foundation/pact-net/pull/353">https://github.com/pact-foundation/pact-net/pull/353</a>

All the tests pass, but there's still a number of things that aren't supported, and some changes that I think need making to the FFI (unfortunately, breaking ones). I've documented some of them on the PR description.</div></div></div><br/>
<div><a id="1643124434.032100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643124434.032100" ><div class="time">2022-01-25 15:27</div></a><div class="msg">I think one absolutely huge thing we need is a simple way to get back the nice friendly messages about the interactions that are running, their status and the overall mismatches summary you get at the end.

At the moment there are two big problems with it:

1. They only go to stdout, and include ANSI colour code chars and stuff
2. They interleave with all the other log messages, so it's really hard to actually follow them
Ideally the output would start with a section summarising what happened and what errors there were, and then the detailed logs of what it did would follow instead of interleave with them.

That would make the DevEx really nice for when things go wrong, but also provide sufficient information to debug if it's not immediately obvious why you have errors (although in my experience it's almost always obvious once you see the mismatches)</div></div></div><br/>
<div><a id="1643124638.032400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643124638.032400" ><div class="time">2022-01-25 15:30</div></a><div class="msg">i.e. I want what the CLI produces to come out first, and then the actual log messages (with the log level, file source etc) to come out separately instead of interleave</div></div></div><br/>
<div><a id="1643133500.032600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643133500.032600" ><div class="time">2022-01-25 17:58</div></a><div class="msg">I was looking at structured logging to see if that could be a way to work well with different clients, then you can have more control over different types of logs and filter in ways other than just the level, but didn't get very far</div></div></div><br/>
<div><a id="1643133575.032800"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643133575.032800" ><div class="time">2022-01-25 17:59</div></a><div class="msg">The different levels was something Tim was keen to look at as mentioned ^</div></div></div><br/>
<div><a id="1643135293.033000"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643135293.033000" ><div class="time">2022-01-25 18:28</div></a><div class="msg">I like the idea of the formatting being exactly the same. The output from the CLI is a decent layout and the colours are good, and I wouldn't want different libraries to do it different ways.

If that output was available via the FFI (hopefully with detecting whether the terminal supports colours or not) and not interleaved with the actual logging, that would be my ideal</div></div></div><br/>
<div><a id="1643135374.033200"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643135374.033200" ><div class="time">2022-01-25 18:29</div></a><div class="msg">Agreed about consistency</div></div></div><br/>
<div><a id="1643135492.033400"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643135492.033400" ><div class="time">2022-01-25 18:31</div></a><div class="msg">Thinking how you handle the different needs of stdout vs file
The other use case Tim was talking about was there's trace level for a Pact user but potentially Trace for a maintainer might want visibility of more under the hood internals, which you might want to see separately/differently etc</div></div></div><br/>
<div><a id="1643135578.033600"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643135578.033600" ><div class="time">2022-01-25 18:32</div></a><div class="msg">I was thinking it could work if everything is a log, then client side you have control over yes print with normal log timestamps/prefix or not</div></div></div><br/>
<div><a id="1643151546.033800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643151546.033800" ><div class="time">2022-01-25 22:59</div></a><div class="msg">hmm, strange. I can?t see why the http library used for that wouldn?t set those headers</div></div></div><br/>
<div><a id="1643151799.034000"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643151799.034000" ><div class="time">2022-01-25 23:03</div></a><div class="msg">I wonder if because we use a builder to construct the state change request and specify the headers, that it won?t automatically add the others: <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_verifier/src/provider_client.rs#L84-L97">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_verifier/src/provider_client.rs#L84-L97</a></div></div></div><br/>
<div><a id="1643151802.034300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643151802.034300" ><div class="time">2022-01-25 23:03</div></a><div class="msg">@uglyog any ideas?</div></div></div><br/>
<div><a id="1643167575.034600"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643167575.034600" ><div class="time">2022-01-26 03:26</div></a><div class="msg">Right, so yes, `println!` is never going to solve the problem you have. I think I saw a discussion elsewhere about getting a response from the verification process that contains fine grained  assertion information (as is the case with the current Ruby version, with `--format json` enabled). This would be nice, especially if we could also add a standard output message to print that formats it the same across libraries. This would be separate to the logging output, which would then also solve log problem. What do you think about that?

I think it would just be a matter of collecting all of the `println!` into a separate buffer, and in CLI mode just printing it out, and library mode returning the buffer (perhaps in a structured format, to allow for fine grained test output in due course)?</div></div></div><br/>
<div><a id="1643167618.034800"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643167618.034800" ><div class="time">2022-01-26 03:26</div></a><div class="msg">FYI it?s a public holiday here in Australia, so hence the relative quiet yesterday, today and possibly tomorrow</div></div></div><br/>
<div><a id="1643184013.035100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643184013.035100" ><div class="time">2022-01-26 08:00</div></a><div class="msg">Yeah I think we need to really think about those 2 use cases. Users of the end client library (pact-net, pact-js, etc) first want a summary of the actual interactions and whether they passed or failed. Almost always, this is enough to know exactly what you need to do to fix it (e.g. the failure will say the response had a certain field, whereas the interaction expected another). I think this should be consistent across languages, and effort put in to make it really readable (I think the existing format isn't bad in that regard).

They _may_ want some more fine-grained detail about what the library actually did, but probably not. As long as they know which URL was called and what the mismatch is, I think that's pretty much all you need.

The other use case is for the library maintainers themselves, and probably really only the core/FFI maintainers. This will be for times when the interaction is passing/failing but it shouldn't be, and so the end-user can't fix it. This would indicate a bug in core/FFI and that's when we'd need the more detailed logs. From typing that, I think I've convinced myself that those logs shouldn't be 'on by default', and instead it's the type of thing where we'd request further info in a bug report (like "please enable this flag and then send the output").

I also think the end-user logs shouldn't have things like timestamps, file sources, log levels etc. etc. on them. The output of that needs to be really clean and readable, and all of those things are just noise that the end-user doesn't really care about.</div></div></div><br/>
<div><a id="1643187020.035400"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643187020.035400" ><div class="time">2022-01-26 08:50</div></a><div class="msg">Tried this out locally in PactNet and it works really nicely :+1:</div></div></div><br/>
<div><a id="1643187083.035600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643187083.035600" ><div class="time">2022-01-26 08:51</div></a><div class="msg">It appears to only happen when you use the provider states in the query string instead of the body. It's still a `POST` but that should have an accompanying `Content-Length: 0` header</div></div></div><br/>
<div><a id="1643187143.035800"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643187143.035800" ><div class="time">2022-01-26 08:52</div></a><div class="msg">Turns out it's the name and version of the library itself (not provider or consumer). I've fixed it in <a href="https://github.com/pact-foundation/pact-reference/pull/173">https://github.com/pact-foundation/pact-reference/pull/173</a></div></div></div><br/>
<div><a id="1643194600.036100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194600.036100" ><div class="time">2022-01-26 10:56</div></a><div class="msg">ah, interesting!</div></div></div><br/>
<div><a id="1643194616.036300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194616.036300" ><div class="time">2022-01-26 10:56</div></a><div class="msg">could be a bug in reqwest</div></div></div><br/>
<div><a id="1643194634.036500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194634.036500" ><div class="time">2022-01-26 10:57</div></a><div class="msg">Speaking of: <a href="https://github.com/seanmonstar/reqwest/pull/1316#issuecomment-1020499420">https://github.com/seanmonstar/reqwest/pull/1316#issuecomment-1020499420</a></div></div></div><br/>
<div><a id="1643194667.036900"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194667.036900" ><div class="time">2022-01-26 10:57</div></a><div class="msg">Came back to a full inbox, mostly of which is Adam/Pact .NET today - did you fix that issue in the Rust PR?</div></div></div><br/>
<div><a id="1643194789.037200"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643194789.037200" ><div class="time">2022-01-26 10:59</div></a><div class="msg">Yeah I've raised a couple of FFI PRs and done the PactNet mods locally to use them. They're a nice ergonomic improvement there :+1:</div></div></div><br/>
<div><a id="1643194832.037400"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194832.037400" ><div class="time">2022-01-26 11:00</div></a><div class="msg">I think I?m in agreement with that. Tim had a point that if we buffer logs in the FFI directly and it panics, then we are cooked for debug data, but I think the general UX where all data is buffered and the client can choose how/when to print makes the most sense</div></div></div><br/>
<div><a id="1643194904.037700"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194904.037700" ><div class="time">2022-01-26 11:01</div></a><div class="msg">oh, that?s awesome. Thank you</div></div></div><br/>
<div><a id="1643194917.037900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643194917.037900" ><div class="time">2022-01-26 11:01</div></a><div class="msg">I was going to share the starting point sheet I looked at but I just checked and it's not very helpful for explanation anyway :joy:
What I was thinking was to try and do a crude side by side across the different languages of how log output typically looks, and "end users want to see a normally, end users want to see b with debug, maintainers want to see c normally, maintainers way to see d with debug", vs what currently happens</div></div></div><br/>
<div><a id="1643194932.038100"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194932.038100" ><div class="time">2022-01-26 11:02</div></a><div class="msg">There?s a lot happening in Pactflow town at the moment, hopefully Ron can take a look in the next couple of days. Will the change require changes for @tien.xuan.vo ?</div></div></div><br/>
<div><a id="1643194948.038300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194948.038300" ><div class="time">2022-01-26 11:02</div></a><div class="msg">yep, that makes sense</div></div></div><br/>
<div><a id="1643194983.038500"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643194983.038500" ><div class="time">2022-01-26 11:03</div></a><div class="msg">we want each language to be as idiomatic as possible. .NET is definitely a blind spot for a few core maintainers, so having Adam/Yann advocate and be part is very helpful</div></div></div><br/>
<div><a id="1643195005.038700"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643195005.038700" ><div class="time">2022-01-26 11:03</div></a><div class="msg">as always happens I think when I started to look, first there were problems with me trying JS (which Tim nicely fixed but I'd run out of time) followed by as I was looking at logs I noticed a FFI bug of sending the provider state destroy when it shouldn't be so I did that instead :joy:  tangents!</div></div></div><br/>
<div><a id="1643195059.038900"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643195059.038900" ><div class="time">2022-01-26 11:04</div></a><div class="msg">yep. the maintainers wanting to see x going into a log file rather than a buffer because panic is a good one</div></div></div><br/>
<div><a id="1643195117.039100"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643195117.039100" ><div class="time">2022-01-26 11:05</div></a><div class="msg">I think so yes, it's a breaking change in the FFI. We may want some more in future, but those are 2 obvious ones which are blockers for PactNet</div></div></div><br/>
<div><a id="1643195279.039300"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1643195279.039300" ><div class="time">2022-01-26 11:07</div></a><div class="msg">[one day I will try and get past just talking about things and actually get onto doing them]</div></div></div><br/>
<div><a id="1643245604.041700"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643245604.041700" ><div class="time">2022-01-27 01:06</div></a><div class="msg">With reqwest we might need to set an empty body. I'll have a look into that.</div></div></div><br/>
<div><a id="1643252601.043400"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643252601.043400" ><div class="time">2022-01-27 03:03</div></a><div class="msg">@pact544 I've merged the PRs. I'm going to look at extracting the verification output (this will be separate from the logging), but I will leave the printing it out to stdout because it works nicely in other languages.</div></div></div><br/>
<div><a id="1643252627.044000"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643252627.044000" ><div class="time">2022-01-27 03:03</div></a><div class="msg">I will also bump the minor version (to 0.2.0) due to the breaking changes</div></div></div><br/>
<div><a id="1643252736.044300"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643252736.044300" ><div class="time">2022-01-27 03:05</div></a><div class="msg">If it helps, I?m happy to have the stdout logs buffered for Pact JS/Go and control the output programmatically (but separately) to the other logs.

But yes, printing to stdout is not currently causing issues for them.</div></div></div><br/>
<div><a id="1643268791.044600"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643268791.044600" ><div class="time">2022-01-27 07:33</div></a><div class="msg">Yeah if it prints to stdout also then I think that's gonna cause problems in places like GitHub Actions. That does seem to capture stdout (whereas running locally doesn't) so if it still printed to stdout you'd get all the output twice :open_mouth:</div></div></div><br/>
<div><a id="1643268942.045000"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643268942.045000" ><div class="time">2022-01-27 07:35</div></a><div class="msg">It'd be cool if it could auto-detect whether the terminal was capable of colours or nt as well, and still include the ANSI codes because that's def useful. Or if it can't detect, perhaps provide a flag to force colour on or off so that user's can set it appropriately</div></div></div><br/>
<div><a id="1643280168.047700"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643280168.047700" ><div class="time">2022-01-27 10:42</div></a><div class="msg">The new verifier handles feature behaves differently on different OSs:
<a href="https://github.com/pact-foundation/pact-net/runs/4964627047?check_suite_focus=true">https://github.com/pact-foundation/pact-net/runs/4964627047?check_suite_focus=true</a>

I've written an integration test just to make sure the external bindings work, but it never starts an actual provider API so obviously it should fail (and the test checks that the verification fails). On Windows and Linux that's exactly what it does, but on OSX the verifier tests pass :open_mouth: They can't possibly pass though, because there's no provider running and I've pointed at pact sources that don't even exist (like `<a href="http://broker.example.org">http://broker.example.org</a>`).

The test also takes 58s to run even though I've set a request timeout of 100ms</div></div></div><br/>
<div><a id="1643282339.047900"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643282339.047900" ><div class="time">2022-01-27 11:18</div></a><div class="msg">Raised as <a href="https://github.com/pact-foundation/pact-reference/issues/176">https://github.com/pact-foundation/pact-reference/issues/176</a></div></div></div><br/>
<div><a id="1643330600.459549"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643330600.459549" ><div class="time">2022-01-28 00:43</div></a><div class="msg">FYI - looks like soon the certificate problem with tls-native will be solved in reqwest: <a href="https://github.com/seanmonstar/reqwest/pull/1316">https://github.com/seanmonstar/reqwest/pull/1316</a></div></div></div><br/>
<div><a id="1643356599.667179"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643356599.667179" ><div class="time">2022-01-28 07:56</div></a><div class="msg">Good news :+1: Currently I can't run a single provider test on my machine :D</div></div></div><br/>
<div><a id="1643369708.149979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643369708.149979" ><div class="time">2022-01-28 11:35</div></a><div class="msg">time to get rid of those 10 year old self-signed certs Adam :laughing:</div></div></div><br/>
<div><a id="1643374935.764209"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643374935.764209" ><div class="time">2022-01-28 13:02</div></a><div class="msg">Just whatever AD is pushing onto my machine I guess :shrug: Or whatever <a href="http://ASP.Net">http://ASP.Net</a> dev certs get generated</div></div></div><br/>
<div><a id="1643678619.240139"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643678619.240139" ><div class="time">2022-02-01 01:23</div></a><div class="msg">I've created a JSON schema to describe the verification results JSON :point_right:  <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_verifier/src/verifier-results.schema.json">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_verifier/src/verifier-results.schema.json</a></div></div></div><br/>
<div><a id="1643701521.619379"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643701521.619379" ><div class="time">2022-02-01 07:45</div></a><div class="msg">You might want to put a `v1` in there or something just in case it changes in future</div></div></div><br/>
<div><a id="1643790185.479559"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643790185.479559" ><div class="time">2022-02-02 08:23</div></a><div class="msg">I've tried using the new `pactffi_verifier_output` method and unfortunately ~I just get an empty string from it~ the output is all screwed up by the ANSI colour codes :disappointed: I could only get it to work by running inside a Linux container because of the blocker thing about invalid certs on my machine, but the output just looks like this:</div></div></div><br/>
<div><a id="1643795723.965789"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643795723.965789" ><div class="time">2022-02-02 09:55</div></a><div class="msg">Another problem with that output is that it never shows you the actual response body. For example, consider this output.

That doesn't help me in finding out where the problem is because I can't see the actual response body. I tried looking in the logs also and it's not printed there either, it just says "Present"

``` [INFO][pact_verifier::provider_client] Received response: HTTP Response ( status: 200, headers: Some({"date": ["Wed", "02 Feb 2022 08:49:28 GMT"], "server": ["Kestrel"], "transfer-encoding": ["chunked"], "content-type": ["application/json; charset=utf-8"]}), body: Present(356 bytes, application/json;charset=utf-8) )```
The Ruby version outputs the entire message when any interactions fails so you can spot what went wrong.</div></div></div><br/>
<div><a id="1643799060.891389"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643799060.891389" ><div class="time">2022-02-02 10:51</div></a><div class="msg">I've got this working locally by using the default native TLS support in reqwset. Is there any reason we're using rustls instead? This seems to work much better:</div></div></div><br/>
<div><a id="1643799757.957969"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643799757.957969" ><div class="time">2022-02-02 11:02</div></a><div class="msg">Unless something has changed, last I checked, the default wasn?t clever enough to discover your self-signed certificates. We moved so that it would respect the standard openssl env vars (`SSL_CERT_FILE` etc.)</div></div></div><br/>
<div><a id="1643799778.648739"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643799778.648739" ><div class="time">2022-02-02 11:02</div></a><div class="msg">yeah: <a href="https://github.com/pact-foundation/pact-reference/issues/144">https://github.com/pact-foundation/pact-reference/issues/144</a></div></div></div><br/>
<div><a id="1643799977.085179"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643799977.085179" ><div class="time">2022-02-02 11:06</div></a><div class="msg">we definitely do want that. I wonder if it?s hidden away in a DEBUG/TRACE level log? It could be made to be printable, I?m sure</div></div></div><br/>
<div><a id="1643808859.360859"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643808859.360859" ><div class="time">2022-02-02 13:34</div></a><div class="msg">I just can't fix this ANSI code thing. I knew that was gonna be a problem. If you feed strings with ANSI codes in them through xUnit then they don't apply when they end up on the actual test output.

If I write directly to the console they do (after some kernel calls to enable VT mode on the terminal :open_mouth:), but not via xUnit. At the moment I've literally had to just strip them out with a regex</div></div></div><br/>
<div><a id="1643839133.860429"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643839133.860429" ><div class="time">2022-02-02 21:58</div></a><div class="msg">I'll add an option to disable the ANSI control codes</div></div></div><br/>
<div><a id="1643846104.756039"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643846104.756039" ><div class="time">2022-02-02 23:55</div></a><div class="msg">Are you still having issues getting the logs? The request/response details won't be in the console output. I can clean those up, but it won't help if you can't get the logs.</div></div></div><br/>
<div><a id="1643846583.511699"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643846583.511699" ><div class="time">2022-02-03 00:03</div></a><div class="msg">Hmm, good point.</div></div></div><br/>
<div><a id="1643853825.303529"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643853825.303529" ><div class="time">2022-02-03 02:03</div></a><div class="msg">Bodies were being logged at trace level. I will change that to debug level.</div></div></div><br/>
<div><a id="1643858251.136529"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643858251.136529" ><div class="time">2022-02-03 03:17</div></a><div class="msg">I've released 0.2.1 with the following changes:
? req/res bodies are logged at debug level
? `enable_ansi_support` has moved out of `pactffi_init` into a new function `pactffi_enable_ansi_support`
? `pactffi_verifier_output` now has a second parameter `strip_ansi`. If non-zero, the ANSI control codes will be stripped.</div></div></div><br/>
<div><a id="1643860166.303959"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1643860166.303959" ><div class="time">2022-02-03 03:49</div></a><div class="msg">what?s the use case for having `pactffi_enable_ansi_support` and the ability to strip them off in the verifier output?</div></div></div><br/>
<div><a id="1643860306.056169"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643860306.056169" ><div class="time">2022-02-03 03:51</div></a><div class="msg">Trying to cover all the bases. I'm assuming if `pactffi_enable_ansi_support` is not called, there won't be ANSI codes in the output, but in case there are still, then ....</div></div></div><br/>
<div><a id="1643874657.320729"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1643874657.320729" ><div class="time">2022-02-03 07:50</div></a><div class="msg">So ANSI support is disabled by default and you need to explicitly enable it?</div></div></div><br/>
<div><a id="1643921209.379909"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1643921209.379909" ><div class="time">2022-02-03 20:46</div></a><div class="msg">On Windows, yes</div></div></div><br/>
<div><a id="1645092098.926769"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1645092098.926769" ><div class="time">2022-02-17 10:01</div></a><div class="msg">Question about message pacts - at the moment PactNet writes the pact file (in merge mode) after verifying each interaction, but that seems wasteful.

I can't remember why it's done that way though - is it necessary/recommended via the FFI or should the pact file just be written once?

I know for request pacts it's necessary because the mock server can only be configured once per verification, but I can't think of a reason why message pacts have that restriction</div></div></div><br/>
<div><a id="1645092334.515689"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1645092334.515689" ><div class="time">2022-02-17 10:05</div></a><div class="msg">I can?t remember myself</div></div></div><br/>
<div><a id="1645092467.737359"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1645092467.737359" ><div class="time">2022-02-17 10:07</div></a><div class="msg">Yeah I feel like I can make one message pact handle, but lots of message handles, and then just write the pact file once at the end.

I suppose it's a bit theoretical though. Even if you write the file 100 times in merge mode it's not exactly gonna destroy performance, it just irks that it's inefficient :joy:</div></div></div><br/>
<div><a id="1645092504.242029"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1645092504.242029" ><div class="time">2022-02-17 10:08</div></a><div class="msg">haha yes. It?s plausible to do it that way, I?d need to look at the interface again</div></div></div><br/>
<div><a id="1645092517.168909"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1645092517.168909" ><div class="time">2022-02-17 10:08</div></a><div class="msg">Maybe we did it because it was easier to port existing implementations over?</div></div></div><br/>
<div><a id="1645104651.822579"><img src="https://avatars.slack-edge.com/2018-06-18/383099788962_f8a3efa7488b02d0dfb8_72.png" /></a><div class="message"><div class="username">tjones</div><a style="text-decoration: none" href="#1645104651.822579" ><div class="time">2022-02-17 13:30</div></a><div class="msg">@tjones has left the channel</div></div></div><br/>
<div><a id="1645142516.528729"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1645142516.528729" ><div class="time">2022-02-18 00:01</div></a><div class="msg">With Pact-JVM, some people create a separate test for each interaction. I've seen one with 12 interactions, each a separate test. In that case, it has to merge otherwise they will overwrite each other</div></div></div><br/>
<div><a id="1645199518.872089"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1645199518.872089" ><div class="time">2022-02-18 15:51</div></a><div class="msg">Yeah, we do a separate test for each interaction also. The question was more about whether you need to write the pact after each interaction or not, i.e. do I need to do this:

? Create pact handle
? Create message handle
? Verify
? Write pact file
? GOTO 1
or this:
? Create pact handle
? Create message handle
? Verify
? Create message handle
? Verify
? Create message handle
? Verify
? Write pact file</div></div></div><br/>
<div><a id="1645360069.628579"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1645360069.628579" ><div class="time">2022-02-20 12:27</div></a><div class="msg">Question on the new `pactffi_verifier_*` functions - the `VerifierHandle` appears to be a struct, unlike the other consumer handles which are essentially opaque numbers. Was there a reason this was not done in a similar way?</div></div></div><br/>
<div><a id="1646029398.964379"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1646029398.964379" ><div class="time">2022-02-28 06:23</div></a><div class="msg">Do I need to create an issue for this?</div></div></div><br/>
<div><a id="1646029468.097929"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1646029468.097929" ><div class="time">2022-02-28 06:24</div></a><div class="msg">Yes, otherwise it will be forgotten</div></div></div><br/>
<div><a id="1646029964.904229"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1646029964.904229" ><div class="time">2022-02-28 06:32</div></a><div class="msg">Here is the issue <a href="https://github.com/pact-foundation/pact-plugins/issues/2">https://github.com/pact-foundation/pact-plugins/issues/2</a></div></div></div><br/>
<div><a id="1646812690.612989"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1646812690.612989" ><div class="time">2022-03-09 07:58</div></a><div class="msg">Looking at adding message pact into the v3 branch of Pact JS. I can see a number of methods that deal with `MessagePactHandle` e.g. (`pactffi_new_message_pact`) and others that use `PactHandle` and `MessageHandle`  (e.g. `pactffi_new_async_message`) I?m assuming the latter are to do with v4 pacts where they can be attached, and the former v3?</div></div></div><br/>
<div><a id="1646814091.561189"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1646814091.561189" ><div class="time">2022-03-09 08:21</div></a><div class="msg">Hopefully the PactNet implementation could shed some light on that? MessagePactHandle definitely represents the entire pact, whereas MessageHandle is just an individual interaction, but yeah I don't get why PactHandle has got involved there. Perhaps it's a typo but it just work anyway, given they're essentially the same two objects and they're just integer IDs basically</div></div></div><br/>
<div><a id="1646814684.248349"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1646814684.248349" ><div class="time">2022-03-09 08:31</div></a><div class="msg">Thanks, I should check the underlying implementation but looking at the C headers it's hard to see which ones to use and why</div></div></div><br/>
<div><a id="1646860760.491259"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1646860760.491259" ><div class="time">2022-03-09 21:19</div></a><div class="msg">The original PR introduced the V3 message Pact, so that might be causing the confusion. `PactHandle` represents the Pact file (whether V3 or V4). `MessagePactHandle` is a V3 message Pact. `MessageHandle` is an interaction.</div></div></div><br/>
<div><a id="1646867319.411039"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1646867319.411039" ><div class="time">2022-03-09 23:08</div></a><div class="msg">Cool thx. So I should use the new ones then on the Pacthandle?</div></div></div><br/>
<div><a id="1646867389.690899"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1646867389.690899" ><div class="time">2022-03-09 23:09</div></a><div class="msg">Yes</div></div></div><br/>
<div><a id="1647227174.106889"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647227174.106889" ><div class="time">2022-03-14 03:06</div></a><div class="msg">I?m still a little confused.

I can see that the async methods still return a `MessageHandle` (so the related message functions are still available) but the `pactffi_new_sync_message_interaction` returns an `InteractionHandle` which seems strange to me because the methods that operate on that are HTTP centric. I can?t see how you would set the request/response components of that?</div></div></div><br/>
<div><a id="1647227296.373219"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647227296.373219" ><div class="time">2022-03-14 03:08</div></a><div class="msg">Ditto `pactffi_new_message_interaction` .</div></div></div><br/>
<div><a id="1647744819.844729"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647744819.844729" ><div class="time">2022-03-20 02:53</div></a><div class="msg">:thread: Thread on plugins :point_down:</div></div></div><br/>
<div><a id="1647744870.922709"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647744870.922709" ><div class="time">2022-03-20 02:54</div></a><div class="msg">First go (spiking Golang) - it works with standard HTTP request/response :tada:</div></div></div><br/>
<div><a id="1647745108.157739"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647745108.157739" ><div class="time">2022-03-20 02:58</div></a><div class="msg">I was thinking how the gRPC plugin would work with the current protobufs one.

I?m assuming that `pactffi_interaction_contents` is the interface for a content type plugin, and we?d add a new ffi interface for a transport plugin? i.e. you would want to use these things together, but I can?t see how this interface would support something like gRPC.

If that?s the case, then the current PactHandle methods aren?t going to look very sensible.

```	i.UponReceiving("some interaction").
		Given("plugin state").
		WithRequest("GET", "/protobuf").
		WithStatus(200).
		WithPluginInteractionContents(INTERACTION_PART_RESPONSE, "application/protobuf", protobufInteraction)```
That?s the example Golang plugin test I ran before which worked :ok_hand:

But assuming that gRPC would have a separate interface, e.g. `pactffi_plugin_transport` or something?

```	i.UponReceiving("some grpc interaction").
		Given("plugin state").
		WithPluginTransport("grpc", &lt;some json configuration object?&gt;)
		WithPluginInteractionContents(INTERACTION_PART_RESPONSE, "application/protobuf", protobufInteraction)```</div></div></div><br/>
<div><a id="1647758430.100389"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647758430.100389" ><div class="time">2022-03-20 06:40</div></a><div class="msg">How do you add metadata to the new message interface on the `PactHandle` that return `InteractionHandle` ?

i.e. I?m looking for the replacement for  `pactffi_message_with_metadata` on `MessageHandle`</div></div></div><br/>
<div><a id="1647812951.571199"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1647812951.571199" ><div class="time">2022-03-20 21:49</div></a><div class="msg">The Java ans Rust ones work by configuring the interaction as current, then start a mock server from that. The mock server updates the interaction to use a gRPC transport.</div></div></div><br/>
<div><a id="1647813487.016819"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647813487.016819" ><div class="time">2022-03-20 21:58</div></a><div class="msg">So how would I signal to the mock server that it should be a gRPC one, I guess. Is there going to be a new FFI method or is simply adding the plugin enough for the mock server to convert to a gRPC transport?</div></div></div><br/>
<div><a id="1647814277.342049"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1647814277.342049" ><div class="time">2022-03-20 22:11</div></a><div class="msg">I haven't got to the FFI interface yet</div></div></div><br/>
<div><a id="1647819013.636969"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1647819013.636969" ><div class="time">2022-03-20 23:30</div></a><div class="msg">One of the primary reasons I?m asking is because I?m trying to figure out what the next iteration of the DSL looks like to JS/Golang. I?ve got some feedback on a builder/type-state DSL, but I think the plugin interface is going to significantly impact that design. Ideally I just do it once.

In JS, we added a very JSON-like interface:

```{
      state: 'i have a list of projects',
      uponReceiving: 'a request for projects',
      withRequest: {
        method: HTTPMethods.GET,
        path: '/projects',
        headers: { Accept: 'application/json' },
      },
      willRespondWith: {
        status: 200,
        headers: { 'Content-Type': 'application/json' },
        body: {},
      },
    };```
This makes it super easy to convert other JSON structures to a Pact interaction.

But you can see how the validation on this sort of structure would get super messy with plugins (and indeed, some of the features in v3). I?ll probably preserve it for HTTP pact, but I?d like a more type safe API going forward if possible. e.g. you shouldn?t be able to add an HTTP header to a message pact. Or, if using a different transport, you shouldn?t be configuring other things on the HTTP mock server</div></div></div><br/>
<div><a id="1647819014.473919"><img src="" /></a><div class="message"><div class="username"></div><a style="text-decoration: none" href="#1647819014.473919" ><div class="time">2022-03-20 23:30</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-plugins">https://github.com/pact-foundation/pact-plugins</a></div></div></div><br/>
<div><a id="1650309130.409529"><img src="https://secure.gravatar.com/avatar/e56972270335da29ddd62580416412c4.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png" /></a><div class="message"><div class="username">lewiscowles</div><a style="text-decoration: none" href="#1650309130.409529" ><div class="time">2022-04-18 19:12</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1651243109.212969"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1651243109.212969" ><div class="time">2022-04-29 14:38</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1652118673.510459"><img src="https://avatars.slack-edge.com/2023-04-05/5087525533632_e914056bfe7293057bc6_72.png" /></a><div class="message"><div class="username">orbit</div><a style="text-decoration: none" href="#1652118673.510459" ><div class="time">2022-05-09 17:51</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1653420048.714029"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653420048.714029" ><div class="time">2022-05-24 19:20</div></a><div class="msg">I've just raised a new FFI issue for a breaking change: <a href="https://github.com/pact-foundation/pact-reference/issues/196">https://github.com/pact-foundation/pact-reference/issues/196</a>

I think it's really important as we want more and more libraries to be shipping on top of the FFI to have a really good regression test suite at the 'black box' level (i.e. using the FFI library itself from another language) and also to communicate breaking changes really clearly with maintainers.

There has been no discussion on this channel about the change beforehand, no impact assessment/statement, no guidance on what to look out for afterwards, and I think we need to fix that. I think we need a more mature process around evolving the FFI and maintainers need to be a big part of that discussion.

I just happened to notice that it had made logging unusable, and people are going to come to rely on that because they can't just set a breakpoint in their code or whatever, because it now all crosses an FFI boundary. This is the type of thing we need to discuss beforehand so that maintainers are aware they need to check things after upgrades, and ideally this should be found long before the FFI is released and people start upgrading to it.

The big problem with the FFI approach is that the bugs will ultimately be reported at the client library level instead of in `pact-reference` itself. If I would've missed that and shipped it, the bug reports would've been raised against PactNet, even though nothing in PactNet changed and the fix doesn't need to be made to PactNet. This hurts the reputation of PactNet, me personally, and the pact ecosystem as a whole, despite it being something generally outside of my control.

I apologise that that's a bit of a rant, but it's very frustrating to be surprised like that and I think we need to define an approach going forwards which prevents those surprises.</div></div></div><br/>
<div><a id="1653420074.139979"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653420074.139979" ><div class="time">2022-05-24 19:21</div></a><div class="msg">Probably one for @yousafn</div></div></div><br/>
<div><a id="1653423043.336759"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1653423043.336759" ><div class="time">2022-05-24 20:10</div></a><div class="msg">Really fair comments @pact544 - Rants are welcome, it is a safe space here.

We do need to and have a duty to make sure the developer experience is on point for maintainers, as it can have direct and very real impact on end users who are using our libraries to protect their deployments.

Appreciate your eagle eye, and I also noted an issue you raised against the pact-specification today aswell.

Will take some time to digest, discuss and get something open arranged for us to attend, collect thoughts, agree a path forward.

Apologies for the inconvenience!

</div></div></div><br/>
<div><a id="1653429014.094699"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1653429014.094699" ><div class="time">2022-05-24 21:50</div></a><div class="msg">There are actually a number of tests/examples for the FFI interface (including some c tests e.g. <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/examples/logging/src/main.c">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/examples/logging/src/main.c</a>).

But I think this behaviour is not included in that.

I think it would be a good opportunity to revisit the test strategy here. We have discussed the idea of a BDD suite here that shows what the FFI does (ideally, there is also a standard client BDD test suite we have also that can be used to test each language. This could also work as a nice up-to-date feature matrix table)</div></div></div><br/>
<div><a id="1653432204.407589"><img src="https://avatars.slack-edge.com/2022-05-24/3575003179924_6a8aaf418f225aff2252_72.jpg" /></a><div class="message"><div class="username">marti92</div><a style="text-decoration: none" href="#1653432204.407589" ><div class="time">2022-05-24 22:43</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1653433410.137719"><img src="https://avatars.slack-edge.com/2018-03-24/334971398433_5b9e9a14ced9f82cd894_72.jpg" /></a><div class="message"><div class="username">bethskurrie</div><a style="text-decoration: none" href="#1653433410.137719" ><div class="time">2022-05-24 23:03</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1653466887.875169"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1653466887.875169" ><div class="time">2022-05-25 08:21</div></a><div class="msg">@pact544 can you please stay on the 0.2.x version. I'll let you know when 0.3.x is ok to use</div></div></div><br/>
<div><a id="1653480437.189689"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1653480437.189689" ><div class="time">2022-05-25 12:07</div></a><div class="msg">(+1 for structured logging! :slightly_smiling_face:)</div></div></div><br/>
<div><a id="1653489694.118169"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653489694.118169" ><div class="time">2022-05-25 14:41</div></a><div class="msg">I don't think structured logging solves the problem, because then that just pushes the problem of parsing and displaying it onto every client library.

We want a consistent report in all the client libraries, and our method for that is to do it in the shared FFI.

I can't stress enough how important these logs are. I've just migrated a codebase with 2283 consumer tests, where 68 were falling after the upgrade.

I had to use the logs extensively because there are a number of breaking changes to track down, and the logs are the only place that give you the info you need to work that out.

In my case, most of the failures were because the Ruby library doesn't validate query string parameters whereas the Rust library does. We had a few tests where the client sends a query parameter but the setup didn't include it, so now those tests fail.

The logs are the **only** way you can find that out.</div></div></div><br/>
<div><a id="1653495793.692369"><img src="https://avatars.slack-edge.com/2021-11-08/2692463631910_326d4058fe7a25fbbf74_72.png" /></a><div class="message"><div class="username">mike.geeves064</div><a style="text-decoration: none" href="#1653495793.692369" ><div class="time">2022-05-25 16:23</div></a><div class="msg">:disappointed: I'm not quite sure where the last year went, I still have on my to-do list progressing looking at how the different libraries get logs and what they look like for useful filtering etc following a conversation with Tim
I will actually get time at some point :open_mouth:I struggled a bit with the overhead of getting a similar example for each language to get anything meaningful
Getting a bit closer :wave: @yousafn  :grinning:</div></div></div><br/>
<div><a id="1653497412.347199"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1653497412.347199" ><div class="time">2022-05-25 16:50</div></a><div class="msg">We might want to find a way to open this discussion up and maybe get some face time together. 

There appears to be a few collaborators who are existing maintainers, long time contributors, or new contributors who are getting involved in different parts of the estate and would be good to get a round table.

I can see some work @lewiscowles has been doing across various repos, so is offering fresh insight with some sensible ideas for long term maintainence which are worth surfacing somewhere.

I know this is diverging slightly from the actual logging issue but might allow us to take a wider lense view of the estate as a whole.

Just spitballing

? agree on a central place to collab
? Drop in sessions across different tz?s to allow video communication as well as async communication
proper Diagram of the dependency graph of doom
? target state
? Gap analysis
Definitely worth getting the input and thoughts of other maintainers, contributors and users here as there will be such valuable insight and potential actionable items, that I can help coordinate </div></div></div><br/>
<div><a id="1653498512.361259"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1653498512.361259" ><div class="time">2022-05-25 17:08</div></a><div class="msg">Associated pact-php consumption of ffi thread here <a href="https://pact-foundation.slack.com/archives/C9W94PXPY/p1653476185980649">https://pact-foundation.slack.com/archives/C9W94PXPY/p1653476185980649</a>

We can save all the prior discussions from this and other conversations/issues over the months/years and move them as they are a bit scattered and reducing context/platform switching or providing a single index is probably key to focusing our cognitive load towards common goals</div></div></div><br/>
<div><a id="1653595118.121969"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653595118.121969" ><div class="time">2022-05-26 19:58</div></a><div class="msg">@matt.fellows @uglyog We were having a discussion about publishing verification results when using non-broker sources <a href="https://pact-foundation.slack.com/archives/C9UTHV2AD/p1653469545842399">https://pact-foundation.slack.com/archives/C9UTHV2AD/p1653469545842399</a>. Someone had asked because the <a href="https://docs.pact.io/pact_nirvana">https://docs.pact.io/pact_nirvana</a> recommend that a verification job be invoked with a changed pact URI (linked to the broker), which you then verify via a URL source (not a broker source) and publish the verification results back.

The user was surprised that PactNet didn't support this option, but in the thread I explained that you can't publish verification results because you don't know the broker URL (and potentially credentials also). I raised <a href="https://github.com/pact-foundation/pact-net/issues/392">https://github.com/pact-foundation/pact-net/issues/392</a>  and I've already pushed up a draft MR for it, but unfortunately at the moment it can't progress.

I've checked the FFI and it doesn't support publishing verification results for anything other than broker sources:

<a href="https://github.com/pact-foundation/pact-reference/blob/e32caf8defd399029dcdf09c5d9298a1fe71d75a/rust/pact_verifier/src/lib.rs#L1207-L1228">https://github.com/pact-foundation/pact-reference/blob/e32caf8defd399029dcdf09c5d9298a1fe71d75a/rust/pact_verifier/src/lib.rs#L1207-L1228</a>

If I call `set_publish_options` on the FFI and add anything other than a broker source then it'll simply not publish anything and log an error instead.</div></div></div><br/>
<div><a id="1653595527.373799"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653595527.373799" ><div class="time">2022-05-26 20:05</div></a><div class="msg">So I think the only safe/robust thing to do if we want to support this (and given the CI/CD guide says it's the recommended way of doing it...) is that the user is forced to specify the broker URL in the publish options at the FFI boundary. We can design nicer library APIs on top of that, but fundamentally you can't just assume the host of the URI is also the host of the broker.</div></div></div><br/>
<div><a id="1653595656.604369"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1653595656.604369" ><div class="time">2022-05-26 20:07</div></a><div class="msg">e.g. the broker could be running on a sub-path instead of a dedicated sub-domain, like `<a href="https://ci.example.org/broker">https://ci.example.org/broker</a>` , so you can't just extract the host and reuse that.

It'd also be very hacky to use some kind of fixed string in the path and take everything up to that path. Pact broker URLs always have `/pacts/` in them somewhere, but you can't just assume that's the only place that'll be. Again, someone could run their broker at `<a href="https://ci.example.org/pacts">https://ci.example.org/pacts</a>` and now string splitting is just asking for trouble.</div></div></div><br/>
<div><a id="1653621400.349339"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1653621400.349339" ><div class="time">2022-05-27 03:16</div></a><div class="msg">What do we need to do to resolve these issues? One thing I have been thinking of is splitting out the FFI into it's own repository. That way we could hand it over to this group to manage, and I can step away to focus on other areas.

The plugin and gRPC work is now nearly complete (which is what I have been focusing on the last 6 months). I just need to get an example project working via FFI (hence the recent change which required a new function), then there are no more plans to change anything else.</div></div></div><br/>
<div><a id="1653633893.804109"><img src="https://avatars.slack-edge.com/2018-03-24/334971398433_5b9e9a14ced9f82cd894_72.jpg" /></a><div class="message"><div class="username">bethskurrie</div><a style="text-decoration: none" href="#1653633893.804109" ><div class="time">2022-05-27 06:44</div></a><div class="msg">I have answered on the issue.</div></div></div><br/>
<div><a id="1654590332.544199"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654590332.544199" ><div class="time">2022-06-07 08:25</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1654599656.189109"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654599656.189109" ><div class="time">2022-06-07 11:00</div></a><div class="msg">Hello.

I don't know if this is the correct venue to ask for help but here we go.

I am using `pact-go` and when running the provider verification I am noticing that the test hangs after the call to `libpact_ffi`.

```2022/06/02 13:09:55 [INFO] package libpact_ffi found
2022/06/02 13:09:55 [INFO] checking version 0.3.3 for lib libpact_ffi within semver range &gt;= 0.1.2, &lt; 1.0.0
2022/06/02 13:09:55 [INFO] checking version 0.3.3 of libpact_ffi against semver constraint &gt;= 0.1.2, &lt; 1.0.0
2022/06/02 13:09:55 [DEBUG] 0.3.3 satisfies constraints 0.3.3 &gt;= 0.1.2, &lt; 1.0.0
2022/06/02 13:09:55 [DEBUG] version check completed
2022/06/02 13:10:21 [DEBUG] starting new proxy with opts {http localhost:8080  0 [0x1036d5910] /__setup &lt;nil&gt;}
2022/06/02 13:10:21 [DEBUG] starting reverse proxy on port 49359
2022/06/02 13:10:21 [DEBUG] waiting for port 49359 to become available
2022/06/02 13:10:21 [DEBUG] pact provider verification
2022/06/02 13:10:21 [DEBUG] initialising rust mock server interface
2022/06/02 13:10:22 [DEBUG] waiting for port 49359 to become available
2022/06/02 13:10:24 [DEBUG] executing verifier FFI with args [--file /Users/nunofrias/Documents/repos/entitlement-orchestrator/cmd/pacts/reseller-entitlement-service-entitlement-orchestrator.json --hostname localhost --port 49359 --provider-name entitlement-orchestrator --loglevel trace]

Hangs here !```
I proceeded to debug the rust ffi code and found that the exact point where it hangs is in the `make_provider_request` function in `<a href="http://provider_client.rs">http://provider_client.rs</a>` , more precisely in:

```let response = request.send()
    .map_err(|err| anyhow!(err))
    .and_then(native_response_to_pact_response)
    .await?;```
More curiously I have also noticed that the first time I run the provider verification after I start the terminal application, it succeeds. Subsequent verifications fails more often than not -- if I restart the command line the verification succeeds.

I would dearly appreciate some help as my knowledge of rust is rather basic.

Thank you.</div></div></div><br/>
<div><a id="1654602604.020449"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654602604.020449" ><div class="time">2022-06-07 11:50</div></a><div class="msg">Hi Nuno, thanks for diving into this</div></div></div><br/>
<div><a id="1654602684.866359"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654602684.866359" ><div class="time">2022-06-07 11:51</div></a><div class="msg">what would be great to know:

? Does it only do this on certain OS?s (e.g. Mac but not linux)? 
? Which version of Pact Go are you running 
</div></div></div><br/>
<div><a id="1654602747.111989"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654602747.111989" ><div class="time">2022-06-07 11:52</div></a><div class="msg">The ?it works once? makes me wonder if any processes are up and about. For example, when it hangs above, can you send http calls to the provider? eg. `curl localhost:49359` or to the proxied target (the actual provider)?</div></div></div><br/>
<div><a id="1654602889.031079"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654602889.031079" ><div class="time">2022-06-07 11:54</div></a><div class="msg">Hi Matt

I am using `go version go1.17.6 darwin/arm64`

I am running on Mac OS 12 (and it is an M1 chip)

I suspect there are some processes outstanding. I am about to enable `dtruss` (strace equivalent) to try and pinpoint the error.</div></div></div><br/>
<div><a id="1654602925.653489"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654602925.653489" ><div class="time">2022-06-07 11:55</div></a><div class="msg">I can send calls to `localhost:49359` and I see the server responses.</div></div></div><br/>
<div><a id="1654602953.776839"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654602953.776839" ><div class="time">2022-06-07 11:55</div></a><div class="msg">Thanks! What version of pact go?</div></div></div><br/>
<div><a id="1654603046.299759"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654603046.299759" ><div class="time">2022-06-07 11:57</div></a><div class="msg">`v2.0.0-beta.11`</div></div></div><br/>
<div><a id="1654603060.196239"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654603060.196239" ><div class="time">2022-06-07 11:57</div></a><div class="msg">I am using the `v2.x.x` branch.</div></div></div><br/>
<div><a id="1654603128.399069"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654603128.399069" ><div class="time">2022-06-07 11:58</div></a><div class="msg">:thinking_face:</div></div></div><br/>
<div><a id="1654603148.672059"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654603148.672059" ><div class="time">2022-06-07 11:59</div></a><div class="msg">have you got a github actions / some build we can see running that reproduces the issue? Does it only happen on M1 (FYI I?m running an M1)</div></div></div><br/>
<div><a id="1654603340.444349"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654603340.444349" ><div class="time">2022-06-07 12:02</div></a><div class="msg">I don't have a build you can test. What I can do is actually run the examples on pact-go and see if the problem occurs.

I'll try on Linux (raspberry py) to see if I can see the issue there.</div></div></div><br/>
<div><a id="1654603368.394579"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654603368.394579" ><div class="time">2022-06-07 12:02</div></a><div class="msg">On it</div></div></div><br/>
<div><a id="1654611499.585759"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654611499.585759" ><div class="time">2022-06-07 14:18</div></a><div class="msg">I managed to reproduce it with the examples in Pact go.

I am sending a patch file with some very minor changes to the default examples namely to the provider test. Essentially I am commenting out the ProviderVersion BrokerURL ConsumerVersionSelectors PublishVerificationResults as I am using a local pact file and to simplify this scenario I am bypassing the communication with the broker. I also comment out the StateHandlers bit as it caused the test to hang on the state change rather than on running the actual provider request -- the underlying issue seems identical.

To set up the example you only need to:

``` git checkout 2.x.x
 git pull
 git apply pact_go_examples.diff
 cd pact-go/examples
 go test -run ^TestConsumerV3$ .
 go test -tags provider -run ^TestV3HTTPProvider$```
I am still working on setting up the GitHub actions (but let me know if the above suffices).</div></div></div><br/>
<div><a id="1654615922.882129"><img src="https://secure.gravatar.com/avatar/a79d85d4eb3862bb32398487bd057d5d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0018-72.png" /></a><div class="message"><div class="username">phil.vint</div><a style="text-decoration: none" href="#1654615922.882129" ><div class="time">2022-06-07 15:32</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1654621299.350139"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654621299.350139" ><div class="time">2022-06-07 17:01</div></a><div class="msg">I should have a github action ready briefly.</div></div></div><br/>
<div><a id="1654630862.357149"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654630862.357149" ><div class="time">2022-06-07 19:41</div></a><div class="msg">Here it is.

This project contains a minimal example. Apologies for taking this long, I am not used to github actions.

<a href="https://github.com/nsfrias/pact-go-issue-repro-20220607">https://github.com/nsfrias/pact-go-issue-repro-20220607</a></div></div></div><br/>
<div><a id="1654630975.060069"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654630975.060069" ><div class="time">2022-06-07 19:42</div></a><div class="msg">As of now I am still waiting for the results of the `macos-12` (which I hope behave similarly to my Mac).

<a href="https://github.com/nsfrias/pact-go-issue-repro-20220607/actions/runs/2456922279">https://github.com/nsfrias/pact-go-issue-repro-20220607/actions/runs/2456922279</a></div></div></div><br/>
<div><a id="1654630992.246899"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654630992.246899" ><div class="time">2022-06-07 19:43</div></a><div class="msg">In ubuntu the issue does not occur.</div></div></div><br/>
<div><a id="1654642639.463169"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654642639.463169" ><div class="time">2022-06-07 22:57</div></a><div class="msg">Thanks Nuno. I can see that it worked on linux too, but the mac build is hanging :man-shrugging:</div></div></div><br/>
<div><a id="1654692453.154729"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654692453.154729" ><div class="time">2022-06-08 12:47</div></a><div class="msg">I am having difficulty running the build against even a x86 macos
<a href="https://github.com/nsfrias/pact-go-issue-repro-20220607/runs/6793692978?check_suite_focus=true">https://github.com/nsfrias/pact-go-issue-repro-20220607/runs/6793692978?check_suite_focus=true</a>

Would it be possible for you to install the project locally on an M1 platform and run the test?</div></div></div><br/>
<div><a id="1654693817.274049"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654693817.274049" ><div class="time">2022-06-08 13:10</div></a><div class="msg">I added some manual reproduction steps on the README</div></div></div><br/>
<div><a id="1654708921.606919"><img src="https://avatars.slack-edge.com/2022-10-06/4188780648804_06ad6132e8393dbb202f_72.png" /></a><div class="message"><div class="username">slacksync</div><a style="text-decoration: none" href="#1654708921.606919" ><div class="time">2022-06-08 17:22</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1654754176.868299"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654754176.868299" ><div class="time">2022-06-09 05:56</div></a><div class="msg">```?  /tmp git clone <a href="https://github.com/nsfrias/pact-go-issue-repro-20220607.git">https://github.com/nsfrias/pact-go-issue-repro-20220607.git</a>
Cloning into 'pact-go-issue-repro-20220607'...
remote: Enumerating objects: 63, done.
remote: Counting objects: 100% (63/63), done.
remote: Compressing objects: 100% (31/31), done.
remote: Total 63 (delta 22), reused 48 (delta 11), pack-reused 0
Receiving objects: 100% (63/63), 26.85 KiB | 8.95 MiB/s, done.
Resolving deltas: 100% (22/22), done.
?  /tmp cd pact-go-issue-repro-20220607
?  pact-go-issue-repro-20220607 git:(main) go install <a href="http://github.com/pact-foundation/pact-go/v2@2.x.x">http://github.com/pact-foundation/pact-go/v2@2.x.x</a>

go: downloading <a href="http://github.com/pact-foundation/pact-go/v2">http://github.com/pact-foundation/pact-go/v2</a> v2.0.0-beta.11.0.20220607035712-b017cad30d3d
?  pact-go-issue-repro-20220607 git:(main) pact-go -l DEBUG install
2022/06/09 15:54:22 [INFO] package libpact_ffi found
2022/06/09 15:54:22 [INFO] checking version 0.3.2 of libpact_ffi against semver constraint &gt;= 0.3.0, &lt; 1.0.0
2022/06/09 15:54:22 [DEBUG] 0.3.2 satisfies constraints 0.3.2 &gt;= 0.3.0, &lt; 1.0.0
2022/06/09 15:54:22 [INFO] package libpact_ffi is correctly installed
2022/06/09 15:54:22 [DEBUG] skip checking ffi version() call because FFI not loaded. This is expected when running the 'pact-go' command.

?  pact-go-issue-repro-20220607 git:(main) go test -run "^TestConsumerV3$" consumer_test.go
go: downloading github.com/stretchr/testify v1.7.2
go: downloading github.com/golang/protobuf v1.3.3
ok  	command-line-arguments	0.846s
?  pact-go-issue-repro-20220607 git:(main) go test -timeout 30s -run "^TestV3HTTPProvider$" .
ok  	example.com/m	3.618s
?  pact-go-issue-repro-20220607 git:(main) go test -v -timeout 30s -run "^TestV3HTTPProvider$" .
=== RUN   TestV3HTTPProvider
2022/06/09 15:55:26 [INFO] package libpact_ffi found
2022/06/09 15:55:26 [INFO] checking version 0.3.2 for lib libpact_ffi within semver range &gt;= 0.1.2, &lt; 1.0.0
2022/06/09 15:55:26 [INFO] checking version 0.3.2 of libpact_ffi against semver constraint &gt;= 0.1.2, &lt; 1.0.0
2022/06/09 15:55:26 [DEBUG] 0.3.2 satisfies constraints 0.3.2 &gt;= 0.1.2, &lt; 1.0.0
2022/06/09 15:55:26 [DEBUG] version check completed
2022/06/09 15:55:26 [DEBUG] starting new proxy with opts {http localhost:8111  0 [0x4390e60 0x4391160 0x461c1c0] /__setup &lt;nil&gt;}
2022/06/09 15:55:26 [DEBUG] starting reverse proxy on port 64647
2022/06/09 15:55:26 [DEBUG] waiting for port 64647 to become available
2022/06/09 15:55:26 [DEBUG] pact provider verification
2022/06/09 15:55:26 [DEBUG] initialising rust mock server interface
2022/06/09 15:55:26 [DEBUG] waiting for port 64647 to become available
2022/06/09 15:55:26 [DEBUG] executing verifier FFI with args [--file /tmp/pact-go-issue-repro-20220607/pacts/PactGoV3Consumer-V3Provider.json --hostname localhost --port 64647 --provider-name V3Provider --loglevel trace]
  Given User foo exists
    WARNING: State Change ignored as there is no state change URL provided
2022/06/09 15:55:28 [DEBUG] HOOK request filter
2022/06/09 15:55:28 [DEBUG] http reverse proxy received connection from [::1]:64653 on path /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:28 [DEBUG] setting proxy to target
2022/06/09 15:55:28 [DEBUG] incoming request /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:28 [DEBUG] outgoing request to target <a href="http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz">http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz</a>
2022/06/09 15:55:28 [TRACE] proxy outgoing request
 POST /foobar?baz=bar&amp;baz=bat&amp;baz=baz HTTP/1.1
Host: localhost:8111
User-Agent: Pact Go
Content-Length: 76
Accept: */*
Accept-Encoding: gzip, deflate
Authorization: Bearer 1234
Authorization: Bearer 1234-dynamic-value
Content-Type: application/json
X-Forwarded-For: ::1


2022/06/09 15:55:28 [TRACE] proxied server response
 HTTP/1.1 200 OK
Content-Length: 458
Content-Type: application/json
Date: Thu, 09 Jun 2022 05:55:28 GMT


			{
				"accountBalance": 123.76,
				"datetime": "2020-01-01",
				"equality": "a thing",
				"id": 12,
				"itemsMin": [
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese"
				],
				"itemsMinMax": [
					27,
					27,
					27,
					27,
					27
				],
				"lastName": "Sampson",
				"name": "Billy",
				"superstring": "foo",
				"arrayContaining": [
					"string",
					1,
					{
						"foo": "bar"
					}
				]
			}
2022/06/09 15:55:28 [DEBUG] executing after hook
2022/06/09 15:55:28 [DEBUG] HOOK after each
  Given User foo exists
    WARNING: State Change ignored as there is no state change URL provided
2022/06/09 15:55:28 [DEBUG] HOOK request filter
2022/06/09 15:55:28 [DEBUG] http reverse proxy received connection from [::1]:64656 on path /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:28 [DEBUG] setting proxy to target
2022/06/09 15:55:28 [DEBUG] incoming request /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:28 [DEBUG] outgoing request to target <a href="http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz">http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz</a>
2022/06/09 15:55:28 [TRACE] proxy outgoing request
 POST /foobar?baz=bar&amp;baz=bat&amp;baz=baz HTTP/1.1
Host: localhost:8111
User-Agent: Pact Go
Content-Length: 76
Accept: */*
Accept-Encoding: gzip, deflate
Authorization: Bearer 1234
Authorization: Bearer 1234-dynamic-value
Content-Type: application/json
X-Forwarded-For: ::1


2022/06/09 15:55:28 [TRACE] proxied server response
 HTTP/1.1 200 OK
Content-Length: 458
Content-Type: application/json
Date: Thu, 09 Jun 2022 05:55:28 GMT


			{
				"accountBalance": 123.76,
				"datetime": "2020-01-01",
				"equality": "a thing",
				"id": 12,
				"itemsMin": [
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese"
				],
				"itemsMinMax": [
					27,
					27,
					27,
					27,
					27
				],
				"lastName": "Sampson",
				"name": "Billy",
				"superstring": "foo",
				"arrayContaining": [
					"string",
					1,
					{
						"foo": "bar"
					}
				]
			}
2022/06/09 15:55:28 [DEBUG] executing after hook
2022/06/09 15:55:28 [DEBUG] HOOK after each
  Given User foo exists
    WARNING: State Change ignored as there is no state change URL provided
2022/06/09 15:55:29 [DEBUG] HOOK request filter
2022/06/09 15:55:29 [DEBUG] http reverse proxy received connection from [::1]:64659 on path /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:29 [DEBUG] setting proxy to target
2022/06/09 15:55:29 [DEBUG] incoming request /foobar?baz=bar&amp;baz=bat&amp;baz=baz
2022/06/09 15:55:29 [DEBUG] outgoing request to target <a href="http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz">http://localhost:8111/foobar?baz=bar&amp;baz=bat&amp;baz=baz</a>
2022/06/09 15:55:29 [TRACE] proxy outgoing request
 POST /foobar?baz=bar&amp;baz=bat&amp;baz=baz HTTP/1.1
Host: localhost:8111
User-Agent: Pact Go
Content-Length: 76
Accept: */*
Accept-Encoding: gzip, deflate
Authorization: Bearer 1234
Authorization: Bearer 1234-dynamic-value
Content-Type: application/json
X-Forwarded-For: ::1


2022/06/09 15:55:29 [TRACE] proxied server response
 HTTP/1.1 200 OK
Content-Length: 458
Content-Type: application/json
Date: Thu, 09 Jun 2022 05:55:29 GMT


			{
				"accountBalance": 123.76,
				"datetime": "2020-01-01",
				"equality": "a thing",
				"id": 12,
				"itemsMin": [
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese",
					"thereshouldbe3ofthese"
				],
				"itemsMinMax": [
					27,
					27,
					27,
					27,
					27
				],
				"lastName": "Sampson",
				"name": "Billy",
				"superstring": "foo",
				"arrayContaining": [
					"string",
					1,
					{
						"foo": "bar"
					}
				]
			}
2022/06/09 15:55:29 [DEBUG] executing after hook
2022/06/09 15:55:29 [DEBUG] HOOK after each

Verifying a pact between PactGoV3Consumer and V3Provider

  A request to do a foo
    returns a response which
      has status code 200 (OK)
      includes headers
        "Content-Type" with value "application/json" (OK)
      has a matching body (OK)


Verifying a pact between PactGoV3Consumer and V3Provider

  A request to do a foo
    returns a response which
      has status code 200 (OK)
      includes headers
        "Content-Type" with value "application/json" (OK)
      has a matching body (OK)


Verifying a pact between V3Consumer and V3Provider

  A request to do a foo
    returns a response which
      has status code 200 (OK)
      includes headers
        "Content-Type" with value "application/json" (OK)
      has a matching body (OK)


=== RUN   TestV3HTTPProvider/Provider_pact_verification
--- PASS: TestV3HTTPProvider (3.10s)
    --- PASS: TestV3HTTPProvider/Provider_pact_verification (0.00s)
PASS
ok  	<a href="http://example.com/m">http://example.com/m</a>	3.663s```</div></div></div><br/>
<div><a id="1654754198.708339"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654754198.708339" ><div class="time">2022-06-09 05:56</div></a><div class="msg">output from `go env`:

```
GO111MODULE=""
GOARCH="amd64"
GOBIN=""
GOCACHE="/Users/matthew.fellows/Library/Caches/go-build"
GOENV="/Users/matthew.fellows/Library/Application Support/go/env"
GOEXE=""
GOEXPERIMENT=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="darwin"
GOINSECURE=""
GOMODCACHE="/Users/matthew.fellows/go/pkg/mod"
GONOPROXY=""
GONOSUMDB=""
GOOS="darwin"
GOPATH="/Users/matthew.fellows/go"
GOPRIVATE=""
GOPROXY="<a href="https://proxy.golang.org">https://proxy.golang.org</a>,direct"
GOROOT="/usr/local/Cellar/go/1.18.2/libexec"
GOSUMDB="<a href="http://sum.golang.org">http://sum.golang.org</a>"
GOTMPDIR=""
GOTOOLDIR="/usr/local/Cellar/go/1.18.2/libexec/pkg/tool/darwin_amd64"
GOVCS=""
GOVERSION="go1.18.2"
GCCGO="gccgo"
GOAMD64="v1"
AR="ar"
CC="clang"
CXX="clang++"
CGO_ENABLED="1"
GOMOD="/tmp/pact-go-issue-repro-20220607/go.mod"
GOWORK=""
CGO_CFLAGS="-g -O2"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-g -O2"
CGO_FFLAGS="-g -O2"
CGO_LDFLAGS="-g -O2"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -arch x86_64 -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/gl/c3f3yhws1mg754r_t7l5hfm80000gp/T/go-build2365344512=/tmp/go-build -gno-record-gcc-switches -fno-common"```</div></div></div><br/>
<div><a id="1654851267.868699"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654851267.868699" ><div class="time">2022-06-10 08:54</div></a><div class="msg">Thank you very much</div></div></div><br/>
<div><a id="1654851366.880969"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654851366.880969" ><div class="time">2022-06-10 08:56</div></a><div class="msg">I still encounter the same issue, so does a colleague with M1.</div></div></div><br/>
<div><a id="1654851397.757039"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654851397.757039" ><div class="time">2022-06-10 08:56</div></a><div class="msg">The only difference is the `go env`</div></div></div><br/>
<div><a id="1654852626.038929"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654852626.038929" ><div class="time">2022-06-10 09:17</div></a><div class="msg">Are you running in Rosetta mode or normal? Have you tried both?</div></div></div><br/>
<div><a id="1654852658.810789"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654852658.810789" ><div class="time">2022-06-10 09:17</div></a><div class="msg">Are they work machines or personal? Is it possible there is AV or endpoint security interference?</div></div></div><br/>
<div><a id="1654852675.547039"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654852675.547039" ><div class="time">2022-06-10 09:17</div></a><div class="msg">I am running in normal mode. I have had some issues with rosetta in the past.</div></div></div><br/>
<div><a id="1654852698.444669"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654852698.444669" ><div class="time">2022-06-10 09:18</div></a><div class="msg">Work machines</div></div></div><br/>
<div><a id="1654852821.384679"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654852821.384679" ><div class="time">2022-06-10 09:20</div></a><div class="msg">I wish we could run builds on M1 to create a reproducible environment. Unfortunately there are no real options to do so at the moment</div></div></div><br/>
<div><a id="1654852852.532589"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654852852.532589" ><div class="time">2022-06-10 09:20</div></a><div class="msg">I am trying to run in rosetta mode</div></div></div><br/>
<div><a id="1654852908.438469"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654852908.438469" ><div class="time">2022-06-10 09:21</div></a><div class="msg">That said I manage to workaround the issue by running the tests on a linux VM running on my mac</div></div></div><br/>
<div><a id="1654853128.092639"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654853128.092639" ><div class="time">2022-06-10 09:25</div></a><div class="msg">Btw I add to add another `cgo`  config to run pact-go in linux arm64.
```diff --git a/internal/native/lib.go b/internal/native/lib.go
index 9ece6b7..d4324ff 100644
--- a/internal/native/lib.go
+++ b/internal/native/lib.go
@@ -6,5 +6,6 @@ package native
 #cgo darwin,amd64 LDFLAGS: -L/tmp -L/usr/local/lib -Wl,-rpath -Wl,/tmp -Wl,-rpath -Wl,/usr/local/lib -lpact_ffi
 #cgo windows,amd64 LDFLAGS: -lpact_ffi
 #cgo linux,amd64 LDFLAGS: -L/tmp -L/opt/pact/lib -L/usr/local/lib -Wl,-rpath -Wl,/opt/pact/lib -Wl,-rpath -Wl,/tmp -Wl,-rpath -Wl,/usr/local/lib -lpact_ffi
+#cgo linux,arm64 LDFLAGS: -L/tmp -L/opt/pact/lib -L/usr/local/lib -Wl,-rpath -Wl,/opt/pact/lib -Wl,-rpath -Wl,/tmp -Wl,-rpath -Wl,/usr/local/lib -lpact_ffi
 */
 import "C"```</div></div></div><br/>
<div><a id="1654853185.770149"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654853185.770149" ><div class="time">2022-06-10 09:26</div></a><div class="msg">Will submit a merge request for that asap</div></div></div><br/>
<div><a id="1654853405.822719"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654853405.822719" ><div class="time">2022-06-10 09:30</div></a><div class="msg">Does it work on Linux arm? I don't think it should, to my knowledge we don't compile for it: <a href="https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.3.2">https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.3.2</a></div></div></div><br/>
<div><a id="1654853433.425879"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654853433.425879" ><div class="time">2022-06-10 09:30</div></a><div class="msg">I compiled for it locally</div></div></div><br/>
<div><a id="1654853734.911479"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654853734.911479" ><div class="time">2022-06-10 09:35</div></a><div class="msg">Ah, got it.</div></div></div><br/>
<div><a id="1654853744.836399"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654853744.836399" ><div class="time">2022-06-10 09:35</div></a><div class="msg">Fair enough we can definitely bring that in</div></div></div><br/>
<div><a id="1654854011.391419"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654854011.391419" ><div class="time">2022-06-10 09:40</div></a><div class="msg">I feel sheepish now. I gave it a try with rosetta and it is passing consistently.</div></div></div><br/>
<div><a id="1654854072.515879"><img src="https://secure.gravatar.com/avatar/ce25bf8f9d996435cab3447d764bf860.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0014-72.png" /></a><div class="message"><div class="username">nuno.frias</div><a style="text-decoration: none" href="#1654854072.515879" ><div class="time">2022-06-10 09:41</div></a><div class="msg">Thank you very much for all the help.</div></div></div><br/>
<div><a id="1654854085.761069"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1654854085.761069" ><div class="time">2022-06-10 09:41</div></a><div class="msg">But it should be able to work outside of Rosetta. That's a good clue though. I should be able to repro that situation</div></div></div><br/>
<div><a id="1657643805.068049"><img src="https://avatars.slack-edge.com/2022-07-12/3783075922518_481957910b9265514ddc_72.jpg" /></a><div class="message"><div class="username">fabricio.mendes.ti</div><a style="text-decoration: none" href="#1657643805.068049" ><div class="time">2022-07-12 16:36</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1660075672.327039"><img src="https://avatars.slack-edge.com/2022-07-28/3859408756438_728818d745011d5bd6a9_72.png" /></a><div class="message"><div class="username">robert.henzel</div><a style="text-decoration: none" href="#1660075672.327039" ><div class="time">2022-08-09 20:07</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1660980302.060169"><img src="https://avatars.slack-edge.com/2022-08-20/3980240791361_a2e07b726cc933ec5455_72.png" /></a><div class="message"><div class="username">duynguyenptithcm</div><a style="text-decoration: none" href="#1660980302.060169" ><div class="time">2022-08-20 07:25</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1661618365.886359"><img src="https://avatars.slack-edge.com/2022-08-26/4011959190689_585b829a2681e4ff8e42_72.jpg" /></a><div class="message"><div class="username">dwalleck</div><a style="text-decoration: none" href="#1661618365.886359" ><div class="time">2022-08-27 16:39</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1661896347.280049"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1661896347.280049" ><div class="time">2022-08-30 21:52</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1663777921.362419"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1663777921.362419" ><div class="time">2022-09-21 16:32</div></a><div class="msg">I got one problem with pact plugins:

When I verify provider's pacts that required plugins (csv, protobuf), on Linux and Mac, it work fine, but on Windows it hang.

It happen on this line <a href="https://github.com/tienvx/pact-php/blob/rust-ffi-plugins-downloads/src/PhpPact/Standalone/ProviderVerifier/Verifier.php#L163">https://github.com/tienvx/pact-php/blob/rust-ffi-plugins-downloads/src/PhpPact/Standalone/ProviderVerifier/Verifier.php#L163</a>

As you can see here <a href="https://github.com/tienvx/pact-php/actions/runs/3099040342">https://github.com/tienvx/pact-php/actions/runs/3099040342</a> , all tests *passed* on Linux and Mac. On Windows it *hang* for hours. I have to cancel it manually.

Version:
? pact-ffi: 0.3.11
? pact-csv-plugin: 0.0.3
? pact-protobuf-plugin: 0.1.13
Pacts: <a href="https://github.com/tienvx/pact-php/tree/rust-ffi-plugins-downloads/example/pacts">https://github.com/tienvx/pact-php/tree/rust-ffi-plugins-downloads/example/pacts</a>

I test again on my Windows machine and the same behavior:</div></div></div><br/>
<div><a id="1663809467.203579"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1663809467.203579" ><div class="time">2022-09-22 01:17</div></a><div class="msg">I have this same problem, and I haven't found the answer to the issue. Can you raise an issue for this?</div></div></div><br/>
<div><a id="1663809548.906409"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1663809548.906409" ><div class="time">2022-09-22 01:19</div></a><div class="msg">Sure. I will report to pact-plugins repo</div></div></div><br/>
<div><a id="1663812087.032159"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1663812087.032159" ><div class="time">2022-09-22 02:01</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-plugins/issues/8">https://github.com/pact-foundation/pact-plugins/issues/8</a></div></div></div><br/>
<div><a id="1667433854.748409"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1667433854.748409" ><div class="time">2022-11-03 00:04</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1669909500.789959"><img src="https://avatars.slack-edge.com/2023-04-05/5087525533632_e914056bfe7293057bc6_72.png" /></a><div class="message"><div class="username">orbit</div><a style="text-decoration: none" href="#1669909500.789959" ><div class="time">2022-12-01 15:45</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1670249958.103749"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1670249958.103749" ><div class="time">2022-12-05 14:19</div></a><div class="msg">I saw a inconsistency in file naming:
? <a href="https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/libpact_ffi-linux-x86_64.so.gz">https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/libpact_ffi-linux-x86_64.so.gz</a>
? <a href="https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/libpact_ffi-osx-x86_64.dylib.gz">https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/libpact_ffi-osx-x86_64.dylib.gz</a>
? <a href="https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/pact_ffi-windows-x86_64.dll.gz">https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.3.15/pact_ffi-windows-x86_64.dll.gz</a>
`libpact_ffi` vs `pact_ffi` . I think there is a typo somewhere?

But I guess we don't want to fix it because currently there are many languages are downloading and using these files?</div></div></div><br/>
<div><a id="1670277073.179559"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1670277073.179559" ><div class="time">2022-12-05 21:51</div></a><div class="msg">Windows has a different convention. For Linux, the .so file has to start with lib otherwise it won't be automatically picked up, I assume OSX is the same.</div></div></div><br/>
<div><a id="1670479996.696149"><img src="https://secure.gravatar.com/avatar/a7c19ad05e16d01c8891843a77183af8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0013-72.png" /></a><div class="message"><div class="username">j3rry.wan9</div><a style="text-decoration: none" href="#1670479996.696149" ><div class="time">2022-12-08 06:13</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1670632184.154969"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670632184.154969" ><div class="time">2022-12-10 00:29</div></a><div class="msg">:wave::skin-tone-4: all - i'm helping a dev with a failed build relating to a pact test.   nothing seems to have changed on our end but got a `dummy` error message.... i hope it's not us. any ideas in thread</div></div></div><br/>
<div><a id="1670632194.923559"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670632194.923559" ><div class="time">2022-12-10 00:29</div></a><div class="msg">```2022/12/10 00:10:51 [DEBUG] pact setup
2022/12/10 00:10:51 [DEBUG] initialising rust mock server interface
2022/12/10 00:10:51 [DEBUG] log_to_stdout res 0
2022/12/10 00:10:51 [DEBUG] pact add V3 interaction
2022-12-10T00:10:51.555975Z ERROR ThreadId(01) pact_ffi::mock_server::bodies: Failed to parse matching rule from JSON - dummy is not a valid matching rule type    
2022/12/10 00:10:51 [DEBUG] pact verify
2022/12/10 00:10:51 [DEBUG] mock server starting on address: 127.0.0.1:0
2022/12/10 00:10:51 [DEBUG] mock server running on port: 38365```</div></div></div><br/>
<div><a id="1670632508.982889"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670632508.982889" ><div class="time">2022-12-10 00:35</div></a><div class="msg">```libpact_ffi:
    libname: libpact_ffi
    version: 0.3.15
    hash: e4babe9bd82761f01f595a9fd31a0eb8```</div></div></div><br/>
<div><a id="1670632571.170709"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670632571.170709" ><div class="time">2022-12-10 00:36</div></a><div class="msg">fwiw, it's just an error showing red and doesnt seem to fail the build....  we noticed this along with another test failure which we just cleaned up</div></div></div><br/>
<div><a id="1670633798.798159"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670633798.798159" ><div class="time">2022-12-10 00:56</div></a><div class="msg">also in libpact_ffi-v0.3.14 according to our builds</div></div></div><br/>
<div><a id="1670638239.857409"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1670638239.857409" ><div class="time">2022-12-10 02:10</div></a><div class="msg">That is strange. My guess is it's in Pact Go. I'll check tonight</div></div></div><br/>
<div><a id="1670828618.241979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1670828618.241979" ><div class="time">2022-12-12 07:03</div></a><div class="msg">OK because of reasons, all things that can accept a Matcher need to be JSON serialisable. This meant that plain string values got escaped with a `"` so I must have used a dummy matcher a few years back. It seems like it doesn?t cause a functional issues, but I?ve put in a minor fix that essentially detects a string value there and prevents the additional quotes.</div></div></div><br/>
<div><a id="1670828633.864789"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1670828633.864789" ><div class="time">2022-12-12 07:03</div></a><div class="msg">It?s in the latest `2.x.x` that has not been released yet (i.e. tagged)</div></div></div><br/>
<div><a id="1670828641.492669"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1670828641.492669" ><div class="time">2022-12-12 07:04</div></a><div class="msg">Would you mind seeing if that makes the issue go away?</div></div></div><br/>
<div><a id="1670863579.900979"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670863579.900979" ><div class="time">2022-12-12 16:46</div></a><div class="msg">yep - i'll take a look this morning.</div></div></div><br/>
<div><a id="1670869656.461359"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670869656.461359" ><div class="time">2022-12-12 18:27</div></a><div class="msg">@matt.fellows - looks good now!

I was able to replicate the issue using the prior pact-go 2.x.x version only after updating my local `libpact_ffi` to `0.3.15`.  And ultimately verified your fix on the head of branch 2.x.x.

Thanks for fixing!</div></div></div><br/>
<div><a id="1670871783.819459"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1670871783.819459" ><div class="time">2022-12-12 19:03</div></a><div class="msg">correction, it was `v2.0.0-beta.17.0.20221212070231-76032bbaf2b6`  i verified.</div></div></div><br/>
<div><a id="1670878664.042689"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1670878664.042689" ><div class="time">2022-12-12 20:57</div></a><div class="msg">Awesome, thank you! I?ll get a new release out in the next couple of days</div></div></div><br/>
<div><a id="1671116236.786219"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1671116236.786219" ><div class="time">2022-12-15 14:57</div></a><div class="msg">Am I correct?
? Pact Ruby Standalone support Pact Specification 2.x
? Pact Rust FFI support Pact Specification 2.x, 3.x, 4.x</div></div></div><br/>
<div><a id="1671118073.723289"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671118073.723289" ><div class="time">2022-12-15 15:27</div></a><div class="msg">AFAIK

? Pact Ruby Standalone support Pact Specification 1, 1.1, 2.x
? Pact Rust FFI support Pact Specification 1, 1.1, 2.x, 3.x, 4.x
    ? or at least you can specify them all. 
<a href="https://github.com/pact-foundation/pact-reference/blob/dbe569502561c7d300e2bc428e3553617d4a838b/rust/pact_ffi/src/models/pact_specification.rs#L24-L36">https://github.com/pact-foundation/pact-reference/blob/dbe569502561c7d300e2bc428e3553617d4a838b/rust/pact_ffi/src/models/pact_specification.rs#L24-L36</a>

what that actually means to full end to end support of mix and matching.

I would assume that theoretically means anyone on a ruby core backed language cannot verify 3.x/4.x pacts and may have limited support for message pacts</div></div></div><br/>
<div><a id="1671118267.316939"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671118267.316939" ><div class="time">2022-12-15 15:31</div></a><div class="msg">some languages have the ability to generate 3.x message pacts, like pact-python which still uses the ruby core

<a href="https://github.com/pact-foundation/pact-python/blob/d87d54bce2ed2f74b0a2bb46314b18541bdb598a/pact/message_pact.py#L42">https://github.com/pact-foundation/pact-python/blob/d87d54bce2ed2f74b0a2bb46314b18541bdb598a/pact/message_pact.py#L42</a>

<a href="https://github.com/pact-foundation/pact-message-ruby">https://github.com/pact-foundation/pact-message-ruby</a>

There is an open ticket on <a href="https://github.com/pact-foundation/pact-message-ruby/issues/6">https://github.com/pact-foundation/pact-message-ruby/issues/6</a> for support in that gem for v3 message support.

It might be better to use the ffi via ruby

<a href="https://github.com/YOU54F/pact-ruby-ffi/blob/main/lib/pact_ruby_ffi.rb">https://github.com/YOU54F/pact-ruby-ffi/blob/main/lib/pact_ruby_ffi.rb</a></div></div></div><br/>
<div><a id="1671118974.144049"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671118974.144049" ><div class="time">2022-12-15 15:42</div></a><div class="msg">btw thank you for the awesome PHP examples in pact-reference

They inspired me

? <a href="https://github.com/pact-foundation/pact-reference/blob/master/php/src/consumer-2.php">https://github.com/pact-foundation/pact-reference/blob/master/php/src/consumer-2.php</a> :chef-kiss: 
? <a href="https://github.com/YOU54F/pact-python-ffi/blob/main/pact_message_v3.py">https://github.com/YOU54F/pact-python-ffi/blob/main/pact_message_v3.py</a>
? <a href="https://github.com/YOU54F/pact-ruby-ffi/blob/main/spec/pactffi_create_message_pact_spec.rb">https://github.com/YOU54F/pact-ruby-ffi/blob/main/spec/pactffi_create_message_pact_spec.rb</a>
Plugin examples
? <a href="https://github.com/pact-foundation/pact-reference/blob/php_plugins/php/src/consumer-plugin.php">https://github.com/pact-foundation/pact-reference/blob/php_plugins/php/src/consumer-plugin.php</a>
? <a href="https://github.com/YOU54F/pact-python-ffi/blob/main/pact_plugin_grpc_v4.py">https://github.com/YOU54F/pact-python-ffi/blob/main/pact_plugin_grpc_v4.py</a>
? <a href="https://github.com/YOU54F/pact-ruby-ffi/blob/main/examples/area_calculator/spec/pactffi_create_plugin_pact_spec.rb">https://github.com/YOU54F/pact-ruby-ffi/blob/main/examples/area_calculator/spec/pactffi_create_plugin_pact_spec.rb</a>
? <a href="https://github.com/YOU54F/pact-bun/blob/main/src/grpc.consumer.raw.test.ts">https://github.com/YOU54F/pact-bun/blob/main/src/grpc.consumer.raw.test.ts</a>
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/deno/hello_pact_grpc.ts">https://github.com/YOU54F/hello_ffi/blob/main/deno/hello_pact_grpc.ts</a>
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/swift/hello_grpc.swift">https://github.com/YOU54F/hello_ffi/blob/main/swift/hello_grpc.swift</a>
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/perl/hello_grpc.pl">https://github.com/YOU54F/hello_ffi/blob/main/perl/hello_grpc.pl</a>
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/lua/hello_grpc.lua">https://github.com/YOU54F/hello_ffi/blob/main/lua/hello_grpc.lua</a>
Other language examples based on based on this Ruby example (which is where I started originally in FFI land - <a href="https://github.com/pact-foundation/pact-reference/blob/master/ruby/example_consumer_spec/spec/simple_consumer_spec.rb">https://github.com/pact-foundation/pact-reference/blob/master/ruby/example_consumer_spec/spec/simple_consumer_spec.rb</a>)
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/zig/hello_pact_mock_server.zig">https://github.com/YOU54F/hello_ffi/blob/main/zig/hello_pact_mock_server.zig</a>
? <a href="https://github.com/YOU54F/hello_ffi/blob/main/raku/hello_pact_mock_server.raku">https://github.com/YOU54F/hello_ffi/blob/main/raku/hello_pact_mock_server.raku</a>
</div></div></div><br/>
<div><a id="1671119035.829599"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671119035.829599" ><div class="time">2022-12-15 15:43</div></a><div class="msg">its been a fun little advent of code style polyglot puzzle game for me</div></div></div><br/>
<div><a id="1671621429.678749"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671621429.678749" ><div class="time">2022-12-21 11:17</div></a><div class="msg">Hey all!

Do we have canonical examples of ffi usage for the lifecycle of

? http v3 pact test
? message v3 pact test
? http v4 pact test
? Message async v4 pact test
? Message sync v4 pact test
? Plug-in v4 pact test
Can the FFI deal with creating and verifying v2 pacts as well?

If so canonical examples would be great for that.

Some examples around certain other lifecycles

? logging
? Error handling
? Pact file writing 
There is some existing useful examples / docs, I used the PHP ones as my go to to replicate

? canonical examples in c <a href="https://github.com/pact-foundation/pact-reference/tree/master/rust/pact_ffi/examples">https://github.com/pact-foundation/pact-reference/tree/master/rust/pact_ffi/examples</a>
? Arch <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/ARCHITECTURE.md">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/ARCHITECTURE.md</a>
? PHP <a href="https://github.com/pact-foundation/pact-reference/tree/php_plugins/php/src">https://github.com/pact-foundation/pact-reference/tree/php_plugins/php/src</a>
? Python <a href="https://github.com/pact-foundation/pact-reference/tree/php_plugins/python">https://github.com/pact-foundation/pact-reference/tree/php_plugins/python</a>
? There are other Lang examples in that repo ( c / js / ruby )


I?ve been on a little journey learning about FFI / C interop over that last couple of months as a bit of a side thing, as I didn?t know enough about the low level workings of Pact!

<a href="https://github.com/YOU54F/hello_ffi">https://github.com/YOU54F/hello_ffi</a></div></div></div><br/>
<div><a id="1671621586.205559"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1671621586.205559" ><div class="time">2022-12-21 11:19</div></a><div class="msg">Also would it be useful to authors to be able to see comparable implementations in each of the languages, either samples of direct usage of the ffi, or usage of the ffi in our existing client libraries ( both official and community )

I?ve thought about pulling these into a docs page with code tabs, so I can easily glance across say pact-js-core / pact-net and the current WIP?s done by community members of pact-PHP and pact-python</div></div></div><br/>
<div><a id="1671661369.255059"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1671661369.255059" ><div class="time">2022-12-21 22:22</div></a><div class="msg">&gt; Can the FFI deal with creating and verifying v2 pacts as well?
Yes, it should support all the spec versions as it just wraps Pact-Rust</div></div></div><br/>
<div><a id="1673485857.414689"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1673485857.414689" ><div class="time">2023-01-12 01:10</div></a><div class="msg">qq - was there a change to the minimum supported version of glibc for  libpact_ffi?   it seems like the min was `2.28`, but i'm noticing an old build image that use to fail due to an older glibc now passed.   so curious and not complaining.</div></div></div><br/>
<div><a id="1673485971.344939"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1673485971.344939" ><div class="time">2023-01-12 01:12</div></a><div class="msg">yep, I think we now support back to 2.24. See also <a href="https://github.com/pact-foundation/pact-reference/issues/202">https://github.com/pact-foundation/pact-reference/issues/202</a></div></div></div><br/>
<div><a id="1673486288.459059"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1673486288.459059" ><div class="time">2023-01-12 01:18</div></a><div class="msg">:fbwow: i had no idea - thank goodness for this additional support.</div></div></div><br/>
<div><a id="1673831364.981589"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1673831364.981589" ><div class="time">2023-01-16 01:09</div></a><div class="msg">Hi

<a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1038">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1038</a>

Is `{"value": ["2","3"]}` the same with `{"value": ["2","3"], "pact:matcher:type": "values"}`  ?

In other words: If both `pact:matcher:type` and `pact:generator:type` are missing, and `value` is an array, `pact:matcher:type` will be set to `values` ?</div></div></div><br/>
<div><a id="1673831945.522529"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1673831945.522529" ><div class="time">2023-01-16 01:19</div></a><div class="msg">No, I don't think so.</div></div></div><br/>
<div><a id="1673831968.683909"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1673831968.683909" ><div class="time">2023-01-16 01:19</div></a><div class="msg">Looking at the code, it will just treat it as a normal array</div></div></div><br/>
<div><a id="1673832101.027619"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1673832101.027619" ><div class="time">2023-01-16 01:21</div></a><div class="msg">:+1: thanks for the info</div></div></div><br/>
<div><a id="1678181832.183139"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1678181832.183139" ><div class="time">2023-03-07 09:37</div></a><div class="msg">Hi, are there any way to disable this log:

```The pact at BROKER_URL is being verified because the pact content belongs to the consumer version matching the following criterion:
    * latest version from branch 'main' (1.0.0)

Verifying a pact between CONSUMER and PROVIDER

  A get request to /marriages/{id}
     Given A marriage with id 754992c7-c9b8-44d0-840d-9173497ba6e3 exists
      Request Failed - One or more of the setup state change handlers has failed

  A get request to /users/{id}
     Given A user with id dcd79453-7346-4423-ae6e-127c60d8dd20 exists
      Request Failed - One or more of the setup state change handlers has failed


Failures:

1) Verifying a pact between CONSUMER and PROVIDER Given A marriage with id 754992c7-c9b8-44d0-840d-9173497ba6e3 exists - A get request to /marriages/{id} - One or more of the setup state change handlers has failed

2) Verifying a pact between CONSUMER and PROVIDER Given A user with id dcd79453-7346-4423-ae6e-127c60d8dd20 exists - A get request to /users/{id} - One or more of the setup state change handlers has failed


There were 2 pact failures```
I think this log is not affected by these 3 ways:
? `$this-&gt;ffi-&gt;pactffi_init('PACT_LOGLEVEL');` I think only for mock server, do nothing for verifier
? `$this-&gt;ffi-&gt;pactffi_init_with_log_level('off');` only print more log, can't disable
? `$this-&gt;ffi-&gt;pactffi_logger_init();` &amp; `$this-&gt;ffi-&gt;pactffi_logger_attach_sink('stdout', $this-&gt;ffi-&gt;LevelFilter_Off);` &amp; `$this-&gt;ffi-&gt;pactffi_logger_apply();` doesn't work as well
Don't get me wrong, this log is very useful. But after I fix the problem in the log, I think I want the output a bit shorter when running the tests.</div></div></div><br/>
<div><a id="1678186080.035519"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1678186080.035519" ><div class="time">2023-03-07 10:48</div></a><div class="msg">I don?t think so, as this is the key output that all users must see. It?s not a ?log? message, as such</div></div></div><br/>
<div><a id="1678186179.331129"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1678186179.331129" ><div class="time">2023-03-07 10:49</div></a><div class="msg">Thank Matt</div></div></div><br/>
<div><a id="1678228390.483089"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1678228390.483089" ><div class="time">2023-03-07 22:33</div></a><div class="msg">It is not log output, but written to standard out</div></div></div><br/>
<div><a id="1678228423.358699"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1678228423.358699" ><div class="time">2023-03-07 22:33</div></a><div class="msg">There is no level associated with it.</div></div></div><br/>
<div><a id="1679503099.374349"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679503099.374349" ><div class="time">2023-03-22 16:38</div></a><div class="msg">Hi, when working with grpc plugin, I saw this behavior, so I want to discuss about it:

At first I call `pactffi_verifier_set_provider_info` , it will create a default provider's transport `{transport: "http", port: None, part: "/", scheme: None}` . Then I call `pactffi_verifier_add_provider_transport` , it will create second provider's transport `{transport: "http", port: 8000, part: "/", scheme: "http"}` . Finally I call `pactffi_verifier_execute` , the result is `false` because it call provider on the wrong port (<a href="http://localhost">http://localhost</a>, because it use the first transport, the provider is located at <a href="http://localhost:8000">http://localhost:8000</a>)

Do you think it's an issue?

If yes, I can think of some solutions for it:
? Implement `pactffi_verifier_set_provider_info_v2` that didn't create default provider's transport <a href="https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-1">https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-1</a>
? Don't create the default provider's transport at all <a href="https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-2">https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-2</a>
? When calling `pactffi_verifier_set_provider_info` , set `scheme` to something that will be never used e.g. `scheme=invalid =&gt; transport=invalid` <a href="https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-3">https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:solution-3</a>
? Instead of appending new transport, try to find the existing transport with the same name and update port + part + scheme (no code, I don't think I know how to do it properly)

Some notes:
? This is why I think this issue is valid: I saw this attribute on provider info's protocol, port and path: `#[deprecated(note = "Use transports instead")]`
? The example with 2 transport with the same name `http` may look strange to you. You may ask: so why don't call `pactffi_verifier_add_provider_transport` at all? Just put the port=8000 in the first call to `pactffi_verifier_set_provider_info` . The answer for this is the note above.
? I need to test calling to `pactffi_verifier_add_provider_transport` because when working with the grpc plugin, I think calling `pactffi_verifier_add_provider_transport` is required so that the provider's verifier can work. The default transport `http` doesn't work with grpc</div></div></div><br/>
<div><a id="1679523710.451759"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1679523710.451759" ><div class="time">2023-03-22 22:21</div></a><div class="msg">I think the actual fix should be that `pactffi_verifier_add_provider_transport` should update the existing entry if it has no port set, and not add the second one. The problem is that if we always update the entry, you can't have two different providers on different ports.</div></div></div><br/>
<div><a id="1679523842.473139"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1679523842.473139" ><div class="time">2023-03-22 22:24</div></a><div class="msg">I need to think through "Don't create the default provider's transport at all". It was added to make the transport entries correspond to the deprecated fields. But maybe it should have a fallback to the deprecated fields, i.e., they are an implicit entry. But this may cause other issues.</div></div></div><br/>
<div><a id="1679532444.349589"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679532444.349589" ><div class="time">2023-03-23 00:47</div></a><div class="msg">Another idea from me is to create new ffi function `pactffi_v`er`ifier_set_provider_tr`ans`ports`  with json parameter for example</div></div></div><br/>
<div><a id="1679569186.632189"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679569186.632189" ><div class="time">2023-03-23 10:59</div></a><div class="msg">I think I need help with `verifying service method interaction with a gRPC server` <a href="https://github.com/pactflow/pact-protobuf-plugin#service-method-provider">https://github.com/pactflow/pact-protobuf-plugin#service-method-provider</a>

I choose to write unit test to verify instead of using `pact_verifier_cli` .

This part of the unit test:

```public function testPactVerifyConsumer()
    {
        $config = new VerifierConfig();
        $config-&gt;getProviderInfo()
            -&gt;setName('protobufProvider')
            -&gt;setHost('127.0.0.1')
            -&gt;setScheme('tcp')
            -&gt;setPort(9001);
        $providerTransport = new ProviderTransport();
        $providerTransport
            -&gt;setProtocol('grpc')
            -&gt;setScheme('tcp')
            -&gt;setPort(9001)
            -&gt;setPath('/')
        ;
        $config-&gt;addProviderTransport($providerTransport);
        if ($logLevel = \getenv('PACT_LOGLEVEL')) {
            $config-&gt;setLogLevel($logLevel);
        }

        $verifier = new Verifier($config);
        $verifier-&gt;addDirectory(__DIR__.'/../../../broker/pacts');

        $this-&gt;assertTrue($verifier-&gt;verify());
    }```
This is the output:

```Verifying a pact between protobufConsumer and protobufProvider

  request for calculate shape area (0s loading, 2ms verification)
      Request Failed - builder error for url (<tcp://127.0.0.1:9001>): URL scheme is not allowed


Failures:

1) Verifying a pact between protobufConsumer and protobufProvider - request for calculate shape area - builder error for url (<tcp://127.0.0.1:9001>): URL scheme is not allowed```
This is part of the log I think it's useful:
```2023-03-23T10:56:35.997068Z  INFO ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier: Running provider verification for 'request for calculate shape area'
2023-03-23T10:56:35.997099Z DEBUG ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier: Verifying a synchronous message (request/response)
2023-03-23T10:56:35.997212Z  INFO ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier::provider_client: Sending request to provider at <tcp://127.0.0.1:9001/>
2023-03-23T10:56:35.997230Z DEBUG ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier::provider_client: Provider details = ProviderInfo { name: "protobufProvider", protocol: "tcp", host: "127.0.0.1", port: Some(9001), path: "/", transports: [ProviderTransport { transport: "tcp", port: Some(9001), path: Some("/"), scheme: None }, ProviderTransport { transport: "grpc", port: Some(9001), path: Some("/"), scheme: Some("tcp") }] }
2023-03-23T10:56:35.997244Z  INFO ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier::provider_client: Sending request HTTP Request ( method: POST, path: /, query: None, headers: Some({"Content-Type": ["application/json"]}), body: Present(447 bytes, application/json) )
2023-03-23T10:56:35.997257Z DEBUG ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier::provider_client: body:
{"description":"request for calculate shape area","request":{"contents":{"content":"EgoNAABAQBUAAIBA","contentType":"application/protobuf;message=ShapeMessage","contentTypeHint":"BINARY","encoded":"base64"},"matchingRules":{"body":{"$.rectangle.length":{"combine":"AND","matchers":[{"match":"number"}]},"$.rectangle.width":{"combine":"AND","matchers":[{"match":"number"}]}}},"metadata":{"contentType":"application/protobuf;message=ShapeMessage"}}}
2023-03-23T10:56:35.997298Z DEBUG ThreadId(01) verify_interaction{interaction="request for calculate shape area"}: pact_verifier::provider_client: Native request builder: RequestBuilder { method: POST, url: Url { scheme: "tcp", cannot_be_a_base: false, username: "", password: None, host: Some(Domain("127.0.0.1")), port: Some(9001), path: "", query: None, fragment: None }, headers: {"content-type": "application/json"} ```
Do you know how to solve that error `URL scheme is not allowed` ?</div></div></div><br/>
<div><a id="1679573997.980049"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679573997.980049" ><div class="time">2023-03-23 12:19</div></a><div class="msg">After adding some more debug message and compiling `pact_ffi` , I see the real issue: `transport` is missing from pact file:

```{
  "consumer": {
    "name": "protobufConsumer"
  },
  "interactions": [
    {
      .................
      "transport": "grpc"
    }
  ],
  "provider": {
    "name": "protobufProvider"
  }
}```
How can I add this value to pact file?</div></div></div><br/>
<div><a id="1679576126.853179"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1679576126.853179" ><div class="time">2023-03-23 12:55</div></a><div class="msg">The transport should be in the pact file

<a href="https://github.com/pact-foundation/pact-reference/blob/9b1b7965f0b97a8c7d11f2d8bb6bbeaa5a79e482/php/pacts/grpc-consumer-php-area-calculator-provider.json#L70-L71">https://github.com/pact-foundation/pact-reference/blob/9b1b7965f0b97a8c7d11f2d8bb6bbeaa5a79e482/php/pacts/grpc-consumer-php-area-calculator-provider.json#L70-L71</a>

I also noted some odd behaviour with

`pactffi_verifier_set_provider_info`

&amp;

`pactffi_verifier_add_provider_transport`

I jotted some comments and experiments when trying to verify both a plugin pact (grpc) and http pact and trying to set the correct transports for both

```// ?
// This would be my preferrred option
// Set the provider name (which should be used by anything using the verifier_handle, and filter sourced pacts that don't contain name)
// add multiple transports.
// note pactffi_verifier_set_provider_name does not exist
// update_provider_info might work
// <a href="https://github.com/pact-foundation/pact-reference/blob/cfb2c03f87b3f67464291dd936d0aac555c42c91/rust/pact_ffi/src/verifier/handle.rs#L89">https://github.com/pact-foundation/pact-reference/blob/cfb2c03f87b3f67464291dd936d0aac555c42c91/rust/pact_ffi/src/verifier/handle.rs#L89</a>
// but is marked as deprecated.
 //
// also worthy of note, if pactffi_verifier_set_provider_info didn't mix with the information used in pactffi_verifier_add_provider_transport
 // this probably wouldn't be neccessary.
 $ffi-&gt;pactffi_verifier_set_provider_name($handle, 'http-provider'); // note this function doesn't exist (wishlist)
 $ffi-&gt;pactffi_verifier_add_provider_transport($handle, 'http',8000,'/','http');
$ffi-&gt;pactffi_verifier_add_provider_transport($handle, 'protobuf',37757,'/','tcp');```</div></div></div><br/>
<div><a id="1679576211.323619"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1679576211.323619" ><div class="time">2023-03-23 12:56</div></a><div class="msg">Looks related to your comments here <a href="https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1679503099374349">https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1679503099374349</a>

will take some time to go through them properly today</div></div></div><br/>
<div><a id="1679577916.162599"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679577916.162599" ><div class="time">2023-03-23 13:25</div></a><div class="msg">How can I forgot these valued comments. Let me check through them. Thanks</div></div></div><br/>
<div><a id="1679582026.783979"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679582026.783979" ><div class="time">2023-03-23 14:33</div></a><div class="msg">I found solution (based on your example): replace `pactffi_pact_handle_write_file` by `pactffi_write_pact_file` .

I think because mock server know what transport it's using (by calling `pactffi_create_mock_server_for_transport`), asking it to write pact file will have additional `transport` information.

I think this useful information should be mentioned somewhere , at least in the `pact.h` file?</div></div></div><br/>
<div><a id="1679582416.037839"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1679582416.037839" ><div class="time">2023-03-23 14:40</div></a><div class="msg">Ahhh fabulous, glad they were helpful to you, it was your PHP examples that helped me in the first place :smile:

I think capturing some of these thoughts maybe in

<a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/ARCHITECTURE.md">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/ARCHITECTURE.md</a>

or some kind of documentation for consumers of the FFI (being Authors/maintainers of pact client libraries)

I love the idea of the reference implementations which really strip away from the client libraries DSLs and show the raw FFI calls for particular scenarioes, which then are easier to translate across to other languages as there is a clear view on what methods/args/ordering is required for said feature</div></div></div><br/>
<div><a id="1679582537.071319"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1679582537.071319" ><div class="time">2023-03-23 14:42</div></a><div class="msg">or in the header file, tbh that is where I read most of the comments, however its harder to get too, as you have to get it from the releases pages.

It would also be cool if the pact.h was annotated with the ffi version that it is for, I don't think there is a version in it, so you rely on it being supplied with the shared lib (which the pact client libs take care off but more awk when your testing against diff ffi versions directly)</div></div></div><br/>
<div><a id="1679609216.408629"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1679609216.408629" ><div class="time">2023-03-23 22:06</div></a><div class="msg">Also, tcp is not a valid scheme `setScheme('tcp')`, it should be grpc.</div></div></div><br/>
<div><a id="1679615481.585449"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679615481.585449" ><div class="time">2023-03-23 23:51</div></a><div class="msg">&gt; tcp is not a valid scheme `setScheme('tcp')`, it should be grpc
I assume this note is for providerInfo part only. I removed it once I found solution above.</div></div></div><br/>
<div><a id="1679616504.101429"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1679616504.101429" ><div class="time">2023-03-24 00:08</div></a><div class="msg">Add a comment about `pactffi_write_pact_file` into the file <a href="https://github.com/pact-foundation/pact-reference/blob/php_plugins/php/src/consumer-plugin.php">https://github.com/pact-foundation/pact-reference/blob/php_plugins/php/src/consumer-plugin.php</a>, then create a PR to merge branch `php_plugins` into `master` is another option, but it's less obvious, and only for people who interest in reading PHP code only</div></div></div><br/>
<div><a id="1680573099.983959"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1680573099.983959" ><div class="time">2023-04-04 01:51</div></a><div class="msg">There are 5 official log levels mentioned in <a href="https://github.com/pact-foundation/pact-specification#logging-in-a-pact-library">https://github.com/pact-foundation/pact-specification#logging-in-a-pact-library</a>:
? Error
? Warn
? Info
? Debug
? Trace
To turn off log, there is another log level. But what is exactly its name?
? Stub Server (Rust) called it `none`  <a href="https://github.com/pact-foundation/pact-stub-server#command-line-interface">https://github.com/pact-foundation/pact-stub-server#command-line-interface</a>
? While Pact FFI (c header) called it `off` , as in `LevelFilter_Off`, <a href="https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.4.1/pact.h">https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.4.1/pact.h</a></div></div></div><br/>
<div><a id="1680573385.871439"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1680573385.871439" ><div class="time">2023-04-04 01:56</div></a><div class="msg">Turning off logging is not really a log level, it is a flag that you do not want any logging. TBH, I don't really see the value of it. Why would you not want to at least see if there is an error?</div></div></div><br/>
<div><a id="1680573996.196429"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1680573996.196429" ><div class="time">2023-04-04 02:06</div></a><div class="msg">Sorry I didn't ask about how it work. I just ask about naming because I saw inconsistent in the name. For now I think I can just ignore `none` and `off`</div></div></div><br/>
<div><a id="1680878609.287409"><img src="https://avatars.slack-edge.com/2023-04-07/5080715303556_616bd4370a68542f5472_72.png" /></a><div class="message"><div class="username">jan.krolikowski</div><a style="text-decoration: none" href="#1680878609.287409" ><div class="time">2023-04-07 14:43</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1681914313.388599"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1681914313.388599" ><div class="time">2023-04-19 14:25</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1683037785.422899"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683037785.422899" ><div class="time">2023-05-02 14:29</div></a><div class="msg">I'm trying to add v4 support to PactNet and I've got in a real mess when I try to use it for real at work. Not every pact will be upgraded to v4 at once (we can't enforce that), so we'll have a mix of:

? v2 pacts with HTTP interactions
? v3 pacts with HTTP interactions
? v3 pacts with message interactions
? v4 pacts with HTTP and/or message interactions
The verifier gets in a serious mess when this happens. It starts sending the HTTP requests to the `/pact-messages` endpoint as if they're async requests, which then fails because obviously those are in a completely different format to what's expected.

What am I supposed to do in that situation?</div></div></div><br/>
<div><a id="1683068142.438139"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683068142.438139" ><div class="time">2023-05-02 22:55</div></a><div class="msg">As in, you have a Pact file that has different versioned interactions in them? Or different consumers are on different versions of the pact spec?</div></div></div><br/>
<div><a id="1683097431.211569"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683097431.211569" ><div class="time">2023-05-03 07:03</div></a><div class="msg">The latter, yeah - some consumers have like v2 HTTP pacts and some have v4 pacts, but the verifier picks up the v2 pact and treats all the HTTP interactions like they're messaging interactions and hammers the provider with a bunch of invalid requests</div></div></div><br/>
<div><a id="1683098467.544359"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683098467.544359" ><div class="time">2023-05-03 07:21</div></a><div class="msg">ok that scenario makes sense to me, it sounds like it might be a bug then.</div></div></div><br/>
<div><a id="1683098495.216519"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683098495.216519" ><div class="time">2023-05-03 07:21</div></a><div class="msg">I?m just on a call, but later tonight I?ll see if I can repro in Go/JS or something</div></div></div><br/>
<div><a id="1683098538.512009"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683098538.512009" ><div class="time">2023-05-03 07:22</div></a><div class="msg">Yeah cool. I've started putting together a small example in C# as well, although having it in another language would be even better just to confirm it's not just the way I've implemented something</div></div></div><br/>
<div><a id="1683102775.834089"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683102775.834089" ><div class="time">2023-05-03 08:32</div></a><div class="msg">Looking through the code, I think this is to do with how I've implemented it, but in a way that I think might need a change in the FFI approach.

For messaging interactions, there needs to be a REST API running with a `/pact-messages` endpoint available which returns the message body when given a magic string.

That's really onerous to put that requirements on everyone using message pacts though, so instead PactNet includes a little API which starts transparently to the user and implements the `/pact-messages` endpoint.

The problem is that the FFI expects just one API which does both the 'real' endpoints _and_ the `pact-messages` one, but as I say the burden that places on the user isn't really workable.

So PactNet currently calls the `pactffi_verifier_set_provider_info` FFI method and points it at the little built-in messaging API. Problem is that this makes the FFI forward _all_ interactions there as if it's the real API.

I think it should work more like the provider states endpoint - when you call `pactffi_verifier_set_provider_state` you can pass in an absolute URL, so in theory the provider states endpoint could be on a totally different API running on a different port (or even a totally different host if you wanted to get crazy).

I could really do with a way of running a small built-in API on a different port to the main API and having all the `/pact-messages` calls sent over to that API instead. I can't really mandate that users have to implement that endpoint themselves on their 'normal' API, nor can I write something which adds it on for them.</div></div></div><br/>
<div><a id="1683102887.488899"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683102887.488899" ><div class="time">2023-05-03 08:34</div></a><div class="msg">That approach works fine in v3 messaging pacts btw, because v3 pacts can't contain both HTTP and messaging interactions, so even though HTTP interactions would get forwarded to the `/pact-messages` endpoint and break, in practice they don't because there never are any.</div></div></div><br/>
<div><a id="1683103011.806689"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683103011.806689" ><div class="time">2023-05-03 08:36</div></a><div class="msg">Oh and also it works fine because prior to v4 we mandated that anything using messaging had to have a different name, whereas from v4 we're allowing the same name for both HTTP and messaging interactions. From v4, hitting the pact broker for `Orders API` might give you back v2 HTTP, v3 HTTP and v4 HTTP+Messaging, which is what causes the problem with the in-built messaging handler API</div></div></div><br/>
<div><a id="1683103689.906889"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683103689.906889" ><div class="time">2023-05-03 08:48</div></a><div class="msg">So yeah, if there was some kind of `pactffi_verifier_set_messaging_endpoint` or something which you could provide with an absolute URL and it would call for all messaging interactions, that would solve the problem with consumers that have both HTTP and messaging interactions</div></div></div><br/>
<div><a id="1683104219.278499"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104219.278499" ><div class="time">2023-05-03 08:56</div></a><div class="msg">&gt; That's really onerous to put that requirements on everyone using message pacts though, so instead PactNet includes a little API which starts transparently to the user and implements the `/pact-messages` endpoint.
This sounds nice, I like your approach to the end user experience, it really showed in the migration from v3 -&gt; v4

Your proposal sounds sensible :slightly_smiling_face:

&gt; whereas from v4 we're allowing the same name for both HTTP and messaging interactions.
Yeah I actually haven't given that a whirl yet, but yeah that is a key feature

&gt; From v4, hitting the pact broker for `Orders API` might give you back v2 HTTP, v3 HTTP and v4 HTTP+Messaging, which is what causes the problem with the in-built messaging handler API
Yeah I assumed the pact verifier (whether via FFI or CLI) would just handle this, and therefore my recommendation would be to a user stuck on a v2 ruby-backed provider language but generating v3/v4 specs would be to use the verifier cli.

Obviously that  involves the user knowing more about the lifecycle and appropriate options, than it neatly wrapped up in the DSL

Appreciate you putting together the examples :slightly_smiling_face:</div></div></div><br/>
<div><a id="1683104268.226149"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683104268.226149" ><div class="time">2023-05-03 08:57</div></a><div class="msg">Nah, the verifier CLI would be broken in the same way</div></div></div><br/>
<div><a id="1683104271.330229"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104271.330229" ><div class="time">2023-05-03 08:57</div></a><div class="msg">I'll let Ron mull over the implementation detail, as I have many yaks to shave, but sounds good and will be awesome to see this in pact-net</div></div></div><br/>
<div><a id="1683104397.752019"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104397.752019" ><div class="time">2023-05-03 08:59</div></a><div class="msg">&gt; Nah, the verifier CLI would be broken in the same way
ty for confirming, no-one has mentioned it so far, although a few have mentioned it caused them pain in v3 and below, needing separate named providers for message pacts, I haven't heard anyone mention your comments, so you are probably bleeding edge, just as you had proper use case tests in production.

The team (PactFlow engineers) have been thinking about a way we can build up a set of examples for the core features (so v4 multi interaction would be one)</div></div></div><br/>
<div><a id="1683104430.624429"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104430.624429" ><div class="time">2023-05-03 09:00</div></a><div class="msg">this should help hopefully maintainers implement in a client, language, and for us hopefully to demonstrate the ffi method lifecycle in some reference implementation examples</div></div></div><br/>
<div><a id="1683104614.622419"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104614.622419" ><div class="time">2023-05-03 09:03</div></a><div class="msg">Yeah I mapped the level filter of none when I was playing around, but if a user didn't want logging, they wouldn't call the logger init or apply methods</div></div></div><br/>
<div><a id="1683104674.320289"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683104674.320289" ><div class="time">2023-05-03 09:04</div></a><div class="msg">&gt; TBH, I don't really see the value of it. Why would you not want to at least see if there is an error?
Agreed, you probably at least want errors as a minimum, otherwise might as well just send it to the `/dev/null` in the sky hehe</div></div></div><br/>
<div><a id="1683104898.948629"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683104898.948629" ><div class="time">2023-05-03 09:08</div></a><div class="msg">Say you have an API called `Orders API` with 2 endpoints:

? `POST /api/orders` for creating orders
? `GET /api/orders/{id}` for getting an order by ID
and when you create an order, it also sends out a pubsub message to say that an order has been created. That's your provider API.

Then you have 2 consumers:

? Basket API - this calls `POST /api/orders` to create the order when a user clicks Buy. It is a v2 or v3 pact with only HTTP interactions
? Fulfillment API - this listens to the pubsub topic for when orders are created, and calls the `GET /api/orders/{id}` endpoint to retrieve the new order details in order to trigger the actual shipping of the order. It's a v4 pact with both messaging and HTTP interactions inside
When the Orders API hits the pact broker to perform a verification, it'll get both of those pacts back and start trying to verify them. In order to do that, the Orders API _must_ have an endpoint called `/pact-messages` so that the verifier CLI/FFI can post a magic string to it and get a message body back.

The problem is that the real Orders API doesn't have that endpoint, because that's a testing implementation detail. So, instead we create a little built-in API which has that endpoint so the user doesn't have to, and that's running on a different port to the main Orders API.

This doesn't work though, either via the FFI or CLI, because you can only supply one URL. Either you give it the real Orders API URL, and then the messaging interactions fail because there's no `/pact-messages` endpoint, or you give it the messaging API URL, and then the regular HTTP interactions fail because it's just a little stub service for handling messaging stuff.

So what you really need is to be able to provide two different URLs. One for the 'real' API, where all the HTTP interactions should be sent, and one URL for all the messaging interactions to be handled (which may be different to the HTTP URL, but doesn't have to be).

In other languages you can probably monkey-patch the messaging endpoint onto the real API at test time from the test library itself, but you can't do that in quite a few languages. So either the library has to have a little built in API to handle them, or the user has to manually implement that endpoint (which is non-trivial).

That situation would've never happened with v3 pacts, because you can't have a pacticipant called `Orders API` which has both HTTP and messaging interactions. They'd have to have different names and be in different pacts files, but from v4 that same name can now contain both, and that's what necessitates something that can handle the two types differently.</div></div></div><br/>
<div><a id="1683109146.081469"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683109146.081469" ><div class="time">2023-05-03 10:19</div></a><div class="msg">I've just found `pactffi_verifier_add_provider_transport` which I _think_ can be used to do what I want above</div></div></div><br/>
<div><a id="1683110129.659309"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683110129.659309" ><div class="time">2023-05-03 10:35</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-reference/commit/9b1b7965f0b97a8c7d11f2d8bb6bbeaa5a79e482#diff-afeb3e0e20ecfe56b3d0f902c4b4665f9d626d59f87602daaaa7c07de3dba859">https://github.com/pact-foundation/pact-reference/commit/9b1b7965f0b97a8c7d11f2d8bb6bbeaa5a79e482#diff-afeb3e0e20ecfe56b3d0f902c4b4665f9d626d59f87602daaaa7c07de3dba859</a>

now you mention this, it brings back memories of when I first trialled out plugins with Tien's PHP example, there was some oddities, I scattered a brain dump in some code comments, and sure I posted about it somewhere but can't find the issue or slack message about it, popping out for lunch shortly</div></div></div><br/>
<div><a id="1683112195.182539"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683112195.182539" ><div class="time">2023-05-03 11:09</div></a><div class="msg">Yeah so I think adding a transport is the way it would be done, but to do that I'm going to have to make a breaking API change in PactNet no matter what I think. When you create the verifier for the example above then you need to add both a HTTP transport and a messaging transport, but the API of PactNet currently only allows you to do one or the other, because in v3 pacts it wasn't allowed to do both (and I didn't know v4 allowed it at the time I wrote it like a year ago)</div></div></div><br/>
<div><a id="1683282113.939749"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683282113.939749" ><div class="time">2023-05-05 10:21</div></a><div class="msg">@pact544 how did you config verifier to call `/pact-messages` endpoint to get messages to verify? it always call to `/` in my case. absolute path will be `<a href="http://my-provider.com/">http://my-provider.com/</a>` conpare to your `<a href="http://your-provider.com/pact-messages">http://your-provider.com/pact-messages</a>`</div></div></div><br/>
<div><a id="1683282304.736579"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683282304.736579" ><div class="time">2023-05-05 10:25</div></a><div class="msg">You can set a path on the FFI call :+1:</div></div></div><br/>
<div><a id="1683283049.946059"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683283049.946059" ><div class="time">2023-05-05 10:37</div></a><div class="msg">do you remember which FFI call is? I would like to know</div></div></div><br/>
<div><a id="1683284017.905829"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683284017.905829" ><div class="time">2023-05-05 10:53</div></a><div class="msg">&gt; I could really do with a way of running a small built-in API on a different port to the main API and having all the `/pact-messages` calls sent over to that API instead. I can?t really mandate that users have to implement that endpoint themselves on their ?normal? API, nor can I write something which adds it on for them.
You?re right, this is part of the guide we need to write for maintainers (this is how it?s done in both JS and Go, and how i?ve recommended others do it. We discussed a callback approach, but trust me (and more so Ron), it makes the FFI much more low level and running an HTTP service is just much simpler to do).</div></div></div><br/>
<div><a id="1683284078.944179"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683284078.944179" ><div class="time">2023-05-05 10:54</div></a><div class="msg">&gt; Yeah so I think adding a transport is the way it would be done, but to do that I?m going to have to make a breaking API change in PactNet no matter what I think. When you create the verifier for the example above then you need to add both a HTTP transport and a messaging transport, but the API of PactNet currently only allows you to do one or the other, because in v3 pacts it wasn?t allowed to do both (and I didn?t know v4 allowed it at the time I wrote it like a year ago)
Mind elaborating on why it would be a breaking change in the .NET DSL? In JS/Go, the REST API / proxy is completely transparent to the user. We just register one port for messages and another port for HTTP</div></div></div><br/>
<div><a id="1683284218.464269"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683284218.464269" ><div class="time">2023-05-05 10:56</div></a><div class="msg">&gt; I?ve just found `pactffi_verifier_add_provider_transport` which I _think_ can be used to do what I want above
yes, that?s the way around it. In fact, you?ll need to use this if you verify a plugin also because it will use a different scheme (e.g. `grpc`)</div></div></div><br/>
<div><a id="1683284253.526979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683284253.526979" ><div class="time">2023-05-05 10:57</div></a><div class="msg">This is why we are writing a maintainer guide! The raw ingredients (functions) are all there, but how you mix them together (the recipe) matters</div></div></div><br/>
<div><a id="1683284268.493389"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683284268.493389" ><div class="time">2023-05-05 10:57</div></a><div class="msg">Sorry for this confusion. It almost certainly would be in a thread in this channel, now long lost to history.</div></div></div><br/>
<div><a id="1683284418.700749"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683284418.700749" ><div class="time">2023-05-05 11:00</div></a><div class="msg">I've added an RFC to the PactNet channel to detail why this is a breaking change. I've got it working locally now though with that breaking change</div></div></div><br/>
<div><a id="1683284960.227069"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683284960.227069" ><div class="time">2023-05-05 11:09</div></a><div class="msg">There's both a set provider info call and an add transport call where you can specify a path. You always need to call the provider info one first because that gives you the handle you need for adding more transports</div></div></div><br/>
<div><a id="1683285039.501219"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683285039.501219" ><div class="time">2023-05-05 11:10</div></a><div class="msg">Ideally there'd be a separation between transports and provider info so you can create the handle and set the provider name in one call, then add the transports separately. That would make integrating much easier because otherwise you need loads of conditions in your code</div></div></div><br/>
<div><a id="1683286386.297609"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683286386.297609" ><div class="time">2023-05-05 11:33</div></a><div class="msg">Nice! I had a quick pass now, but it?s late and I?ve already had a negroni. I?ll review with fresh eyes next week, and also compare against JS/Go for inspo</div></div></div><br/>
<div><a id="1683286388.651599"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683286388.651599" ><div class="time">2023-05-05 11:33</div></a><div class="msg">have a great weekend!</div></div></div><br/>
<div><a id="1683286940.927139"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683286940.927139" ><div class="time">2023-05-05 11:42</div></a><div class="msg">Also, thanks Adam - I think this is all really helpful. We should include a section on this (setting up an intermediate API, how to set multiple transports etc.) in the maintainer guide we?re about to pick up, what do you think @uglyog?</div></div></div><br/>
<div><a id="1683290145.834189"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683290145.834189" ><div class="time">2023-05-05 12:35</div></a><div class="msg">I think you are talking about `pactffi_verifier_add_provider_transport` (set protocol to `message`). I think it's clever, I didn't think about this before. Let me try it. Thanks @pact544 :+1:</div></div></div><br/>
<div><a id="1683290283.461809"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683290283.461809" ><div class="time">2023-05-05 12:38</div></a><div class="msg">Yeah the problem is that the set provider info method requires that you supply a transport as well as the actual provider info, so if you're adding more than one transport then the first one needs to call set provider info, and any subsequent ones need to call the method you've referenced there.

It's a bit of an annoying interaction model to integrate with because whenever you're adding a transport then you need to know whether it's the first one or not, then call different methods depending on whether it's first or not.</div></div></div><br/>
<div><a id="1683290687.194769"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1683290687.194769" ><div class="time">2023-05-05 12:44</div></a><div class="msg">Oh and the argument of set provider info and add transport are in different orders with slightly different meanings :facepalm:</div></div></div><br/>
<div><a id="1683296559.248919"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683296559.248919" ><div class="time">2023-05-05 14:22</div></a><div class="msg">`pactffi_verifier_add_provider_transport` work really well to me :tada:

I'm not sure I'm fully understand your problem about order of calling those FFI methods (maybe because I always call `pactffi_verifier_set_provider_info` first so no problem for me?)

Anyway, I got another problem with those FFI calls that I asked here <a href="https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1679503099374349">https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1679503099374349</a>. Hope it can help.</div></div></div><br/>
<div><a id="1683296805.954979"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683296805.954979" ><div class="time">2023-05-05 14:26</div></a><div class="msg">This is also a useful information user/contributor want to know, maybe a document for it would be nice (if it's not documented somewhere) FYI @matt.fellows</div></div></div><br/>
<div><a id="1683440950.514139"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683440950.514139" ><div class="time">2023-05-07 06:29</div></a><div class="msg">Hi,
I am getting this error when i try to load the libpact_ffi.so in erlang vm that i got from pact_ffi release page:
```"No driver init in dynamic library"```
I have tried multiple ways to load the pact ffi shared library but getting errors similar to the above one, any help would be appreciated. Thanks in advance!</div></div></div><br/>
<div><a id="1683451778.091859"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683451778.091859" ><div class="time">2023-05-07 09:29</div></a><div class="msg">you need glue code in Erlang/rust for interoperability 

see this project for some examples

<a href="https://github.com/elitau/pact_elixir/blob/master/native/pactmockserver/src/lib.rs">https://github.com/elitau/pact_elixir/blob/master/native/pactmockserver/src/lib.rs</a>

search for erlang nif or erlang interoperability </div></div></div><br/>
<div><a id="1683451820.326539"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683451820.326539" ><div class="time">2023-05-07 09:30</div></a><div class="msg">this uses the mock server rather than the ffi tho</div></div></div><br/>
<div><a id="1683467069.939789"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683467069.939789" ><div class="time">2023-05-07 13:44</div></a><div class="msg">alright, it seems i have to wrap the already existing `<a href="http://lib.rs">http://lib.rs</a>` s too due to some type mismatches between rustler::nif and the implemented functions.</div></div></div><br/>
<div><a id="1683502281.395609"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1683502281.395609" ><div class="time">2023-05-07 23:31</div></a><div class="msg">Just reading through all this, a maintainer guide would be a way to describe how to deal with this problem.</div></div></div><br/>
<div><a id="1683506259.071129"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683506259.071129" ><div class="time">2023-05-08 00:37</div></a><div class="msg">Good timing then :wink:</div></div></div><br/>
<div><a id="1683506353.268059"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683506353.268059" ><div class="time">2023-05-08 00:39</div></a><div class="msg">Absolutely!</div></div></div><br/>
<div><a id="1683509528.502169"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683509528.502169" ><div class="time">2023-05-08 01:32</div></a><div class="msg">@matt.fellows now that i followed from what yousaf said, I need to use the pact crates and sort of export these functions as what is known as ?nif? in erlang. I did follow these:

1. <a href="https://medium.com/@brucifi/writing-your-first-erlang-nif-in-rust-274374094207">https://medium.com/@brucifi/writing-your-first-erlang-nif-in-rust-274374094207</a>
2. <a href="https://github.com/elitau/pact_elixir/blob/master/native/pactmockserver/src/lib.rs">https://github.com/elitau/pact_elixir/blob/master/native/pactmockserver/src/lib.rs</a>

After following article 1, i was able to build these crates, but when i introduced rustler:init! and rustler::nif macros, i am getting this:

```&lt;&lt;"code"&gt;&gt; =&gt;
                                  #{&lt;&lt;"code"&gt;&gt; =&gt; &lt;&lt;"E0277"&gt;&gt;,
                                    &lt;&lt;"explanation"&gt;&gt; =&gt;
                                        &lt;&lt;"You tried to use a type which doesn't implement some trait in a place which\nexpected that trait.\n\nErroneous code example:\n\n```compile_fail,E0277\n// here we declare the Foo trait with a bar method\ntrait Foo {\n    fn bar(&amp;self);\n}\n\n// we now declare a function which takes an object implementing the Foo trait\nfn some_func&lt;T: Foo&gt;(foo: T) {\n    foo.bar();\n}\n\nfn main() {\n    // we now call the method with the i32 type, which doesn't implement\n    // the Foo trait\n    some_func(5i32); // error: the trait bound `i32 : Foo` is not satisfied\n}\n```\n\nIn order to fix this error, verify that the type you're using does implement\nthe trait. Example:\n\n```\ntrait Foo {\n    fn bar(&amp;self);\n}\n\n// we implement the trait on the i32 type\nimpl Foo for i32 {\n    fn bar(&amp;self) {}\n}\n\nfn some_func&lt;T: Foo&gt;(foo: T) {\n    foo.bar(); // we can now use this method since i32 implements the\n               // Foo trait\n}\n\nfn main() {\n    some_func(5i32); // ok!\n}\n```\n\nOr in a generic context, an erroneous code example would look like:\n\n```compile_fail,E0277\nfn some_func&lt;T&gt;(foo: T) {\n    println!(\"{:?}\", foo); // error: the trait `core::fmt::Debug` is not\n                           //        implemented for the type `T`\n}\n\nfn main() {\n    // We now call the method with the i32 type,\n    // which *does* implement the Debug trait.\n    some_func(5i32);\n}\n```\n\nNote that the error here is in the definition of the generic function. Although\nwe only call it with a parameter that does implement `Debug`, the compiler\nstill rejects the function. It must work with all possible input types. In\norder to make this example compile, we need to restrict the generic type we're\naccepting:\n\n```\nuse std::fmt;\n\n// Restrict the input type to types that implement Debug.\nfn some_func&lt;T: fmt::Debug&gt;(foo: T) {\n    println!(\"{:?}\", foo);\n}\n\nfn main() {\n    // Calling the method is still fine, as i32 implements Debug.\n    some_func(5i32);\n\n    // This would fail to compile now:\n    // struct WithoutDebug;\n    // some_func(WithoutDebug);\n}\n```\n\nRust only looks at the signature of the called function, as such it must\nalready specify all requirements that will be used for every type parameter.\n"&gt;&gt;},
                              &lt;&lt;"level"&gt;&gt; =&gt; &lt;&lt;"error"&gt;&gt;,
                              &lt;&lt;"message"&gt;&gt; =&gt;
                                  &lt;&lt;"the trait bound `anyhow::Error: Encoder` is not satisfied"&gt;&gt;,```</div></div></div><br/>
<div><a id="1683509992.155059"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683509992.155059" ><div class="time">2023-05-08 01:39</div></a><div class="msg">In short I tried this:
```#[rustler::nif(name = "create_mock_server")]
pub fn create_mock_server(
  pact_json: &amp;str,
  addr: std::net::SocketAddr
) -&gt; anyhow::Result&lt;i32&gt; {```</div></div></div><br/>
<div><a id="1683510009.791789"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683510009.791789" ><div class="time">2023-05-08 01:40</div></a><div class="msg">but this seems to fail this cargo build process</div></div></div><br/>
<div><a id="1683510528.770019"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683510528.770019" ><div class="time">2023-05-08 01:48</div></a><div class="msg">Hmm I?m not sure having to write and compile rust is the best way to go, I seem to recall there being a different way now</div></div></div><br/>
<div><a id="1683510577.922349"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683510577.922349" ><div class="time">2023-05-08 01:49</div></a><div class="msg">hmm does any of the commentary in <a href="https://docs.pact.io/slack/pact-elixir.html">https://docs.pact.io/slack/pact-elixir.html</a> help?</div></div></div><br/>
<div><a id="1683510651.667799"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683510651.667799" ><div class="time">2023-05-08 01:50</div></a><div class="msg">Ah, still needed NIF but pre-built (which is good, it would suck that users need a rust runtime to run Elixir)</div></div></div><br/>
<div><a id="1683511156.554829"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683511156.554829" ><div class="time">2023-05-08 01:59</div></a><div class="msg">&gt; Hi all, here is an update on the current status of Elixir bindings as of October 2021, and the next steps for developing the library. *HIGH-LEVEL WORK TO BE DONE* The <a href="https://github.com/elitau/pact_elixir">https://github.com/elitau/pact_elixir</a> library is a community-built implementation of Pact in Elixir. Thank you to @pact-slack for the great work on this library so far! In order to make the library fully-featured, we have these general tasks to complete: ? Change the Elixir FFI implementation (see details below) ? Re-implement consumer-side mocks with new FFI ? Implement provider verification ? Implement messaging equivalents ? Implement other workflows like publishing and downloading pacts from a broker *FFI: PROBLEM AND CONSTRAINTS* The pact_elixir library currently uses a Elixir+Rust library called <a href="https://github.com/rusterlium/rustler">https://github.com/rusterlium/rustler</a> to create safe bindings between the Elixir wrapper and the Rust reference implementation of Pact. Rustler is a great library for creating interop between the two languages because it minimizes the risks of FFI. However, rustler requires the app developer to have a Rust toolchain installed, and to compile the core Rust code at the same time as the app and the pact_elixir library are compiled. This leads to more system dependencies and slower build performance. The developer should not need to know that the internals of pact_elixir are actually written in a different language. The Elixir and Erlang ecosystem has another FFI concept called NIFs, or Natively-Implemented Functions. Note that NIFs require special instrumentation of the native code in order to communicate properly with the Elixir bindings that are calling in. This does not seem like an ideal solution either, because it requires the pact_elixir library to maintain hand-written shim code in C to add this instrumentation. *FFI: NEXT STEPS* We intend to follow the same approach that pact-js and pact-go now follow: the pact_elixir library should download the FFI bundles for each OS architecture at library publish time, and then link to them using whatever strategy is most unobtrusive to the app developer. We can reuse the pipeline scripts from these other implementations in order to download the bundles. We need to pick an appropriate FFI strategy from the Elixir/Erlang ecosystem to allow a good developer experience. Rustler and handwritten NIF instrumentation do not seem to be good options. Erlang Ports or Port Drivers may be viable options. We may also be able to find a library to automatically *generate NIF bindings around the FFI bundles*, and if this is possible, this may be the best option. I am not very familiar with this part of the Elixir and Erlang ecosystem, so if anyone is more familiar with what is available, please share what you know! Once we have researched and picked the right FFI strategy, we can create the bindings and have a fully-featured Elixir implementation of Pact! *RESOURCES* ? <a href="https://github.com/elitau/pact_elixir">https://github.com/elitau/pact_elixir</a>: Elixir bindings for Pact, let?s focus our efforts to evolve this repo! ? <a href="https://hex.pm">https://hex.pm</a>: package manager for the ecosystem ? <a href="https://erlang.org/doc/tutorial/users_guide.html">https://erlang.org/doc/tutorial/users_guide.html</a>: Erlang Interoperability Tutorial User?s Guide, explains NIFs, ports, port drivers, etc. ? <a href="https://sudonull.com/post/97911-How-to-write-your-NIF-in-Elixir">https://sudonull.com/post/97911-How-to-write-your-NIF-in-Elixir</a>: Tutorial on writing NIFs. Note that the C code requires instrumentation, so hand-writing a NIF is likely not our best option.
Excuse the bad formatting, but this is where it seemed we landed</div></div></div><br/>
<div><a id="1683511207.189869"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683511207.189869" ><div class="time">2023-05-08 02:00</div></a><div class="msg">I read this as pre-compile NIFs and distribute those to users (to avoid users having to compile rust). So you might be on the right path.

It looks like some types need additional traits, which is why the compilation is failing</div></div></div><br/>
<div><a id="1683512695.666079"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683512695.666079" ><div class="time">2023-05-08 02:24</div></a><div class="msg">@matt.fellows that is what i was initially trying to do, load the pre compiled library (libpact_ffi.so or libpact_ffi.dylib) that the already implemented pact-python, pact-js-core has done, also in the examples in pact-reference pr. But it seems in erlang, it fails to load the library using
```erl_dll:load_driver/2```</div></div></div><br/>
<div><a id="1683513036.183579"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683513036.183579" ><div class="time">2023-05-08 02:30</div></a><div class="msg">even tried using
```erlang:load_nif/2 ```
but the same error comes as
```no driver init```</div></div></div><br/>
<div><a id="1683516243.394679"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1683516243.394679" ><div class="time">2023-05-08 03:24</div></a><div class="msg">sorry, unfortunately I have no experience in erlang/elixir so not sure how to guide you here!</div></div></div><br/>
<div><a id="1683520520.198579"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683520520.198579" ><div class="time">2023-05-08 04:35</div></a><div class="msg">Question to all pact ffi users: Does anyone got this similar errors while testing ffi implementation in Windows Server (from Github Actions)?

&gt; Script phpunit --debug -c example/phpunit.all.xml handling the test event returned with error code -1073741819</div></div></div><br/>
<div><a id="1683554496.297779"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683554496.297779" ><div class="time">2023-05-08 14:01</div></a><div class="msg">Here are some related logs:</div></div></div><br/>
<div><a id="1683554561.871539"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1683554561.871539" ><div class="time">2023-05-08 14:02</div></a><div class="msg">```thread '&lt;unnamed&gt;' panicked at 'called `Option::unwrap()` on a `None` value', C:\Users\runneradmin\.cargo\registry\src\github.com-1ecc6299db9ec823\tokio-1.27.0\src\runtime\scheduler\multi_thread\<a href="http://worker.rs:884:58">http://worker.rs:884:58</a>

note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

thread '&lt;unnamed&gt;' panicked at 'assertion failed: c.runtime.get().is_entered()', C:\Users\runneradmin\.cargo\registry\src\github.com-1ecc6299db9ec823\tokio-1.27.0\src\runtime\<a href="http://context.rs:292:17">http://context.rs:292:17</a>

thread '&lt;unnamed&gt;' panicked at 'called `Option::unwrap()` on a `None` value', Script phpunit --debug -c example/phpunit.all.xml handling the test event returned with error code -1073741819```
The error itself is quite random. And these logs are even more random. This is the second time I saw them. So not sure it's related to the error.</div></div></div><br/>
<div><a id="1683587973.855789"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1683587973.855789" ><div class="time">2023-05-08 23:19</div></a><div class="msg">`tokio-1.27.0\src\runtime\scheduler\multi_thread\<a href="http://worker.rs:884:58">http://worker.rs:884:58</a>`
That's in the Tokio runtime</div></div></div><br/>
<div><a id="1683624370.284819"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1683624370.284819" ><div class="time">2023-05-09 09:26</div></a><div class="msg">@srijan.c can you please help here</div></div></div><br/>
<div><a id="1683624379.010919"><img src="https://avatars.slack-edge.com/2023-03-24/5005942592803_715b2fcdfb556bb3cab7_72.jpg" /></a><div class="message"><div class="username">srijan.c</div><a style="text-decoration: none" href="#1683624379.010919" ><div class="time">2023-05-09 09:26</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1683625174.889209"><img src="https://avatars.slack-edge.com/2023-03-24/5005942592803_715b2fcdfb556bb3cab7_72.jpg" /></a><div class="message"><div class="username">srijan.c</div><a style="text-decoration: none" href="#1683625174.889209" ><div class="time">2023-05-09 09:39</div></a><div class="msg">load_nif/driver will not be able to load a random .so file. It needs to implement the functions expected by erlang interface.
You can write a wrapper layer in C that implements this interface.
<a href="https://www.erlang.org/doc/apps/erl_interface/ei_users_guide.html">https://www.erlang.org/doc/apps/erl_interface/ei_users_guide.html</a></div></div></div><br/>
<div><a id="1683628030.730059"><img src="https://avatars.slack-edge.com/2023-03-24/5005942592803_715b2fcdfb556bb3cab7_72.jpg" /></a><div class="message"><div class="username">srijan.c</div><a style="text-decoration: none" href="#1683628030.730059" ><div class="time">2023-05-09 10:27</div></a><div class="msg">Also <a href="https://www.erlang.org/doc/tutorial/nif.html">https://www.erlang.org/doc/tutorial/nif.html</a></div></div></div><br/>
<div><a id="1683797738.163149"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1683797738.163149" ><div class="time">2023-05-11 09:35</div></a><div class="msg">Did some sleuthing yesterday through `cargo.toml` files and some of the repos I know that consume the ffi.

Documented here <a href="https://github.com/pact-foundation/devrel/issues/10">https://github.com/pact-foundation/devrel/issues/10</a>

There may be more outside our wheelhouse, or some that I've missed

The pact-reference (rust) core</div></div></div><br/>
<div><a id="1684125645.478419"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684125645.478419" ><div class="time">2023-05-15 04:40</div></a><div class="msg">hi
there are some functions that are deprecated as per the pact_ffi documentation, but used in pact-reference repo in languages like python. For example:
```## Load pact into Mock Server and start
mock_server_port = lib.pactffi_create_mock_server(ffi.new("char[]", json.dumps(contents).encode('ascii')) , b'127.0.0.1:4432',0)
print(f"Mock server started: {mock_server_port}")```
`pactffi_create_mock_server` seems deprecated as per the pact_ffi documentation, should i be using this or the function thats mentioned in the documentation - `pactffi_create_mock_server_for_transport`  ?</div></div></div><br/>
<div><a id="1684126201.122609"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1684126201.122609" ><div class="time">2023-05-15 04:50</div></a><div class="msg">Use the mentioned function, the deprecated functions will be removed at some time in the future</div></div></div><br/>
<div><a id="1684160830.453099"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684160830.453099" ><div class="time">2023-05-15 14:27</div></a><div class="msg">the PactHandle that is returned by `pactffi_new_pact` is defined as this in the pact.h file:
`typedef uint16_t PactHandle;`

The problem is when i am calling `pactffi_create_mock_server_for_transport` with PactHandle as lets say 1 (`uint16_t` ) , it returns me -1 which means `An invalid handle was received. Handles should be created with pactffi_new_pact`

Am i missing something here? Thanks in advance

Edit: I am writing wrappers for these functions in C, so that I can then finally use Erlang NIFs to call these wrapper functions</div></div></div><br/>
<div><a id="1684161478.604099"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1684161478.604099" ><div class="time">2023-05-15 14:37</div></a><div class="msg">each time you call pactffi_new_pact you get an opaque pointer, which is an incrementing id reference, to a pointer held in pact_ffi's address space.

have you called `pactffi_new_pact` and passed the result (which is the interaction handle) to `pactffi_create_mock_server_for_transport`</div></div></div><br/>
<div><a id="1684161793.969019"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684161793.969019" ><div class="time">2023-05-15 14:43</div></a><div class="msg">I am first creating a new pact with `pactffi_new_pact` , then I am storing the returned value in my erlang code, then again invoking pact_ffi_new_interaction(PactHandle, Description) from my erlang code which then invokes my c code. My sample C code for pact_ffi_new_interaction looks like this:
```static ERL_NIF_TERM erl_pactffi_new_interaction(ErlNifEnv* env, int argc, const ERL_NIF_TERM argv[])
{
    unsigned int len1;
    enif_get_list_length(env, argv[1], &amp;len1);
    char *buf1 ; // This is my interaction description
    buf1 = (char *)malloc(len1 * sizeof(char));
    if (!enif_get_string(env, argv[1], buf1, sizeof(buf1), ERL_NIF_LATIN1)) {
        return enif_make_badarg(env);
    }
    int ip; // This is my PactHandle
    if (!enif_get_int(env, argv[0], &amp;ip)) {
        return enif_make_badarg(env);
    }
    PactHandle pacthandle = ip;
    InteractionHandle interactionhandle = pactffi_new_interaction(pacthandle, buf1);
    return enif_make_int(env, interactionhandle);
}```</div></div></div><br/>
<div><a id="1684161866.365739"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684161866.365739" ><div class="time">2023-05-15 14:44</div></a><div class="msg">I think i got your point, I will have to invoke the `pactffi_create_mock_server_for_transport`  from where I am creating the `pactffi_new_pact`  right ?</div></div></div><br/>
<div><a id="1684161995.558379"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684161995.558379" ><div class="time">2023-05-15 14:46</div></a><div class="msg">can i not fetch the pacthandle from that int that I am getting in return ?</div></div></div><br/>
<div><a id="1684164054.234149"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684164054.234149" ><div class="time">2023-05-15 15:20</div></a><div class="msg">okay, i changed the code to typecast the int to PactHandle which i was not doing earlier, now i am getting -3 (the code says mock server could not be started)</div></div></div><br/>
<div><a id="1684173786.816169"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684173786.816169" ><div class="time">2023-05-15 18:03</div></a><div class="msg">I enabled logging for ffi, it seems i was giving the wrong address unintentionally from my erlang code, thanks @yousafn</div></div></div><br/>
<div><a id="1684237263.210229"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1684237263.210229" ><div class="time">2023-05-16 11:41</div></a><div class="msg">saweet! yeah tip 1 always enable logging :)

</div></div></div><br/>
<div><a id="1684317163.186079"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684317163.186079" ><div class="time">2023-05-17 09:52</div></a><div class="msg">hi all, I was able to use the libpact_ffi library and wrote a C interface on top of that for my erlang code to use ! What do y?all think of this as a pact client for erlang

Example usage :
```%% pact-erlang (very pre-alpha phase right now)

%% Setup
PactRef = pact:create_new_pact(&lt;&lt;"consumer"&gt;&gt;, &lt;&lt;"producer"&gt;&gt;).
InteractionRef = pact:create_new_interaction(PactRef, &lt;&lt;"/users api desc"&gt;&gt;).
pact:insert_request_path(InteractionRef, &lt;&lt;"GET"&gt;&gt;, &lt;&lt;"/users"&gt;&gt;).
ResponseJsonString = jsx:encode(#{auth_id =&gt; 1}).
pact:insert_response_body(InteractionRef, &lt;&lt;"application/json"&gt;&gt;, ResponseJsonString).
pact:insert_response_status(InteractionRef, 200).
pact:create_mock_server(PactRef, &lt;&lt;"localhost"&gt;&gt;, 1234, &lt;&lt;"http"&gt;&gt;).

%% Sample test code
Users = user:get_users(),


%% Verify
assertEqual({ok, matched}, pact:verify_pact(1234)).


%% Write Pact File
pact:write_pact_file(PactRef, "/Users/priyaranjan.m/pacts", 0)

%% Cleanup test setup
pact:cleanup_pact_setup()```</div></div></div><br/>
<div><a id="1684317377.129799"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684317377.129799" ><div class="time">2023-05-17 09:56</div></a><div class="msg">1. Not a DSL as other languages have implemented, but I believe very much usable any erlang user who wants to use pact features.
2. Haven?t implemented matchers implementation in a module as of now, but I believe its something that can be used manually using integrationjson.md page </div></div></div><br/>
<div><a id="1684317622.554069"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684317622.554069" ><div class="time">2023-05-17 10:00</div></a><div class="msg">And this only uses the libpact_ffi.a and the pact.h which will be fetched from pact-reference release page, purely written in erlang and C</div></div></div><br/>
<div><a id="1684317855.980599"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684317855.980599" ><div class="time">2023-05-17 10:04</div></a><div class="msg">The C interface can also be used for elixir applications too, as elixir and erlang both support NIF</div></div></div><br/>
<div><a id="1684324137.286019"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684324137.286019" ><div class="time">2023-05-17 11:48</div></a><div class="msg">@matt.fellows this C interface will also solve the problem that you mentioned here in the pact-elixir thread <a href="https://docs.pact.io/slack/pact-elixir.html">https://docs.pact.io/slack/pact-elixir.html</a>:
&gt; As long as Elixr can speak a c interface (which it obviously can, because that is what Rustler ultimately does) and you can add a c compatible library to your package (which it sounds like you can), I?d strongly encourage you move away from having the need for rust on a target machine</div></div></div><br/>
<div><a id="1684366242.936839"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684366242.936839" ><div class="time">2023-05-17 23:30</div></a><div class="msg">Nice! I can?t speak too much for the Erlang idiomatics, but if the user of the package doesn?t need additional dependencies to compile and install native deps, just to run Erlang/Elixir code, then this is worth the effort.</div></div></div><br/>
<div><a id="1684366306.041409"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684366306.041409" ><div class="time">2023-05-17 23:31</div></a><div class="msg">I would encourage making fuctions for the matchers etc., because they are so fundamental</div></div></div><br/>
<div><a id="1684366338.432729"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684366338.432729" ><div class="time">2023-05-17 23:32</div></a><div class="msg">the `insert_&lt;fn&gt;` is a bit different to DSLs in the other languages, i?d encourage you to take a look at the latest .NET / JVM / JS / Go to get an idea</div></div></div><br/>
<div><a id="1684395747.755889"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684395747.755889" ><div class="time">2023-05-18 07:42</div></a><div class="msg">do you think dsl type syntax is neede here also, or only the naming that needs to change (from insert_&lt;fn&gt; to for example with_request()) ?</div></div></div><br/>
<div><a id="1684395822.552319"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684395822.552319" ><div class="time">2023-05-18 07:43</div></a><div class="msg">@matt.fellows yes the user will not need any external dependency like rust / rustler.</div></div></div><br/>
<div><a id="1684473316.295279"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684473316.295279" ><div class="time">2023-05-19 05:15</div></a><div class="msg">I?m more interested in keeping the naming of functions similar to other languages. As the vast majority of examples out there today won?t be elixir/erlang, anybody searching for examples of how to do X might encounter e.g. JS, so it?s important they can have some familiarity as the move between languages</div></div></div><br/>
<div><a id="1684750942.190699"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684750942.190699" ><div class="time">2023-05-22 10:22</div></a><div class="msg">what exactly is the difference between these two ffi lib functions
`pactffi_new_interaction` <a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/handles/fn.pactffi_new_interaction.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/handles/fn.pactffi_new_interaction.html</a> and this
`pactffi_given`
<a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/handles/fn.pactffi_given.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/handles/fn.pactffi_given.html</a></div></div></div><br/>
<div><a id="1684750975.322239"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684750975.322239" ><div class="time">2023-05-22 10:22</div></a><div class="msg">both introduces description to the interaction ?</div></div></div><br/>
<div><a id="1684751001.888439"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1684751001.888439" ><div class="time">2023-05-22 10:23</div></a><div class="msg">or is that the pactffi_given is for only introducing provider state description ?</div></div></div><br/>
<div><a id="1684752603.660139"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684752603.660139" ><div class="time">2023-05-22 10:50</div></a><div class="msg">There was some reason for needing it in C++</div></div></div><br/>
<div><a id="1684752610.732019"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1684752610.732019" ><div class="time">2023-05-22 10:50</div></a><div class="msg">You can set the description from either method, though</div></div></div><br/>
<div><a id="1684795394.445319"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1684795394.445319" ><div class="time">2023-05-22 22:43</div></a><div class="msg">The way C++ constructors work, you can't pass the description in when the handle is created, so it has to be added later.</div></div></div><br/>
<div><a id="1684795448.498939"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1684795448.498939" ><div class="time">2023-05-22 22:44</div></a><div class="msg">`pactffi_new_interaction` creates a new integration and sets the description. It is probably what you want to do.</div></div></div><br/>
<div><a id="1685361321.197149"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1685361321.197149" ><div class="time">2023-05-29 11:55</div></a><div class="msg">Sharing this because Tim is an awesome guy (I met him as a fellow speaker at a conference last year and he's genuinely a great human being) and I thought it would be relevant for anyone looking to learn that and get their hands dirty in the rust core: <a href="https://www.linkedin.com/posts/timmcnamaranz_if-youve-been-considering-my-free-how-to-activity-7068880463381098496-GFmS?utm_source=share&amp;utm_medium=member_android">https://www.linkedin.com/posts/timmcnamaranz_if-youve-been-considering-my-free-how-to-activity-7068880463381098496-GFmS?utm_source=share&amp;utm_medium=member_android</a></div></div></div><br/>
<div><a id="1687522915.434649"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687522915.434649" ><div class="time">2023-06-23 12:21</div></a><div class="msg">Calling all new and existing maintainers. One of the items raised has been the lack of a comprehensive maintainer guide, to help newcomers and even existing maintainers understand how to navigate the ecosystem, implement the FFI and know the ?definition of done?.

I?ve put together a draft ToC of a maintainer guide here :point_right: <a href="https://github.com/pact-foundation/docs.pact.io/pull/270">https://github.com/pact-foundation/docs.pact.io/pull/270</a>

Feedback welcome :slightly_smiling_face:

_--_

_You can see the deploy preview here: <a href="https://deploy-preview-270--docs-pact-io.netlify.app/implementation_guides/maintainer">https://deploy-preview-270--docs-pact-io.netlify.app/implementation_guides/maintainer</a>_</div></div></div><br/>
<div><a id="1687775217.796539"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1687775217.796539" ><div class="time">2023-06-26 10:26</div></a><div class="msg">Has there been any progress in separating out setting provider info (like the provider name) and adding the transports in FFI? iirc this is a blocker to releasing PactNet with proper v4 support</div></div></div><br/>
<div><a id="1687777090.856349"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687777090.856349" ><div class="time">2023-06-26 10:58</div></a><div class="msg">hello! Is there a related issue (I know there was a few threads on this and may have missed it)? If you wouldn?t mind raising one, we can get it looked into in the next few weeks</div></div></div><br/>
<div><a id="1687779116.973189"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687779116.973189" ><div class="time">2023-06-26 11:31</div></a><div class="msg">These debug logs for req/responses are much nicer @uglyog!

```2023-06-26T11:29:54.651109Z DEBUG tokio-runtime-worker pact_mock_server::hyper_server:
      ----------------------------------------------------------------------------------------
       method: GET
       path: /product/10
       query: None
       headers: Some({"accept": ["application/json", "text/plain", "*/*"], "user-agent": ["axios/0.27.2"], "authorization": ["Bearer 2023-06-26T11:29:54.591Z"], "connection": ["close"], "host": ["127.0.0.1:52291"]})
       body: Empty
      ----------------------------------------------------------------------------------------```</div></div></div><br/>
<div><a id="1687779122.664359"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687779122.664359" ><div class="time">2023-06-26 11:32</div></a><div class="msg">They stand out so much more</div></div></div><br/>
<div><a id="1687788844.631859"><img src="https://avatars.slack-edge.com/2022-02-04/3042827452823_04aefaa8271d55360355_72.jpg" /></a><div class="message"><div class="username">pact544</div><a style="text-decoration: none" href="#1687788844.631859" ><div class="time">2023-06-26 14:14</div></a><div class="msg">*Splitting provider info and transports*

The `pact_verifier_set_provider_info` FFI call (<a href="https://github.com/pact-foundation/pact-reference/blob/a3c5db598d18d174fbe53f9293b73820b7793d34/rust/pact_ffi/src/verifier/mod.rs#L142-L157">https://github.com/pact-foundation/pact-reference/blob/a3c5db598d18d174fbe53f9293b73820b7793d34/rust/pact_ffi/src/verifier/mod.rs#L142-L157</a> ) includes adding a default transport when setting up the verifier, but this makes integrating with the FFI awkward for libraries.

Since Pact Spec v4, a pact file can now contain both HTTP and message interactions, and this is implemented by adding a transport for both HTTP and messaging via `pact_verifier_add_provider_transport` (<a href="https://github.com/pact-foundation/pact-reference/blob/a3c5db598d18d174fbe53f9293b73820b7793d34/rust/pact_ffi/src/verifier/mod.rs#L173-L186">https://github.com/pact-foundation/pact-reference/blob/a3c5db598d18d174fbe53f9293b73820b7793d34/rust/pact_ffi/src/verifier/mod.rs#L173-L186</a>). The problem is that when the user is setting up a verifier, they want to specify 3 things:

? The provider name
? The HTTP endpoint
? The messaging endpoint
The FFI forces them to treat those as two things instead of three though, because specifying the provider name forces you to supply a transport. This creates an awkward API because there are three possible combinations for setting up a verifier:

? HTTP only
? Messaging only
? Both HTTP and messaging
Plus in future there may also be plugin-based transports, which creates a combinatorial explosion.

You can kinda deal with this in library code by either storing the name up and only adding it once the user has either specified HTTP or messaging, or you can check if you've already added a transport when you add subsequent ones and call different FFI methods. That's what PactNet does <a href="https://github.com/pact-foundation/pact-net/blob/feat/verifier-refactor/src/PactNet/Verifier/PactVerifier.cs#L73-L82">https://github.com/pact-foundation/pact-net/blob/feat/verifier-refactor/src/PactNet/Verifier/PactVerifier.cs#L73-L82</a>

That's an awkward thing that every library developer has to implement though, and they may implement them differently. Instead I'd prefer if the FFI allowed you to specify the provider info without having to specify a transport, and then initialising the verifier and adding the transports are separated and easy to integrate with.</div></div></div><br/>
<div><a id="1687820754.839319"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1687820754.839319" ><div class="time">2023-06-26 23:05</div></a><div class="msg">Good point. The `pact_verifier_set_provider_info` predates the changes required to support multiple ports and protocols for the same provider. It should be deprecated and a replacement added.</div></div></div><br/>
<div><a id="1687823626.738539"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687823626.738539" ><div class="time">2023-06-26 23:53</div></a><div class="msg">Thanks Adam, created: <a href="https://github.com/pact-foundation/pact-reference/issues/297">https://github.com/pact-foundation/pact-reference/issues/297</a></div></div></div><br/>
<div><a id="1687823693.946359"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1687823693.946359" ><div class="time">2023-06-26 23:54</div></a><div class="msg">On the topic of changes to the FFI and RFC, what are your thoughts on where this documentation change should go? Perhaps it?s a good opportunity to try something out.</div></div></div><br/>
<div><a id="1690792502.351319"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1690792502.351319" ><div class="time">2023-07-31 08:35</div></a><div class="msg">Hi @matt.fellows @yousafn
I have a scenario where i created a new pact using a Consumer and a provider, created an interaction and then started the mock server for it.
When we cleanup a pact mock server, and again start the pact mock server using <a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_cleanup_mock_server.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_cleanup_mock_server.html</a> and <a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_create_mock_server_for_transport.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_create_mock_server_for_transport.html</a> respectively, does that account for the last interaction that i added ?</div></div></div><br/>
<div><a id="1690804442.461259"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1690804442.461259" ><div class="time">2023-07-31 11:54</div></a><div class="msg">are you asking if the interaction added before starting the mock server, persists after calling pact_cleanup_mock_servers?</div></div></div><br/>
<div><a id="1690805985.226049"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1690805985.226049" ><div class="time">2023-07-31 12:19</div></a><div class="msg">yes</div></div></div><br/>
<div><a id="1690807686.486219"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1690807686.486219" ><div class="time">2023-07-31 12:48</div></a><div class="msg">Having a quick look at the rust code, I don?t think the interactionHandle or PactHandle is cleared, I would need to test, by shutting down a mock server and then starting it against by passing it the same PactHandle</div></div></div><br/>
<div><a id="1690807799.443319"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1690807799.443319" ><div class="time">2023-07-31 12:49</div></a><div class="msg">I did this:
1. created new pact -&gt; generated a new pact handle
2. created new interaction -&gt; generated a new interaction handle
3. Added request and response with this interaction handle
4. started the mock server for this pact handle
5. successfully executed the api and verified it and also called the mock server cleanup function (<a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_cleanup_mock_server.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_cleanup_mock_server.html</a>)
6. Repeated steps 2,3,4. In step 5, execution of api is successful, but verification fails because it also expects me to execute the previous interaction. For verification i have used this - <a href="https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_mock_server_matched.html">https://docs.rs/pact_ffi/latest/pact_ffi/mock_server/fn.pactffi_mock_server_matched.html</a></div></div></div><br/>
<div><a id="1690808048.075709"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1690808048.075709" ><div class="time">2023-07-31 12:54</div></a><div class="msg">the PactHandle and InteractionHandle?s are opaque pointers, so numbers 1,2,3 etc.

You may need to generate a new PactHandle and then InteractionHandle, or clear the setup Interaction with `pactffi_pact_interaction_delete` for your existing `PactHandle` post calling `pactffi_mock_server_matched` (and processing any mismatches)

I?d need to check some other impls and see what they do</div></div></div><br/>
<div><a id="1690808147.151379"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1690808147.151379" ><div class="time">2023-07-31 12:55</div></a><div class="msg">looks like there is `pactffi_pact_model_delete` for deleting the PactHandle I believe</div></div></div><br/>
<div><a id="1690866350.451739"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1690866350.451739" ><div class="time">2023-08-01 05:05</div></a><div class="msg">OK, looking at the code in JS, we actually recreate the `Pact` handle for each individual interaction, using the `pactffi_new_pact` method.

@uglyog is this the intended behaviour?</div></div></div><br/>
<div><a id="1690866903.557879"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1690866903.557879" ><div class="time">2023-08-01 05:15</div></a><div class="msg">PactHandle was not designed to be reused</div></div></div><br/>
<div><a id="1690867052.181769"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1690867052.181769" ><div class="time">2023-08-01 05:17</div></a><div class="msg">Thanks. This will be useful to add to the developer docs.

I reckon a mermaid diagram with a state chart would be super nice here!</div></div></div><br/>
<div><a id="1690876972.999129"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1690876972.999129" ><div class="time">2023-08-01 08:02</div></a><div class="msg">@matt.fellows yes, will be very helpful for someone who is developing pact client for other languages</div></div></div><br/>
<div><a id="1690877115.719349"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1690877115.719349" ><div class="time">2023-08-01 08:05</div></a><div class="msg">thanks a lot everyone for the help though !!</div></div></div><br/>
<div><a id="1690877403.947289"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1690877403.947289" ><div class="time">2023-08-01 08:10</div></a><div class="msg">no worries</div></div></div><br/>
<div><a id="1690877430.734049"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1690877430.734049" ><div class="time">2023-08-01 08:10</div></a><div class="msg">also thanks for raising, I just realised that the V4 interface in Pact JS _doesn?t_ do what I said the V3 interface does (and have just fixed it).</div></div></div><br/>
<div><a id="1692696267.778879"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1692696267.778879" ><div class="time">2023-08-22 09:24</div></a><div class="msg">Did anyone use `pactffi_with_multipart_file`  before? Do you know how to use it properly?</div></div></div><br/>
<div><a id="1692696366.946609"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1692696366.946609" ><div class="time">2023-08-22 09:26</div></a><div class="msg">I got this weird behavior:

&gt; 2023-08-22T09:18:48.367683Z DEBUG tokio-runtime-worker pact_matching: --&gt; Mismatches: [BodyMismatch { path: "$", expected: Some(b"testing"), actual: Some(b"testing"), mismatch: "MIME part 'personal_note': Unable to match 'testing' using ContentType(\"text/plain\")" }]</div></div></div><br/>
<div><a id="1693331224.474999"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1693331224.474999" ><div class="time">2023-08-29 17:47</div></a><div class="msg">```2023-08-29T17:30:54.852187Z DEBUG ThreadId(03) pact_matching::matchers: String -&gt; String: comparing 'testing' to 'testing' ==&gt; false cascaded=false matcher=ContentType("text/plain")```</div></div></div><br/>
<div><a id="1693368389.342409"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1693368389.342409" ><div class="time">2023-08-30 04:06</div></a><div class="msg">Trace log:

```2023-08-30T03:24:34.450933Z DEBUG ThreadId(03) matches_with{self="testing" actual="testing" matcher=ContentType("text/plain") cascaded=false}: pact_matching::matchers: String -&gt; String: comparing 'testing' to 'testing' ==&gt; false cascaded=false matcher=ContentType("text/plain")
2023-08-30T03:24:34.450936Z TRACE ThreadId(03) pact_matching::matchers: match_values: &amp;str -&gt; &amp;str result=Err(["Unable to match 'testing' using ContentType(\"text/plain\")"])
2023-08-30T03:24:34.450941Z DEBUG ThreadId(03) pact_matching::binary_utils: Comparing file part 'MimeFile { index: 2, name: "personal_note", content_type: Some("text/plain"), filename: "note.txt", data: b"testing", headers: {"content-disposition": "form-data; name=\"personal_note\"; filename=\"note.txt\"", "content-type": "text/plain"} }' to 'MimeFile { index: 2, name: "personal_note", content_type: Some("text/plain"), filename: "note.txt", data: b"testing", headers: {"content-disposition": "form-data; name=\"personal_note\"; filename=\"note.txt\"", "content-length": "7", "content-type": "text/plain"} }' at path '$.personal_note' -&gt; BodyMismatches({"$": [BodyMismatch { path: "$", expected: Some(b"testing"), actual: Some(b"testing"), mismatch: "Unable to match 'testing' using ContentType(\"text/plain\")" }]})```</div></div></div><br/>
<div><a id="1693368520.410979"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1693368520.410979" ><div class="time">2023-08-30 04:08</div></a><div class="msg">`testing` is not equals to `testing` . Sound like a bug to me. What do you think @uglyog ?</div></div></div><br/>
<div><a id="1693369939.880909"><img src="https://avatars.slack-edge.com/2019-08-26/740232217414_014b213119f6e40fa572_72.jpg" /></a><div class="message"><div class="username">uglyog</div><a style="text-decoration: none" href="#1693369939.880909" ><div class="time">2023-08-30 04:32</div></a><div class="msg">hmm, yeah</div></div></div><br/>
<div><a id="1693371694.575039"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1693371694.575039" ><div class="time">2023-08-30 05:01</div></a><div class="msg">I created an issue for it here <a href="https://github.com/pact-foundation/pact-reference/issues/318">https://github.com/pact-foundation/pact-reference/issues/318</a></div></div></div><br/>
<div><a id="1693803322.465879"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1693803322.465879" ><div class="time">2023-09-04 04:55</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1693868969.528359"><img src="https://avatars.slack-edge.com/2022-03-16/3276608670112_9fee6763b76f698d610d_72.jpg" /></a><div class="message"><div class="username">jonatan.jaworski</div><a style="text-decoration: none" href="#1693868969.528359" ><div class="time">2023-09-04 23:09</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1693875994.615029"><img src="https://avatars.slack-edge.com/2022-03-16/3276608670112_9fee6763b76f698d610d_72.jpg" /></a><div class="message"><div class="username">jonatan.jaworski</div><a style="text-decoration: none" href="#1693875994.615029" ><div class="time">2023-09-05 01:06</div></a><div class="msg">Hi team! I'm getting the following error when trying to run tests that use Pactnet (v5.0.0-beta.1) in a docker container using a dotnet 6 alpine image (<a href="http://mcr.microsoft.com/dotnet/sdk:6.0-alpine">http://mcr.microsoft.com/dotnet/sdk:6.0-alpine</a>):
``` Error Message:
   System.DllNotFoundException : Unable to load shared library 'pact_ffi' or one of its dependencies. In order to help diagnose loading problems, consider setting the LD_DEBUG environment variable: Error loading shared library libpact_ffi: No such file or directory```
There are no apk packages for `libpact_ffi` as far as I know, do you know what I could be missing here?</div></div></div><br/>
<div><a id="1693876717.072129"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1693876717.072129" ><div class="time">2023-09-05 01:18</div></a><div class="msg">I don?t think we support alpine, because shared library support on Alpine is tricky. To do that, would need to build a shared library for each version of musl and detect it at install time.</div></div></div><br/>
<div><a id="1693876738.681749"><img src="https://avatars.slack-edge.com/2022-03-16/3276608670112_9fee6763b76f698d610d_72.jpg" /></a><div class="message"><div class="username">jonatan.jaworski</div><a style="text-decoration: none" href="#1693876738.681749" ><div class="time">2023-09-05 01:18</div></a><div class="msg">Ouch. Fair enough</div></div></div><br/>
<div><a id="1693876747.016729"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1693876747.016729" ><div class="time">2023-09-05 01:19</div></a><div class="msg">mm</div></div></div><br/>
<div><a id="1693876760.780179"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1693876760.780179" ><div class="time">2023-09-05 01:19</div></a><div class="msg">There is a musl target released here, so you _could_ try it: <a href="https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.4.8">https://github.com/pact-foundation/pact-reference/releases/tag/libpact_ffi-v0.4.8</a></div></div></div><br/>
<div><a id="1693876784.433219"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1693876784.433219" ><div class="time">2023-09-05 01:19</div></a><div class="msg">But it could die in ways that are hard to describe in advance</div></div></div><br/>
<div><a id="1693876827.387009"><img src="https://avatars.slack-edge.com/2022-03-16/3276608670112_9fee6763b76f698d610d_72.jpg" /></a><div class="message"><div class="username">jonatan.jaworski</div><a style="text-decoration: none" href="#1693876827.387009" ><div class="time">2023-09-05 01:20</div></a><div class="msg">It's all good. If there are no plans to support Alpine I should probably just move away from it.</div></div></div><br/>
<div><a id="1693876926.562519"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1693876926.562519" ><div class="time">2023-09-05 01:22</div></a><div class="msg">Yeah, it would be recommended. We could probably make that more clear on <a href="http://docs.pact.io">http://docs.pact.io</a>. I?ll find a space for it. Any thoughts?

`glibc` is much better for shared libraries, because it?s API is backwards compatible forever. So we can build against an old version of `glibc` and know it will work on any distribution that contains that early version or any later one.

_(Just about to pop out for an appointment, but will check ^^ when I?m back)_</div></div></div><br/>
<div><a id="1693876937.877699"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1693876937.877699" ><div class="time">2023-09-05 01:22</div></a><div class="msg">Try a Debian based image if you can</div></div></div><br/>
<div><a id="1694432501.607279"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1694432501.607279" ><div class="time">2023-09-11 11:41</div></a><div class="msg">Created a pull request for it <a href="https://github.com/pact-foundation/pact-reference/pull/319">https://github.com/pact-foundation/pact-reference/pull/319</a></div></div></div><br/>
<div><a id="1695926833.910029"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1695926833.910029" ><div class="time">2023-09-28 18:47</div></a><div class="msg">:wave::skin-tone-4: - Is anyone familiar with this error?  I cant replicate but a colleague has this on an M1 machine locally when running pact verifications tests.  I'm curious as to why the reason suggests it's look for the dylib in places where I dont necessarily expect.
```dyld[10799]: Library not loaded: libpact_ffi.dylib
  Referenced from: &lt;71696BE6-E884-368C-9BB5-72CEEC86D657&gt; /private/var/folders/c6/3v5whjln5kgb0mwyjl8djklh0000gn/T/go-build482239365/b001/contracts.test
  Reason: tried: 'libpact_ffi.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibpact_ffi.dylib' (no such file), 'libpact_ffi.dylib' (no such file), '/Users/redacted/integrations/tests/contracts/libpact_ffi.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/Users/redacted/integrations/tests/contracts/libpact_ffi.dylib' (no such file), '/Users/redacted/integrations/tests/contracts/libpact_ffi.dylib' (no such file) ```</div></div></div><br/>
<div><a id="1695926999.343859"><img src="https://avatars.slack-edge.com/2022-06-08/3641985330595_c13084492ddd51522418_72.jpg" /></a><div class="message"><div class="username">hazem</div><a style="text-decoration: none" href="#1695926999.343859" ><div class="time">2023-09-28 18:49</div></a><div class="msg">we install using this command
```go install <a href="http://github.com/pact-foundation/pact-go/v2@latest">http://github.com/pact-foundation/pact-go/v2@latest</a> &amp;&amp; pact-go -v -l DEBUG install -f```
which results in something like this:
```2023/09/28 10:49:47 [INFO] downloading library from <a href="https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.4.5/libpact_ffi-osx-aarch64-apple-darwin.dylib.gz">https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v0.4.5/libpact_ffi-osx-aarch64-apple-darwin.dylib.gz</a> to /usr/local/lib/libpact_ffi.dylib
&amp;{}
2023/09/28 10:49:49 [DEBUG] obtaining hash for file /usr/local/lib/libpact_ffi.dylib
2023/09/28 10:49:49 [DEBUG] writing config {map[libpact_ffi:{libpact_ffi 0.4.5 15f5d7aee4067c48ef9dd1c25479157d}]}
2023/09/28 10:49:49 [DEBUG] writing yaml config to file libraries:
  libpact_ffi:
    libname: libpact_ffi
    version: 0.4.5
    hash: 15f5d7aee4067c48ef9dd1c25479157d

2023/09/28 10:49:49 [INFO] setting install_name on library libpact_ffi for osx
2023/09/28 10:49:49 [DEBUG] output from command []
2023/09/28 10:49:49 [INFO] package libpact_ffi found
2023/09/28 10:49:49 [INFO] checking version 0.4.5 of libpact_ffi against semver constraint &gt;= 0.4.0, &lt; 1.0.0
2023/09/28 10:49:49 [DEBUG] 0.4.5 satisfies constraints 0.4.5 &gt;= 0.4.0, &lt; 1.0.0
2023/09/28 10:49:49 [INFO] package libpact_ffi is correctly installed
2023/09/28 10:49:49 [DEBUG] skip checking ffi version() call because FFI not loaded. This is expected when running the 'pact-go' command.```
</div></div></div><br/>
<div><a id="1697032990.681329"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697032990.681329" ><div class="time">2023-10-11 14:03</div></a><div class="msg">This scenario <a href="https://github.com/pact-foundation/pact-compatibility-suite/blob/main/features/V1/http_consumer.feature">https://github.com/pact-foundation/pact-compatibility-suite/blob/main/features/V1/http_consumer.feature</a> doesn't look right to me.

```Scenario: Request with a binary body (negative case)
    When the mock server is started with interaction 7
    And request 7 is made to the mock server with the following changes:
      | body             |
      | file: spider.jpg |
    Then a 500 error response is returned
    And the mismatches will contain a "body" mismatch with error "Actual body [image/jpeg, 30922 bytes, starting with ffd8ffe000104a46494600010101004800480000ffe100ae4578696600004949] is not equal to the expected body [image/jpeg, 28058 bytes, starting with ffd8ffe000104a46494600010101012c012c0000ffe12db64578696600004949]"```
According to document of <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1508C89-L1509C43">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1508C89-L1509C43</a>:

&gt; Will use a mime type matcher to match the body.
I think the content of the binary file doesn't matter. If we change the content of the binary file, as long as the mime type doesn't change (image/jpeg), the mock server shouldn't consider this as a mismatch . The response code should be 200, not 500.</div></div></div><br/>
<div><a id="1697062141.969139"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1697062141.969139" ><div class="time">2023-10-11 22:09</div></a><div class="msg">That's a V1 scenario, which is not using any matching rules. Matching rules are added as part of V2, and the content type matcher is V3.</div></div></div><br/>
<div><a id="1697074139.290009"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697074139.290009" ><div class="time">2023-10-12 01:28</div></a><div class="msg">:facepalm2: I didn't think about it</div></div></div><br/>
<div><a id="1697074266.821099"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697074266.821099" ><div class="time">2023-10-12 01:31</div></a><div class="msg">:thinking_face: I did select the specification v1, but the response code is 200, not 500 as expected. Not sure what cause it</div></div></div><br/>
<div><a id="1697077895.750529"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697077895.750529" ><div class="time">2023-10-12 02:31</div></a><div class="msg">&gt; <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1508C89-L1509C43">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/src/mock_server/handles.rs#L1508C89-L1509C43</a>:
I _think_ this is V3 only, right Ron? It?s what adds the matcher Ron?s talking about.

In V1 (and V2), you wouldn?t use this function directly.</div></div></div><br/>
<div><a id="1697077905.080499"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697077905.080499" ><div class="time">2023-10-12 02:31</div></a><div class="msg">(please confirm that is correct Ron)</div></div></div><br/>
<div><a id="1697080048.036399"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1697080048.036399" ><div class="time">2023-10-12 03:07</div></a><div class="msg">Yes</div></div></div><br/>
<div><a id="1697107037.999259"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697107037.999259" ><div class="time">2023-10-12 10:37</div></a><div class="msg">I only see 2 options to set the body of the request:
? `pactffi_with_body`
?  `pactffi_with_binary_file`
If I can't use `pactffi_with_binary_file` , so `pactffi_with_body` is the only option.

Does `pactffi_with_body` support binary?</div></div></div><br/>
<div><a id="1697469208.154389"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697469208.154389" ><div class="time">2023-10-16 15:13</div></a><div class="msg">I don't think `pactffi_with_body`  support binary. So I updated `pactffi_with_binary_file` to add matching rule conditionally <a href="https://github.com/pact-foundation/pact-reference/pull/327">https://github.com/pact-foundation/pact-reference/pull/327</a></div></div></div><br/>
<div><a id="1697519999.604809"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697519999.604809" ><div class="time">2023-10-17 05:19</div></a><div class="msg">I think there is a way to pass binary data to the other method</div></div></div><br/>
<div><a id="1697520906.275759"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697520906.275759" ><div class="time">2023-10-17 05:35</div></a><div class="msg">The definition of `pactffi_with_body` accepts binary in the `body` attribute
```bool pactffi_with_body(InteractionHandle interaction,
                       enum InteractionPart part,
                       const char *content_type,
                       const char *body);```</div></div></div><br/>
<div><a id="1697520982.979859"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697520982.979859" ><div class="time">2023-10-17 05:36</div></a><div class="msg">In Pact Go, this is used for all body types, including binary. i.e. you can pass byte arrays to this type</div></div></div><br/>
<div><a id="1697521108.929499"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1697521108.929499" ><div class="time">2023-10-17 05:38</div></a><div class="msg">The main problem is that the type for the body is `const char *` which can't have any zero bytes in it and must be ended with a NULL terminator</div></div></div><br/>
<div><a id="1697521351.408429"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697521351.408429" ><div class="time">2023-10-17 05:42</div></a><div class="msg">Ask me how I know that?

(not sure why I made that a TODO)</div></div></div><br/>
<div><a id="1697521397.344599"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697521397.344599" ><div class="time">2023-10-17 05:43</div></a><div class="msg">j/k, the C interface method description explains this:

```...
 * # Safety
 *
 * The content type must be a valid UTF-8 encoded NULL-terminated string. The body pointer must
 * be valid for reads of `size` bytes, and it must be properly aligned and consecutive.
...```</div></div></div><br/>
<div><a id="1697522078.617189"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1697522078.617189" ><div class="time">2023-10-17 05:54</div></a><div class="msg">That's the description for `pactffi_with_binary_file`</div></div></div><br/>
<div><a id="1697522462.367999"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697522462.367999" ><div class="time">2023-10-17 06:01</div></a><div class="msg">I might have an old/outdated copy of the `pact.h` vendored in the go repo (it?s not linked to code, but there as a reference. Perhaps it should be removed now)</div></div></div><br/>
<div><a id="1697529845.718749"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697529845.718749" ><div class="time">2023-10-17 08:04</div></a><div class="msg">This is the message I got when using `pactffi_with_body` with binary string:

```2023-10-14T02:55:28.212556Z TRACE ThreadId(01) pact_ffi::mock_server::handles: &gt;&gt;&gt; pactffi_with_body(InteractionHandle { interaction_ref: 65537 }, Request, 0x7f0658eb9360, 0x7f0658f24018)
2023-10-14T02:55:28.212564Z  WARN ThreadId(01) pact_ffi: Failed to parse body name as a UTF-8 string: invalid utf-8 sequence of 1 bytes from index 0```
This is why I think it doesn't support binary string. Sorry I forgot to mention it.</div></div></div><br/>
<div><a id="1697531259.672499"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697531259.672499" ><div class="time">2023-10-17 08:27</div></a><div class="msg">How are you calling it?</div></div></div><br/>
<div><a id="1697539683.753079"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697539683.753079" ><div class="time">2023-10-17 10:48</div></a><div class="msg">I'm not sure I understand the question.</div></div></div><br/>
<div><a id="1697542770.207569"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1697542770.207569" ><div class="time">2023-10-17 11:39</div></a><div class="msg">i think Matt means what arguments are you passing to the function, when you get the failure above </div></div></div><br/>
<div><a id="1697545167.607189"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697545167.607189" ><div class="time">2023-10-17 12:19</div></a><div class="msg">Here is the example code <a href="https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:binary-example">https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:binary-example</a></div></div></div><br/>
<div><a id="1697545191.542169"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697545191.542169" ><div class="time">2023-10-17 12:19</div></a><div class="msg">```$ffi-&gt;pactffi_with_body($interaction, $ffi-&gt;InteractionPart_Response, 'image/jpeg', file_get_contents(__DIR__ . '/../../compatibility-suite/pact-compatibility-suite/fixtures/spider.jpg'));```</div></div></div><br/>
<div><a id="1697545207.419139"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1697545207.419139" ><div class="time">2023-10-17 12:20</div></a><div class="msg">&gt; 2023-10-17T12:16:40.733118Z  WARN ThreadId(01) pact_ffi: Failed to parse body name as a UTF-8 string: invalid utf-8 sequence of 1 bytes from index 0</div></div></div><br/>
<div><a id="1697545860.393609"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1697545860.393609" ><div class="time">2023-10-17 12:31</div></a><div class="msg">ty for the simple reproducer, I will take a look later today after the workshop and see what behaviour</div></div></div><br/>
<div><a id="1697545939.632059"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1697545939.632059" ><div class="time">2023-10-17 12:32</div></a><div class="msg">I think PHP FFI?s interface should add the NULL terminator - some lang?s dont such as deno

<a href="https://github.com/YOU54F/deno-pact/blob/dbe83e74311263cf93621106803a3468e8e17a95/src/lib/safe-ffi.ts#L20-L24">https://github.com/YOU54F/deno-pact/blob/dbe83e74311263cf93621106803a3468e8e17a95/src/lib/safe-ffi.ts#L20-L24</a></div></div></div><br/>
<div><a id="1697546067.120869"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1697546067.120869" ><div class="time">2023-10-17 12:34</div></a><div class="msg">as its fine with reading with the content type which is also the same type `const char *`</div></div></div><br/>
<div><a id="1697579025.353549"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1697579025.353549" ><div class="time">2023-10-17 21:43</div></a><div class="msg">&gt; Failed to parse body name 
that?s a bit confusing, what?s ?name? in this context. Might need to improve that error message</div></div></div><br/>
<div><a id="1698024646.805679"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024646.805679" ><div class="time">2023-10-23 01:30</div></a><div class="msg">I'm trying to match header/query to contain multiple values using ffi call but it doesn't work as I expected.</div></div></div><br/>
<div><a id="1698024661.692909"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024661.692909" ><div class="time">2023-10-23 01:31</div></a><div class="msg">For header, see this thread</div></div></div><br/>
<div><a id="1698024666.918839"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024666.918839" ><div class="time">2023-10-23 01:31</div></a><div class="msg">For query, see this thread</div></div></div><br/>
<div><a id="1698024707.051369"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024707.051369" ><div class="time">2023-10-23 01:31</div></a><div class="msg">FFI call:

```pactffi_with_header_v2($interactionId, $ffi->InteractionPart_Response, 'X-IMPROVED', 0, '{"value":["like","regex","values","arrayContaining"],"pact:matcher:type":"values"}');```</div></div></div><br/>
<div><a id="1698024738.074959"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024738.074959" ><div class="time">2023-10-23 01:32</div></a><div class="msg">Trimmed pact file:

```{
  "consumer": {
    "name": "matchersConsumer"
  },
  "interactions": [
    {
      "description": "A get request to /matchers",
      "request": {},
      "response": {
        "body": {},
        "headers": {
          "X-IMPROVED": [
            "like",
            "regex",
            "values",
            "arrayContaining"
          ]
        },
        "matchingRules": {
          "header": {
            "$['X-IMPROVED']": {
              "combine": "AND",
              "matchers": [
                {
                  "match": "values"
                }
              ]
            }
          }
        },
        "status": 200
      },
      "transport": "http",
      "type": "Synchronous/HTTP"
    }
  ],
  "metadata": {
    "pactSpecification": {
      "version": "4.0"
    }
  },
  "provider": {
    "name": "matchersProvider"
  }
}```</div></div></div><br/>
<div><a id="1698024763.372209"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024763.372209" ><div class="time">2023-10-23 01:32</div></a><div class="msg">Provider's response header:

```X-IMPROVED: regex, like, values, arrayContaining```</div></div></div><br/>
<div><a id="1698024790.710609"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698024790.710609" ><div class="time">2023-10-23 01:33</div></a><div class="msg">Weird message from provider's verifier:

```Failures:

1) Verifying a pact between matchersConsumer and matchersProvider Given Get Matchers - A get request to /matchers
    1.1) includes header 'X-IMPROVED' with value 'like'
           Expected header 'X-IMPROVED' to have value 'like' but was 'like'
           Expected header 'X-IMPROVED' to have value 'regex' but was 'regex'
           Expected header 'X-IMPROVED' to have value 'values' but was 'values'
           Expected header 'X-IMPROVED' to have value 'arrayContaining' but was 'arrayContaining'```</div></div></div><br/>
<div><a id="1698025840.681229"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698025840.681229" ><div class="time">2023-10-23 01:50</div></a><div class="msg">FFI call:

``````
pactffi_with_query_parameter_v2($interactionId, 'pages', 0, '{"value":"1","regex":"\\d+","pact:matcher:type":"regex"}');
``````
</div></div></div><br/>
<div><a id="1698025862.753219"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698025862.753219" ><div class="time">2023-10-23 01:51</div></a><div class="msg">Http client query:

```?pages=2&amp;pages=3```</div></div></div><br/>
<div><a id="1698025883.338799"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698025883.338799" ><div class="time">2023-10-23 01:51</div></a><div class="msg">Trimmed logs about matching rule:

```2023-10-23T01:46:59.767978Z DEBUG tokio-runtime-worker pact_matching:      matching_rules: MatchingRules { rules: {QUERY: MatchingRuleCategory { name: QUERY, rules: {DocPath { path_tokens: [Root, Field("pages"), Index(0)], expr: "$.pages[0]" }: RuleList { rules: [Regex("\\d+")], rule_logic: And, cascaded: false }} }} }```</div></div></div><br/>
<div><a id="1698025912.204289"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698025912.204289" ><div class="time">2023-10-23 01:51</div></a><div class="msg">Logs about mismatches:

```2023-10-23T01:46:59.768473Z DEBUG tokio-runtime-worker pact_matching: --&gt; Mismatches: [QueryMismatch { parameter: "pages", expected: "", actual: "3", mismatch: "Expected query parameter 'pages' with value '' but was '3'" }, QueryMismatch { parameter: "pages", expected: "[\"1\"]", actual: "[\"2\", \"3\"]", mismatch: "Expected query parameter 'pages' with 1 value(s) but received 2 value(s)" }]```</div></div></div><br/>
<div><a id="1698026005.990809"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698026005.990809" ><div class="time">2023-10-23 01:53</div></a><div class="msg">Note: I expect *every values* of `pages` are integer, *not* the *first* value.

But I think there are no way to make `pactffi_with_query_parameter_v2` ignore the index `0` ,just like how `pactffi_with_header_v2` did:

&gt; NOTE: If you pass in a form with multiple values, the index will be ignored.</div></div></div><br/>
<div><a id="1698099140.625439"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698099140.625439" ><div class="time">2023-10-23 22:12</div></a><div class="msg">What are you trying to achieve here? That any of the provided values must be present, but in any order?</div></div></div><br/>
<div><a id="1698099236.340269"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698099236.340269" ><div class="time">2023-10-23 22:13</div></a><div class="msg">This is the problem `expr: "$.pages[0]"`, there is no way with the FFI params to specify `*` instead of 0</div></div></div><br/>
<div><a id="1698111950.360179"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698111950.360179" ><div class="time">2023-10-24 01:45</div></a><div class="msg">How about updating `pactffi_with_query_parameter_v2` to allow something like this (change value from string to array):
```pactffi_with_query_parameter_v2($interactionId, 'pages', 0, '{"value":["1", "2", ["3"]],"regex":"\\d+","pact:matcher:type":"regex"}');```
then it ignore the  index `0`</div></div></div><br/>
<div><a id="1698112150.592409"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698112150.592409" ><div class="time">2023-10-24 01:49</div></a><div class="msg">yes, but let ignore the order for now.

I provided the values exactly as expected, in the same order, why I still see that error?

Plus, the error is trying to say that 2 exact same string are not equals? e.g. `'like' is not equals to 'like'` ?</div></div></div><br/>
<div><a id="1698116405.143859"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698116405.143859" ><div class="time">2023-10-24 03:00</div></a><div class="msg">That is really odd</div></div></div><br/>
<div><a id="1698116500.817979"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698116500.817979" ><div class="time">2023-10-24 03:01</div></a><div class="msg">I have never tested `"match": "values"` with headers. It doesn't make much sense using that, as it sets up a type matcher, and headers are all the same type (strings)</div></div></div><br/>
<div><a id="1698116542.113799"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698116542.113799" ><div class="time">2023-10-24 03:02</div></a><div class="msg">A regex matcher makes more sense</div></div></div><br/>
<div><a id="1698116587.234149"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698116587.234149" ><div class="time">2023-10-24 03:03</div></a><div class="msg">But it does seem to be a bug</div></div></div><br/>
<div><a id="1698116761.406989"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698116761.406989" ><div class="time">2023-10-24 03:06</div></a><div class="msg">If we are allowed to use matchers like `values` or `arrayContaining`  for headers, then I will report this bug.

If we are NOT allowed, then I think we need a way to prevent this from happening, and show some other errors instead.

btw, I will report the bug for now.</div></div></div><br/>
<div><a id="1698117668.302519"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698117668.302519" ><div class="time">2023-10-24 03:21</div></a><div class="msg">Here is the ticket <a href="https://github.com/pact-foundation/pact-reference/issues/331">https://github.com/pact-foundation/pact-reference/issues/331</a></div></div></div><br/>
<div><a id="1698118499.727699"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698118499.727699" ><div class="time">2023-10-24 03:34</div></a><div class="msg">Can you raise a ticket for it?</div></div></div><br/>
<div><a id="1698118614.010109"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698118614.010109" ><div class="time">2023-10-24 03:36</div></a><div class="msg">sure</div></div></div><br/>
<div><a id="1698119403.089429"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698119403.089429" ><div class="time">2023-10-24 03:50</div></a><div class="msg">Here is the ticket <a href="https://github.com/pact-foundation/pact-reference/issues/332">https://github.com/pact-foundation/pact-reference/issues/332</a></div></div></div><br/>
<div><a id="1698119487.293739"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698119487.293739" ><div class="time">2023-10-24 03:51</div></a><div class="msg">Thank you!</div></div></div><br/>
<div><a id="1698285936.158219"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698285936.158219" ><div class="time">2023-10-26 02:05</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md</a>

Is it true that:
? Any matcher can be used with any generator, no restriction?
? Any matcher can have any example value, no restriction (as long as the example value can be JSON encoded)?</div></div></div><br/>
<div><a id="1698287795.910339"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698287795.910339" ><div class="time">2023-10-26 02:36</div></a><div class="msg">&gt;  Any matcher can be used with any generator, no restriction?
Technically, yes, but they should compliment each other, otherwise they won't be useful. For instance if you set a regex matcher with `\d+` and a DateTime generator, that will not make much sense because the generated values will be different to the regex. However, a regex matcher with `\d+` and a RandomInt generator will work well.</div></div></div><br/>
<div><a id="1698287910.426229"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698287910.426229" ><div class="time">2023-10-26 02:38</div></a><div class="msg">&gt; Any matcher can have any example value, no restriction (as long as the example value can be JSON encoded)?
The example values should represent what the matcher is matching. In the customer facing DSL, this should be validated.</div></div></div><br/>
<div><a id="1698291926.886739"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698291926.886739" ><div class="time">2023-10-26 03:45</div></a><div class="msg">Thanks Ron</div></div></div><br/>
<div><a id="1698291938.614809"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698291938.614809" ><div class="time">2023-10-26 03:45</div></a><div class="msg">&gt;  The example values should represent what the matcher is matching. In the customer facing DSL, this should be validated.</div></div></div><br/>
<div><a id="1698291983.873869"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698291983.873869" ><div class="time">2023-10-26 03:46</div></a><div class="msg">If I understand correctly, this suggestion is quite opposite with this suggestion from Matt <a href="https://pact-foundation.slack.com/archives/C9VBGLUM9/p1690516277135829?thread_ts=1690472580.471449&amp;cid=C9VBGLUM9">https://pact-foundation.slack.com/archives/C9VBGLUM9/p1690516277135829?thread_ts=1690472580.471449&amp;cid=C9VBGLUM9</a></div></div></div><br/>
<div><a id="1698295285.430359"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698295285.430359" ><div class="time">2023-10-26 04:41</div></a><div class="msg">Yes, because the DSL layer (what is exposed to the user) has the context on what is trying to be done. The backend Rust API does not have that context, so how can it know whether one matcher is not the correct one to use with another generator.</div></div></div><br/>
<div><a id="1698295442.139549"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698295442.139549" ><div class="time">2023-10-26 04:44</div></a><div class="msg">If you have a DSL function `integer(100)`, you can know that the regex matcher `\d+` and RandomInt generator is correct, but the RandomDecimal one is not correct. The backend Rust functions won't know that the operation is about integers.</div></div></div><br/>
<div><a id="1698733243.985279"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698733243.985279" ><div class="time">2023-10-31 06:20</div></a><div class="msg">Because of regex validation, I can't register the `interaction #1` in <a href="https://github.com/pact-foundation/pact-compatibility-suite/blob/main/features/V2/http_consumer.feature#L8">https://github.com/pact-foundation/pact-compatibility-suite/blob/main/features/V2/http_consumer.feature#L8</a> because of this exception (from pact-php):

&gt; The pattern \w{3}\d{3} is not valid for value a. Failed with error code 0. (PhpPact\Consumer\Matcher\Exception\InvalidRegexException)</div></div></div><br/>
<div><a id="1698977883.875819"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698977883.875819" ><div class="time">2023-11-03 02:18</div></a><div class="msg">I think the simple solution is to provide a way to disable regex validation during running compatibility suite</div></div></div><br/>
<div><a id="1698978605.939589"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978605.939589" ><div class="time">2023-11-03 02:30</div></a><div class="msg">Use `eachValue` matcher for query parameter. See this thread for more details:</div></div></div><br/>
<div><a id="1698978654.440569"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978654.440569" ><div class="time">2023-11-03 02:30</div></a><div class="msg">Use `regex` matcher with array of values to match multiple values for query parameter works fine. See this thread <a href="https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1698024666918839">https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1698024666918839</a></div></div></div><br/>
<div><a id="1698978692.637529"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978692.637529" ><div class="time">2023-11-03 02:31</div></a><div class="msg">But when I replace `regex` by `eachValue` matcher, it doesn't work as I expected:</div></div></div><br/>
<div><a id="1698978797.532899"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978797.532899" ><div class="time">2023-11-03 02:33</div></a><div class="msg">Client DSL:

```- 'locales[]' =&gt; [
-     json_encode($this-&gt;matcher-&gt;regex(['en-US'], '^[a-z]{2}-[A-Z]{2}$')),
- ],
+ 'locales[]' =&gt; [
+     json_encode($this-&gt;matcher-&gt;eachValue(['en-US'], [$this-&gt;matcher-&gt;regex(null, '^[a-z]{2}-[A-Z]{2}$')])),
+ ],```
</div></div></div><br/>
<div><a id="1698978810.212079"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978810.212079" ><div class="time">2023-11-03 02:33</div></a><div class="msg">FFI call:

```pactffi_with_query_parameter_v2($interactionId, 'locales[]', 0, '"{"rules":[{"regex":"^[a-z]{2}-[A-Z]{2}$","pact:matcher:type":"regex","pact:generator:type":"Regex"}],"value":["en-US"],"pact:matcher:type":"eachValue"}"');```</div></div></div><br/>
<div><a id="1698978852.316809"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978852.316809" ><div class="time">2023-11-03 02:34</div></a><div class="msg">Http client's query:

```locales[]=en-US&amp;locales[]=en-AU```</div></div></div><br/>
<div><a id="1698978872.399099"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698978872.399099" ><div class="time">2023-11-03 02:34</div></a><div class="msg">Log:

```2023-10-28T07:21:35.888456Z DEBUG tokio-runtime-worker pact_matching::matchers: String -&gt; String: comparing 'en-US' to 'en-US' ==&gt; false cascaded=false matcher=EachValue(MatchingRuleDefinition { value: "[\"en-US\"]", value_type: Unknown, rules: [Left(Regex("^[a-z]{2}-[A-Z]{2}$"))], generator: None })
2023-10-28T07:21:35.888506Z DEBUG tokio-runtime-worker pact_matching::matchers: String -&gt; String: comparing '' to 'en-AU' ==&gt; false cascaded=false matcher=EachValue(MatchingRuleDefinition { value: "[\"en-US\"]", value_type: Unknown, rules: [Left(Regex("^[a-z]{2}-[A-Z]{2}$"))], generator: None })
2023-10-28T07:21:35.888576Z DEBUG tokio-runtime-worker pact_matching: --&gt; Mismatches: [QueryMismatch { parameter: "locales[]", expected: "en-US", actual: "en-US", mismatch: "Unable to match 'en-US' using EachValue(MatchingRuleDefinition { value: \"[\\\"en-US\\\"]\", value_type: Unknown, rules: [Left(Regex(\"^[a-z]{2}-[A-Z]{2}$\"))], generator: None })" }, QueryMismatch { parameter: "locales[]", expected: "", actual: "en-AU", mismatch: "Unable to match '' using EachValue(MatchingRuleDefinition { value: \"[\\\"en-US\\\"]\", value_type: Unknown, rules: [Left(Regex(\"^[a-z]{2}-[A-Z]{2}$\"))], generator: None })" }]```</div></div></div><br/>
<div><a id="1698979377.504719"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698979377.504719" ><div class="time">2023-11-03 02:42</div></a><div class="msg">Is it just the example value that is not correct? Can we fix that in the suite, or is it a PHP issue?</div></div></div><br/>
<div><a id="1698979507.995569"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1698979507.995569" ><div class="time">2023-11-03 02:45</div></a><div class="msg">If we change the regex to `\\w{1,3}\\d{0,3}` it should then work. There may be lots of other issues like that.</div></div></div><br/>
<div><a id="1698979956.695709"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698979956.695709" ><div class="time">2023-11-03 02:52</div></a><div class="msg">The problem is: I think compatibility suite is built with pact-rust in mind. This is one example. In pact-rust, we can simply set the regex matcher, no need to validate the value with it.

In pact-php (and probably in other languages), we need to validate the value first before setting the regex matcher.

I don't think updating `compatibility suite`  is a good idea for now. Just add a simple condition to `pact-php` and call it a day.</div></div></div><br/>
<div><a id="1698980611.664139"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698980611.664139" ><div class="time">2023-11-03 03:03</div></a><div class="msg">To test generators in compatibility suite, I have to use <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md</a>. But there are some difficulties:
? `pact:generator:type` is only optional, `pact:matcher:type` is still required
? Set `pact:matcher:type` to `null` or `integer` is the easiest way
? If I set `pact:matcher:type` to something like `type` , I need to also set `value` , which prevent `pact:generator:type` from working
? But I got these errors `Could not generate a random decimal from null`
? Other generator like `date` , `time` , `datetime` or `boolean` works fine because they don't validate the `value`
? Is this change a good idea: <a href="https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:force-generator-works-regardless-value-type?expand=1">https://github.com/pact-foundation/pact-reference/compare/master...tienvx:pact-reference:force-generator-works-regardless-value-type?expand=1</a> </div></div></div><br/>
<div><a id="1698980715.307769"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1698980715.307769" ><div class="time">2023-11-03 03:05</div></a><div class="msg">Is this a bug?</div></div></div><br/>
<div><a id="1699010717.486569"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1699010717.486569" ><div class="time">2023-11-03 11:25</div></a><div class="msg">I found a very similar block of code here <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_models/src/generators/mod.rs#L854">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_models/src/generators/mod.rs#L854</a>, so I think it's fine to do like that as well.</div></div></div><br/>
<div><a id="1699011023.417669"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1699011023.417669" ><div class="time">2023-11-03 11:30</div></a><div class="msg">Created PR anyway <a href="https://github.com/pact-foundation/pact-reference/pull/335">https://github.com/pact-foundation/pact-reference/pull/335</a></div></div></div><br/>
<div><a id="1699575326.308689"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1699575326.308689" ><div class="time">2023-11-10 00:15</div></a><div class="msg">`EachValue` was written to support ignoring the keys in a map like structure in the body. Only really for JSON objects. It will probably not work with anything else.</div></div></div><br/>
<div><a id="1699575346.420589"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1699575346.420589" ><div class="time">2023-11-10 00:15</div></a><div class="msg">`EachKey` is the same</div></div></div><br/>
<div><a id="1699581324.493269"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1699581324.493269" ><div class="time">2023-11-10 01:55</div></a><div class="msg">Sorry to revive an old thread, but I've also run across the same issue (which suggests we might need to update the Rust FFI docs, or the FFI itself).

I naively tried to also use the `with_binary_file` to pass byte arrays which are invalid UTF-8 sequences. I think it might be worth tracking in a ticket on GitHub (which I'm starting to write now).</div></div></div><br/>
<div><a id="1699583871.376039"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1699583871.376039" ><div class="time">2023-11-10 02:37</div></a><div class="msg">Link to issue: <a href="https://github.com/pact-foundation/pact-reference/issues/336">https://github.com/pact-foundation/pact-reference/issues/336</a></div></div></div><br/>
<div><a id="1710707897.022289"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710707897.022289" ><div class="time">2024-03-17 20:38</div></a><div class="msg">Hi !!

I am trying to run a provider verification using ffi lib, but it seems its unable to send the request to (<a href="http://localhost:8080/test_weather/generate_weather">http://localhost:8080/test_weather/generate_weather</a>) verify the message pact :

Code snippet:

```struct VerifierHandle *verifierhandle;
    verifierhandle = pactffi_verifier_new_for_application(name, version);
    pactffi_verifier_set_provider_info(verifierhandle, name, scheme, host, port, path);
    pactffi_verifier_add_provider_transport(verifierhandle, protocol, port, path, scheme);
    pactffi_verifier_set_publish_options(verifierhandle, version, NULL, NULL, -1, branch);
    pactffi_verifier_add_directory_source(verifierhandle, file_path);
    int output = pactffi_verifier_execute(verifierhandle);
    pactffi_verifier_shutdown(verifierhandle);```
Here are the debug lvl logs attached

```2024-03-17T20:22:21.013948Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $    
2024-03-17T20:22:21.014020Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Configuring a normal object    
2024-03-17T20:22:21.014407Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $.timestamp    
2024-03-17T20:22:21.014430Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: detected pact:matcher:type, will configure a matcher    
2024-03-17T20:22:21.014513Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $.weather    
2024-03-17T20:22:21.014527Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Configuring a normal object    
2024-03-17T20:22:21.014541Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $.weather.humidity    
2024-03-17T20:22:21.014553Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: detected pact:matcher:type, will configure a matcher    
2024-03-17T20:22:21.014575Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $.weather.temperature    
2024-03-17T20:22:21.014588Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: detected pact:matcher:type, will configure a matcher    
2024-03-17T20:22:21.014614Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: Path = $.weather.wind_speed_kmh    
2024-03-17T20:22:21.014626Z DEBUG ThreadId(01) pact_ffi::mock_server::bodies: detected pact:matcher:type, will configure a matcher    
2024-03-17T20:22:21.020918Z DEBUG ThreadId(01) pact_ffi::mock_server::handles: pact_ffi::mock_server::handles::pactffi_pact_handle_write_file FFI function invoked
2024-03-17T20:22:21.021017Z DEBUG ThreadId(01) pact_models::pact: Writing new pact file to "./pacts/animal_service-weather_service.json"
%%% message_pact_SUITE ==&gt; consumer.animal_consume_message: OK
2024-03-17T20:22:21.149207Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_new_for_application FFI function invoked
2024-03-17T20:22:21.149308Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_provider_info FFI function invoked
2024-03-17T20:22:21.149344Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_add_provider_transport FFI function invoked
2024-03-17T20:22:21.149391Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_publish_options FFI function invoked
2024-03-17T20:22:21.149421Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_add_directory_source FFI function invoked
2024-03-17T20:22:21.149453Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_execute FFI function invoked
2024-03-17T20:22:21.149474Z DEBUG ThreadId(01) pact_ffi::verifier::handle: Pact source to verify = Dir(./pacts)
2024-03-17T20:22:21.153359Z DEBUG ThreadId(01) pact_plugin_driver::catalogue_manager: Updated catalogue entries:
core/content-generator/binary
core/content-generator/json
core/content-matcher/json
core/content-matcher/multipart-form-data
core/content-matcher/text
core/content-matcher/xml
2024-03-17T20:22:21.153423Z DEBUG ThreadId(01) pact_plugin_driver::catalogue_manager: Updated catalogue entries:
core/matcher/v1-equality
core/matcher/v2-max-type
core/matcher/v2-min-type
core/matcher/v2-minmax-type
core/matcher/v2-regex
core/matcher/v2-type
core/matcher/v3-content-type
core/matcher/v3-date
core/matcher/v3-datetime
core/matcher/v3-decimal-type
core/matcher/v3-includes
core/matcher/v3-integer-type
core/matcher/v3-null
core/matcher/v3-number-type
core/matcher/v3-time
core/matcher/v4-array-contains
core/matcher/v4-equals-ignore-order
core/matcher/v4-max-equals-ignore-order
core/matcher/v4-min-equals-ignore-order
core/matcher/v4-minmax-equals-ignore-order
core/matcher/v4-not-empty
core/matcher/v4-semver
2024-03-17T20:22:21.153533Z DEBUG ThreadId(01) pact_verifier: Scanning "./pacts"
2024-03-17T20:22:21.154630Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier: Executing provider states
2024-03-17T20:22:21.154649Z  INFO ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier: Running setup provider state change handler 'weather data for animals' for 'a weather data message'
2024-03-17T20:22:21.154662Z  WARN ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier::callback_executors: State Change ignored as there is no state change URL provided for interaction 
2024-03-17T20:22:21.154675Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier: State Change: "ProviderState { name: "weather data for animals", params: {} }" -&gt; Ok({})
2024-03-17T20:22:21.154689Z  INFO ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier: Running provider verification for 'a weather data message'
2024-03-17T20:22:21.154696Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier: Verifying an asynchronous message (single shot)
2024-03-17T20:22:21.154729Z  INFO ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier::provider_client: Sending request to provider at <a href="http://localhost:8080/test_weather/generate_weather">http://localhost:8080/test_weather/generate_weather</a>
2024-03-17T20:22:21.154737Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier::provider_client: Provider details = ProviderInfo { name: "weather_service", protocol: "http", host: "localhost", port: Some(8080), path: "/test_weather/generate_weather", transports: [ProviderTransport { transport: "http", port: Some(8080), path: Some("/test_weather/generate_weather"), scheme: None }, ProviderTransport { transport: "message", port: Some(8080), path: Some("/test_weather/generate_weather"), scheme: Some("http") }] }
2024-03-17T20:22:21.154766Z  INFO ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier::provider_client: Sending request HTTP Request ( method: POST, path: /, query: None, headers: Some({"Content-Type": ["application/json"]}), body: Present(95 bytes, application/json) )
2024-03-17T20:22:21.154781Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: pact_verifier::provider_client: body:
{"description":"a weather data message","providerStates":[{"name":"weather data for animals"}]}
2024-03-17T20:22:21.154895Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: reqwest::connect: starting new connection: <a href="http://localhost:8080/">http://localhost:8080/</a>    
2024-03-17T20:22:21.155114Z DEBUG tokio-runtime-worker hyper::client::connect::dns: resolving host="localhost"
2024-03-17T20:22:21.155328Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: hyper::client::connect::http: connecting to 127.0.0.1:8080
2024-03-17T20:22:21.155535Z DEBUG ThreadId(01) verify_interaction{interaction="a weather data message"}: hyper::client::connect::http: connected to 127.0.0.1:8080
2024-03-17T20:22:21.155860Z DEBUG tokio-runtime-worker hyper::proto::h1::io: flushed 262 bytes
2024-03-17T20:22:26.156256Z  INFO ThreadId(01) pact_verifier: Not publishing results as publishing for pact source Dir("./pacts") is not possible or not yet implemented
2024-03-17T20:22:26.156350Z DEBUG ThreadId(01) pact_matching::metrics: 'PACT_DO_NOT_TRACK' environment variable is set, will not send metrics

Verifying a pact between animal_service and weather_service

  a weather data message (0s loading, 5s 2ms verification)
     Given weather data for animals
      Request Failed - error sending request for url (<a href="http://localhost:8080/test_weather/generate_weather">http://localhost:8080/test_weather/generate_weather</a>): operation timed out


Failures:

1) Verifying a pact between animal_service and weather_service Given weather data for animals - a weather data message - error sending request for url (<a href="http://localhost:8080/test_weather/generate_weather">http://localhost:8080/test_weather/generate_weather</a>): operation timed out


There were 1 pact failures```
Also i am able to connect to this particular url via postman, but not via pact ffi. Any clues what could be wrong here?</div></div></div><br/>
<div><a id="1710714641.482979"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1710714641.482979" ><div class="time">2024-03-17 22:30</div></a><div class="msg">`operation timed out` - that's a networking issue</div></div></div><br/>
<div><a id="1710714652.453859"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1710714652.453859" ><div class="time">2024-03-17 22:30</div></a><div class="msg">Are you running it in docker?</div></div></div><br/>
<div><a id="1710726638.493929"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710726638.493929" ><div class="time">2024-03-18 01:50</div></a><div class="msg">Just a thought - should we consider printing out the detected os/arch (and any other relevant details) at the top of a DEBUG log, so when people raise these types of things we have it immediately at our disposal? :thinking_face:</div></div></div><br/>
<div><a id="1710730158.301239"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710730158.301239" ><div class="time">2024-03-18 02:49</div></a><div class="msg">@rholshausen no, I haven?t used docker here for running my server.</div></div></div><br/>
<div><a id="1710734880.787519"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710734880.787519" ><div class="time">2024-03-18 04:08</div></a><div class="msg">Are you able to demonstrate that the server is indeed running on `127.0.0.1:8080` ?</div></div></div><br/>
<div><a id="1710734934.421229"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710734934.421229" ><div class="time">2024-03-18 04:08</div></a><div class="msg">e.g. `lsof -i:8080` or `netstat -an | grep LISTEN | grep 8080`</div></div></div><br/>
<div><a id="1710736830.947759"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710736830.947759" ><div class="time">2024-03-18 04:40</div></a><div class="msg">yes
```ranjan@ranjan-MS-7D43:~/work/pact_erlang$ netstat -an | grep LISTEN | grep 8080
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN     
ranjan@ranjan-MS-7D43:~/work/pact_erlang$ lsof -i:8080
COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
beam.smp 6205 ranjan   26u  IPv4  54688      0t0  TCP *:http-alt (LISTEN)```</div></div></div><br/>
<div><a id="1710738267.241679"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710738267.241679" ><div class="time">2024-03-18 05:04</div></a><div class="msg">Yeah, it?s bound to `0.0.0.0` and not `127.0.0.1` (see third column of your `netstat` output)</div></div></div><br/>
<div><a id="1710738344.662869"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710738344.662869" ><div class="time">2024-03-18 05:05</div></a><div class="msg">```grep localhost /etc/hosts
# localhost is used to configure the loopback interface
127.0.0.1	localhost
::1             localhost```
That means if I bind to `localhost` I can connect to it on `127.0.0.1` and `::1`</div></div></div><br/>
<div><a id="1710738356.711369"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710738356.711369" ><div class="time">2024-03-18 05:05</div></a><div class="msg">TL;DR - set your verifier target to `0.0.0.0`</div></div></div><br/>
<div><a id="1710738388.393689"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710738388.393689" ><div class="time">2024-03-18 05:06</div></a><div class="msg">(or bind your API to a specific IP)</div></div></div><br/>
<div><a id="1710756801.239869"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710756801.239869" ><div class="time">2024-03-18 10:13</div></a><div class="msg">still didn?t work after i changed to `0.0.0.0`</div></div></div><br/>
<div><a id="1710757008.650519"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710757008.650519" ><div class="time">2024-03-18 10:16</div></a><div class="msg">OK new thought - the thread is in a deadlock situation. I recall needing to execute this asynchronously in NodeJS otherwise the process is blocked.</div></div></div><br/>
<div><a id="1710808630.565159"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710808630.565159" ><div class="time">2024-03-19 00:37</div></a><div class="msg">still didn't work after spawning a separate process in erlang that executes the c code snippet i shared

erlang:
```    Pid = spawn(?MODULE, assert_verification, [Name, Scheme, Host, Port, Path, Version, Branch, FilePath, Protocol]),
    Pid ! {self(), get_result},
    receive
        {Pid, Result} -&gt;
            Result
    end,
    ?assertEqual(0, Result).

assert_verification(Name, Scheme, Host, Port, Path, Version, Branch, FilePath, Protocol) -&gt;
    receive
        {From, get_result} -&gt;
            Output = pactffi_nif:verify_via_file(Name, Scheme, Host, Port, Path, Version, Branch, FilePath, Protocol),
            From ! {self(), Output}
    end.```
C:
```struct VerifierHandle *verifierhandle;
    verifierhandle = pactffi_verifier_new_for_application(name, version);
    pactffi_verifier_set_provider_info(verifierhandle, name, scheme, host, port, path);
    pactffi_verifier_add_provider_transport(verifierhandle, protocol, port, path, scheme);
    pactffi_verifier_set_publish_options(verifierhandle, version, NULL, NULL, -1, branch);
    pactffi_verifier_add_directory_source(verifierhandle, file_path);
    int output = pactffi_verifier_execute(verifierhandle);
    pactffi_verifier_shutdown(verifierhandle);```
 @srijan.c</div></div></div><br/>
<div><a id="1710809580.242139"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1710809580.242139" ><div class="time">2024-03-19 00:53</div></a><div class="msg">my bad, Its definitely the thread deadlock issue as when i ran the server in a separate thread it worked. Thanks a lot @matt.fellows @rholshausen</div></div></div><br/>
<div><a id="1710820482.254169"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1710820482.254169" ><div class="time">2024-03-19 03:54</div></a><div class="msg">Nice!</div></div></div><br/>
<div><a id="1712848010.522369"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712848010.522369" ><div class="time">2024-04-11 15:06</div></a><div class="msg">Hi
I am getting segmentation fault when i am executing `pactffi_verifier_broker_source_with_selectors`
```2024-04-11T15:03:22.613421Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_new_for_application FFI function invoked
2024-04-11T15:03:22.613463Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_provider_info FFI function invoked
2024-04-11T15:03:22.613480Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_add_provider_transport FFI function invoked
2024-04-11T15:03:22.613495Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_provider_state FFI function invoked
2024-04-11T15:03:22.613532Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_verification_options FFI function invoked
2024-04-11T15:03:22.613546Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_set_publish_options FFI function invoked
broker_url Variable: <a href="http://localhost:9292/">http://localhost:9292/</a>
broker_username Variable: pact_workshop
broker_password Variable: pact_workshop
enable_pending Variable: 1
branch Variable: develop
consumer_version_selectors Variable: {}
consumer_version_selectors_len Variable: 0
2024-04-11T15:03:22.613621Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_broker_source_with_selectors FFI function invoked
2024-04-11T15:03:22.613640Z DEBUG ThreadId(10) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_execute FFI function invoked
2024-04-11T15:03:22.613651Z DEBUG ThreadId(10) pact_ffi::verifier::handle: Pact source to verify = PactBrokerWithDynamicConfiguration(<a href="http://localhost:9292/">http://localhost:9292/</a>, provider_name='animal_service', enable_pending=true, include_wip_since=None, provider_tags=[], provider_branch=Some("develop"), consumer_version_selectors='[], auth=User(pact_workshop, pact*********)')
2024-04-11T15:03:22.749605Z  INFO ThreadId(10) pact_verifier::pact_broker: Fetching path '/' from pact broker

make: *** [Makefile:13: test] Segmentation fault (core dumped)```
Any pointers as to what might be causing this or how should i debug this?</div></div></div><br/>
<div><a id="1712876934.257699"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1712876934.257699" ><div class="time">2024-04-11 23:08</div></a><div class="msg">How are you executing? Are you using a specific language wrapper, or do you have your own wrapper?

A seg fault clearly is not ideal, but from the logs you have, it would appear that seg fault is happening immediately after trying to fetch `/`, but before it even gets a chance to receive a response. Perhaps there's something malformated within the selectors?</div></div></div><br/>
<div><a id="1712877067.043519"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1712877067.043519" ><div class="time">2024-04-11 23:11</div></a><div class="msg">Also, we have had segfaults with Alpine Linux, are you running it with that?
Enabling trace level logs will help</div></div></div><br/>
<div><a id="1712890922.845849"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712890922.845849" ><div class="time">2024-04-12 03:02</div></a><div class="msg">Yeah, I am using <a href="https://hub.docker.com/r/pactfoundation/pact-broker">https://hub.docker.com/r/pactfoundation/pact-broker</a></div></div></div><br/>
<div><a id="1712891286.966019"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712891286.966019" ><div class="time">2024-04-12 03:08</div></a><div class="msg">Surprisingly, when I enabled trace logs, the segfault appear to be gone :sweat_smile: :confused_dog:</div></div></div><br/>
<div><a id="1712891321.090299"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712891321.090299" ><div class="time">2024-04-12 03:08</div></a><div class="msg">@joshua.ellis I am actually testing my own wrapper (<a href="https://github.com/greyorange-labs/pact_erlang/pull/28/files#diff-dcd3461b8dea3b73ef8723daf6cc68865eb3e9387be186efaf6d9dfd3d0b1777">https://github.com/greyorange-labs/pact_erlang/pull/28/files#diff-dcd3461b8dea3b73ef8723daf6cc68865eb3e9387be186efaf6d9dfd3d0b1777</a>)</div></div></div><br/>
<div><a id="1712911555.310699"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712911555.310699" ><div class="time">2024-04-12 08:45</div></a><div class="msg">Its not working on ubuntu systems, but working on my local (mac arm64) :confused:</div></div></div><br/>
<div><a id="1712921849.926359"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1712921849.926359" ><div class="time">2024-04-12 11:37</div></a><div class="msg">Do you have a minimal example you can share with us to replicate the issue? That would be immensely helpful.</div></div></div><br/>
<div><a id="1712923792.880369"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712923792.880369" ><div class="time">2024-04-12 12:09</div></a><div class="msg">```/* niftest.c */
#include &lt;pact.h&gt;
#include &lt;string.h&gt;
#include &lt;stdio.h&gt;


int test_pactffi() {
    printf("Verification Start--------------------\n");

    char *name = "animal_service";
    char *scheme = "http";
    char *host = "localhost";
    int port = 8080;
    char *path = "/";
    char *version = "default";
    char *branch = "develop";
    char *broker_url = "<a href="http://localhost:9292/">http://localhost:9292/</a>";
    // OSS pact broker docker image: pactfoundation/pact-broker
    char *broker_username = "pact_workshop";
    char *broker_password = "pact_workshop";
    int enable_pending = 1;
    char *consumer_version_selectors = "{}";
    int consumer_version_selectors_len = 0;
    char *protocol = "http";

    
    char *state_path = "<a href="http://localhost:8080/pactStateChange">http://localhost:8080/pactStateChange</a>";

    struct VerifierHandle *verifierhandle;
    verifierhandle = pactffi_verifier_new_for_application(name, version);
    pactffi_verifier_set_provider_info(verifierhandle, name, scheme, host, port, path);
    pactffi_verifier_add_provider_transport(verifierhandle, protocol, port, path, scheme);

    if (state_path[0] != '\0')
    {
        pactffi_verifier_set_provider_state(verifierhandle, state_path, 0, 1);
    }
    pactffi_verifier_set_verification_options(verifierhandle, 0, 5000),
    pactffi_verifier_set_publish_options(verifierhandle, version, NULL, NULL, -1, branch);
    pactffi_verifier_broker_source_with_selectors(verifierhandle, broker_url, broker_username, broker_password, NULL, enable_pending, NULL, NULL, -1, branch, consumer_version_selectors, consumer_version_selectors_len, NULL, -1);
    setenv("PACT_DO_NOT_TRACK", "true", 1);
    int output = pactffi_verifier_execute(verifierhandle);
    pactffi_verifier_shutdown(verifierhandle);

    printf("Verification End------------------------\n");


    return output;
}

int main() {
    // Function call
    pactffi_logger_init();
    pactffi_logger_attach_sink("stdout", 5);
    pactffi_logger_apply();
    int output = test_pactffi();

    printf("Output is ------ %d\n", output);
    return 0;
}```</div></div></div><br/>
<div><a id="1712925937.255769"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712925937.255769" ><div class="time">2024-04-12 12:45</div></a><div class="msg">Also i am trying to run the above code by following the below steps:
Step 1: Get the shared library .so
```gcc -O2 -Wmissing-prototypes -Wall -shared -o /home/ranjan/work/pact_erlang/libpact_ffi.so /home/ranjan/work/pact_erlang/c_src/pactffi_test.c -I/home/ranjan/work/pact_erlang/c_src/include /home/ranjan/work/pact_erlang/priv/libpact_ffi-linux-x86_64.a```
Step 2: Compile the pactffi_test.c
```gcc -c -I./c_src/include ./c_src/pactffi_test.c```
Step 3: Get the executable to run:
```gcc -O2 -Wmissing-prototypes -Wall -shared -o pactffi_test -L. pactffi_test.o -lpact_ffi```
I am still getting segmentation fault, even after I remove the pact ffi calls from my c file.</div></div></div><br/>
<div><a id="1712933745.910899"><img src="https://avatars.slack-edge.com/2024-03-27/6881032577265_01295cead2621def34db_72.png" /></a><div class="message"><div class="username">zied</div><a style="text-decoration: none" href="#1712933745.910899" ><div class="time">2024-04-12 14:55</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1712986391.952859"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1712986391.952859" ><div class="time">2024-04-13 05:33</div></a><div class="msg">Update: I was able to execute the above c code separately. I think there is something wrong in the erlang-c communication that might be causing the seg fault here.

back to the drawing board</div></div></div><br/>
<div><a id="1712987302.698339"><img src="https://avatars.slack-edge.com/2023-09-04/5837088704774_48cff3b272aaa2c25e6b_72.jpg" /></a><div class="message"><div class="username">joshua.ellis</div><a style="text-decoration: none" href="#1712987302.698339" ><div class="time">2024-04-13 05:48</div></a><div class="msg">Thanks for the details! I'll take a look on Monday. The face you're getting seg fails even after you remove the FFI calls would indicate the fault is not in the FFI, which is a good first step. 

Some care must be taken when crossing language boundaries, and it's possible an assumption made in one language isn't being followed in the other. 

If it is more specifically with Erlang or Pact Erlang, you might get better/more specific help from that channel.</div></div></div><br/>
<div><a id="1714699242.434569"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1714699242.434569" ><div class="time">2024-05-03 01:20</div></a><div class="msg">I would like to discuss about this change <a href="https://github.com/pact-foundation/pact-reference/pull/405/files#diff-4ebc1aebf7776ab6040dc317cf34fd5ff89ac78e80c07d13de1bce2ce898650fR187-R217">https://github.com/pact-foundation/pact-reference/pull/405/files#diff-4ebc1aebf7776ab6040dc317cf34fd5ff89ac78e80c07d13de1bce2ce898650fR187-R217</a>

Should we change the format into something like this:

```{
    "results": {
      "pact:matcher:type": "matchAll",
      "rules": [
        {
          "pact:matcher:type": "each-key",
          "value": "AUK-155332",
          "rules": [
            {
              "pact:matcher:type": "regex",
              "regex": "\\w{3}-\\d+"
            }
          ]
        }, {
          "pact:matcher:type": "each-value",
          "rules": [
            {
              "pact:matcher:type": "type"
            }
          ]
        }
      ],
      "value": {
        "AUK-155332": {
            "title": "...",
            "description": "...",
            "link": "http://....",
            "relatesTo": ["BAF-88654"]
        }
      }
    }
}```</div></div></div><br/>
<div><a id="1714699438.761149"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1714699438.761149" ><div class="time">2024-05-03 01:23</div></a><div class="msg">That's no different than just providing the array of matching rules for the `pact:matcher:type` attribute</div></div></div><br/>
<div><a id="1714699730.458989"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1714699730.458989" ><div class="time">2024-05-03 01:28</div></a><div class="msg">Yes, there are no different in term of feature. I'm talking about the consistency format to other matchers.</div></div></div><br/>
<div><a id="1715262532.163299"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1715262532.163299" ><div class="time">2024-05-09 13:48</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1715379325.177179"><img src="https://avatars.slack-edge.com/2024-05-10/7103529445412_90ccca79acfd05515c08_72.jpg" /></a><div class="message"><div class="username">nick.shirley</div><a style="text-decoration: none" href="#1715379325.177179" ><div class="time">2024-05-10 22:15</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1716200056.061779"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1716200056.061779" ><div class="time">2024-05-20 10:14</div></a><div class="msg">We don't have support for this in the FFI yet do we?
 <a href="https://pact.canny.io/feature-requests/p/add-metadata-injection-support-to-pact-js-verifier">https://pact.canny.io/feature-requests/p/add-metadata-injection-support-to-pact-js-verifier</a></div></div></div><br/>
<div><a id="1716541227.150199"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1716541227.150199" ><div class="time">2024-05-24 09:00</div></a><div class="msg"><a href="https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_add_custom_header.html">https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_add_custom_header.html</a> -&gt; isn?t this the one ?</div></div></div><br/>
<div><a id="1716589648.126259"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1716589648.126259" ><div class="time">2024-05-24 22:27</div></a><div class="msg">That adds an HTTP header, I think it's a different thing altogether</div></div></div><br/>
<div><a id="1716589719.005039"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1716589719.005039" ><div class="time">2024-05-24 22:28</div></a><div class="msg">The request is to dynamically modify the metadata sent during provider verification of a grpc request</div></div></div><br/>
<div><a id="1720526884.015599"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720526884.015599" ><div class="time">2024-07-09 12:08</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1720594229.156169"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720594229.156169" ><div class="time">2024-07-10 06:50</div></a><div class="msg">Hi! We are using <a href="https://github.com/greyorange-labs/pact_erlang">https://github.com/greyorange-labs/pact_erlang</a> for provider verification. I am going through the steps described as <a href="https://docs.pact.io/pact_nirvana">https://docs.pact.io/pact_nirvana</a> to take us from local flow to full integration with our CI/CD workflows.

I wish to modify the provider tests to have two options (<a href="https://docs.pact.io/pact_nirvana/step_4#c-manually-verify-the-pact-by-url-using-the-pact-broker">https://docs.pact.io/pact_nirvana/step_4#c-manually-verify-the-pact-by-url-using-the-pact-broker</a>):
1. Run tests in CI/CD and publish verification results
2. Run tests locally agains latest pacts and do not publish the results
I am trying to figure out the best option for doing that. I dug through the pact_ffi library but didn't see any option I can provide to easily use some flag to say "_Don't publish the results_". Any suggestions?</div></div></div><br/>
<div><a id="1720594504.098169"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1720594504.098169" ><div class="time">2024-07-10 06:55</div></a><div class="msg">This is the function you want to use: <a href="https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_set_publish_options.html">https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_set_publish_options.html</a></div></div></div><br/>
<div><a id="1720594628.078709"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720594628.078709" ><div class="time">2024-07-10 06:57</div></a><div class="msg">pact_erlang is using that. What are the options to provide it so it wouldn't publish the results? :open_mouth:

The params are:
? handle
? provider version
? build URL
? provider tags
? provider tags len
? provider branch
Nothing intuitive popped out for me on initial look yesterday, hence my question :thinking_face:</div></div></div><br/>
<div><a id="1720594657.745209"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1720594657.745209" ><div class="time">2024-07-10 06:57</div></a><div class="msg">By default it won't publish anything if you don't call that function</div></div></div><br/>
<div><a id="1720594711.073419"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720594711.073419" ><div class="time">2024-07-10 06:58</div></a><div class="msg">Ah! Makes sense. I could create a param to switch it off on demand.</div></div></div><br/>
<div><a id="1720594764.182629"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1720594764.182629" ><div class="time">2024-07-10 06:59</div></a><div class="msg">I suppose we could add a `do_not_publish` function to make it explicit, but it will just be clearing what that function sets.</div></div></div><br/>
<div><a id="1720594885.552639"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1720594885.552639" ><div class="time">2024-07-10 07:01</div></a><div class="msg">I will update the docs to indicate that if you don't call it, publishing is disabled</div></div></div><br/>
<div><a id="1720594888.998079"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720594888.998079" ><div class="time">2024-07-10 07:01</div></a><div class="msg">I think adding some comment to the existing function, that if one wishes to not publish the results, leave it unconfigured/called, would also be good</div></div></div><br/>
<div><a id="1720594910.466019"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720594910.466019" ><div class="time">2024-07-10 07:01</div></a><div class="msg">Same thoughts :smile: :+1::skin-tone-3:  </div></div></div><br/>
<div><a id="1720608735.110079"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720608735.110079" ><div class="time">2024-07-10 10:52</div></a><div class="msg">Hi again! :wave:

I am trying to implement consumer version selectors. I am struggling to understand either why is it not working for me or how is it supposed to work :sweat_smile:

For testing purposes, I did the following:

```    char myJson[256];
    strcpy(myJson, "[{");
    strcat(myJson, "\"branch\": \"foo-bar\"");
    strcat(myJson, "}]");
    const char *mockSelectors[] = {myJson};

    printf("mockSelectors is %s\n", mockSelectors[0]);
    // prints out mockSelectors is [{"branch": "foo-bar"}]

    pactffi_verifier_broker_source_with_selectors(..., mockSelectors, 1, ...)
...```
As I _*understand*_, this is supposed to verify against consumers with branch `foo-bar` ? When I run the verifier, it instead uses the latest version.

```The pact at ... is being verified because the pact content belongs to the consumer version matching the following criterion:
    * latest version of <consumer> that has a pact with <provider> (<absolute-version of consumer>)```
Any help would be greatly appreciated! :bow:</div></div></div><br/>
<div><a id="1720609789.778979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720609789.778979" ><div class="time">2024-07-10 11:09</div></a><div class="msg">mind sharing any additional logs there? The selectors look OK</div></div></div><br/>
<div><a id="1720609847.836079"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720609847.836079" ><div class="time">2024-07-10 11:10</div></a><div class="msg">If you have the logs set to DEBUG you should see a `POST HOST/?/for-verification` in there somewhere. That will have the actual query sent to the broker.

My guess is your settings haven?t taken effect.</div></div></div><br/>
<div><a id="1720609938.418389"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720609938.418389" ><div class="time">2024-07-10 11:12</div></a><div class="msg">Ah, you?ve set `len` to `1`, but this is presumably the length of the selectors string (it?s a C interface, so it needs to know how many characters to read over the FFI)</div></div></div><br/>
<div><a id="1720609938.606639"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720609938.606639" ><div class="time">2024-07-10 11:12</div></a><div class="msg">Logs set to debug for what? FFI?</div></div></div><br/>
<div><a id="1720609947.725529"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720609947.725529" ><div class="time">2024-07-10 11:12</div></a><div class="msg">oooooooohhhhh</div></div></div><br/>
<div><a id="1720609959.767219"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720609959.767219" ><div class="time">2024-07-10 11:12</div></a><div class="msg">I thought it is the amount of selectors</div></div></div><br/>
<div><a id="1720609985.883819"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720609985.883819" ><div class="time">2024-07-10 11:13</div></a><div class="msg">Let me try giving it a proper length</div></div></div><br/>
<div><a id="1720610297.149549"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610297.149549" ><div class="time">2024-07-10 11:18</div></a><div class="msg">&gt; Logs set to debug for what? FFI?
yep, there should be an FFI to set the log level and where you want the logs to go (stdout, file etc.)</div></div></div><br/>
<div><a id="1720610333.631149"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720610333.631149" ><div class="time">2024-07-10 11:18</div></a><div class="msg">Btw should the length be number of characters in the selectors string? escaped or unescaped?</div></div></div><br/>
<div><a id="1720610443.323309"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610443.323309" ><div class="time">2024-07-10 11:20</div></a><div class="msg">It?s the JSON string length. From the 0th character, how many characters needs to be read in until the final closing brace `}`</div></div></div><br/>
<div><a id="1720610509.883719"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610509.883719" ><div class="time">2024-07-10 11:21</div></a><div class="msg">So if I read your code correctly, it produces this string: `[{"branch": "foo-bar"}]` which is 24 characters long</div></div></div><br/>
<div><a id="1720610548.438359"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610548.438359" ><div class="time">2024-07-10 11:22</div></a><div class="msg">(^^ updated I included the escaping)</div></div></div><br/>
<div><a id="1720610609.838599"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720610609.838599" ><div class="time">2024-07-10 11:23</div></a><div class="msg">`_int_ mockSelectors_len = strlen(mockSelectors[0]);` gives me 23 :smile: But now I get a different error, trying to get to the bottom of this one.

_tysm for bearing with me here.._</div></div></div><br/>
<div><a id="1720610631.437889"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610631.437889" ><div class="time">2024-07-10 11:23</div></a><div class="msg">I might have been off by one :shrug: :laughing:</div></div></div><br/>
<div><a id="1720610653.579949"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610653.579949" ><div class="time">2024-07-10 11:24</div></a><div class="msg">yes, it?s 23</div></div></div><br/>
<div><a id="1720610763.379909"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610763.379909" ><div class="time">2024-07-10 11:26</div></a><div class="msg">I did `echo "[{\"branch\": \"foo-bar\"}]" | wc -c` instead of `echo -n "[{\"branch\": \"foo-bar\"}]" | wc -c`</div></div></div><br/>
<div><a id="1720610780.838079"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720610780.838079" ><div class="time">2024-07-10 11:26</div></a><div class="msg">(I always forget to do that)</div></div></div><br/>
<div><a id="1720611052.682929"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611052.682929" ><div class="time">2024-07-10 11:30</div></a><div class="msg">So currently...

When I pass length as 0, or 1 - The tests pass, as they verify with latest pacts (the initial issue))

When I pass the `strlen(mockSelectors)` , and a proper length is used the tests fail, or do not run. Hard to tell, no logs from pact_erlang or FFI side...

I am using elixir, where I do

```    {:ok, verfier_ref} = :pact_verifier.start_verifier(service_name, provider_opts)
    output = :pact_verifier.verify(verfier_ref)

    assert 0 = output```
and I simply get
```test contracts (.....)
     test/contract/testfile.exs:6
     match (=) failed
     code:  assert 0 = output
     left:  0
     right: 139
     stacktrace:
       test/contract/testfile.exs:43: (test) ```</div></div></div><br/>
<div><a id="1720611079.029079"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611079.029079" ><div class="time">2024-07-10 11:31</div></a><div class="msg">I tried now providing the correct branch name, thinking that maybe it worked but didn't find such branch `foo-bar` , but it did not succeed either.</div></div></div><br/>
<div><a id="1720611814.990099"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611814.990099" ><div class="time">2024-07-10 11:43</div></a><div class="msg">My logs go into pact_erlang.log file.
When I use length 23 (or whatever it is), there are no logs even.
When I use length 1, I at least get some logs.</div></div></div><br/>
<div><a id="1720611866.067499"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611866.067499" ><div class="time">2024-07-10 11:44</div></a><div class="msg">and about what you said earlier
&gt; If you have the logs set to DEBUG you should see a `POST HOST/?/for-verification` in there somewhere. That will have the actual query sent to the broker.
&gt; 
&gt; My guess is your settings haven?t taken effect.
I can see in the logs `_2024-07-10T11:41:41.123902Z_  INFO ThreadId(13) pact_verifier::pact_broker: Fetching path '/pacts/provider/&lt;provider&gt;/for-verification' from pact broker`</div></div></div><br/>
<div><a id="1720611929.788029"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611929.788029" ><div class="time">2024-07-10 11:45</div></a><div class="msg">And right after
`_2024-07-10T11:41:42.089830Z_  INFO ThreadId(13) pact_verifier::pact_broker: Fetching path '/pacts/provider/&lt;provider&gt;/consumer/&lt;consumer&gt;/pact-version/a9ad1547da4dc3b534d84109157c124df17a7d75/metadata/c1tdW2xdPXRydWUmc1tdW2N2XT0zNg' from pact broker`
After which it goes into state change url's already</div></div></div><br/>
<div><a id="1720611963.217899"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720611963.217899" ><div class="time">2024-07-10 11:46</div></a><div class="msg">Looks like logs are at INFO level, ideally they set to DEBUG to get the body sent</div></div></div><br/>
<div><a id="1720611986.356989"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720611986.356989" ><div class="time">2024-07-10 11:46</div></a><div class="msg">I'll try to do that</div></div></div><br/>
<div><a id="1720612026.831639"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720612026.831639" ><div class="time">2024-07-10 11:47</div></a><div class="msg">I think you might need to call this: <a href="https://github.com/greyorange-labs/pact_erlang/blob/35b199df968b5ca547f322d18da44d0a3b008261/src/pact.erl#L98">https://github.com/greyorange-labs/pact_erlang/blob/35b199df968b5ca547f322d18da44d0a3b008261/src/pact.erl#L98</a></div></div></div><br/>
<div><a id="1720612127.708789"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720612127.708789" ><div class="time">2024-07-10 11:48</div></a><div class="msg">Changed <a href="https://github.com/greyorange-labs/pact_erlang/blob/35b199df968b5ca547f322d18da44d0a3b008261/src/pact_escript.escript#L56">https://github.com/greyorange-labs/pact_erlang/blob/35b199df968b5ca547f322d18da44d0a3b008261/src/pact_escript.escript#L56</a> to debug, got the logs now..</div></div></div><br/>
<div><a id="1720612211.420479"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720612211.420479" ><div class="time">2024-07-10 11:50</div></a><div class="msg">Interesting... It does actually send it, sec</div></div></div><br/>
<div><a id="1720612282.512029"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720612282.512029" ><div class="time">2024-07-10 11:51</div></a><div class="msg">So with c interfaces, if things just stop working randomly or crashes, that usually means the receiver of the function cannot read the arguments or gets something of the wrong shape and just dies</div></div></div><br/>
<div><a id="1720612473.657709"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720612473.657709" ><div class="time">2024-07-10 11:54</div></a><div class="msg">Good to know :+1:  Not a C developer directly, but more of a problem-solver, so I'm okay with working with any language :smile: Sorry for dumb questions from time to time.

Now back to the logs..

Even though I give `[{"branch": "foo-bar"}]` to `pactffi_verifier_broker_source_with_selectors` function, the logs indicate that it uses the actual branch

```2024-07-10T11:51:03.944175Z DEBUG ThreadId(01) pact_verifier::pact_broker: templated URL = <a href="https://gpoc.pactflow.io/pacts/provider/">https://gpoc.pactflow.io/pacts/provider/</a>&lt;provider&gt;/for-verification
2024-07-10T11:51:03.944604Z DEBUG ThreadId(01) pact_verifier::pact_broker: final URL = <a href="https://gpoc.pactflow.io/pacts/provider/">https://gpoc.pactflow.io/pacts/provider/</a>&lt;provider&gt;/for-verification
2024-07-10T11:51:03.944633Z DEBUG ThreadId(01) pact_verifier::pact_broker: Sending JSON to <a href="https://gpoc.pactflow.io/pacts/provider/">https://gpoc.pactflow.io/pacts/provider/</a>&lt;provider&gt;/for-verification using POST: {"includePendingStatus":false,"consumerVersionSelectors":[],"providerVersionBranch":"&lt;real-branch-name&gt;"}```</div></div></div><br/>
<div><a id="1720612511.255189"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720612511.255189" ><div class="time">2024-07-10 11:55</div></a><div class="msg">Can you please set the log-level to `trace` and then send me the entire log?</div></div></div><br/>
<div><a id="1720613064.490189"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720613064.490189" ><div class="time">2024-07-10 12:04</div></a><div class="msg">Sent in DM. Can continue discussion here if something is found there.</div></div></div><br/>
<div><a id="1720614102.154579"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720614102.154579" ><div class="time">2024-07-10 12:21</div></a><div class="msg">These lines look suspicious:

```2024-07-10T11:55:53.086870Z DEBUG ThreadId(01) pact_ffi::verifier: pact_ffi::verifier::pactffi_verifier_broker_source_with_selectors FFI function invoked
2024-07-10T11:55:53.086873Z TRACE ThreadId(01) pact_ffi::verifier: @param handle = 0x148612d10
2024-07-10T11:55:53.086875Z TRACE ThreadId(01) pact_ffi::verifier: @param url = 0x150ef08c8
2024-07-10T11:55:53.086877Z TRACE ThreadId(01) pact_ffi::verifier: @param username = 0x0
2024-07-10T11:55:53.086879Z TRACE ThreadId(01) pact_ffi::verifier: @param password = 0x0
2024-07-10T11:55:53.086881Z TRACE ThreadId(01) pact_ffi::verifier: @param token = 0x150ef0948
2024-07-10T11:55:53.086883Z TRACE ThreadId(01) pact_ffi::verifier: @param enable_pending = 0
2024-07-10T11:55:53.086885Z TRACE ThreadId(01) pact_ffi::verifier: @param include_wip_pacts_since = 0x0
2024-07-10T11:55:53.086890Z TRACE ThreadId(01) pact_ffi::verifier: @param provider_tags = 0x0
2024-07-10T11:55:53.086892Z TRACE ThreadId(01) pact_ffi::verifier: @param provider_tags_len = 65535                    &lt;-----------
2024-07-10T11:55:53.086894Z TRACE ThreadId(01) pact_ffi::verifier: @param provider_branch = 0x150ef0888
2024-07-10T11:55:53.086896Z TRACE ThreadId(01) pact_ffi::verifier: @param consumer_version_selectors = 0x16e366c58
2024-07-10T11:55:53.086898Z TRACE ThreadId(01) pact_ffi::verifier: @param consumer_version_selectors_len = 1           &lt;------------
2024-07-10T11:55:53.086900Z TRACE ThreadId(01) pact_ffi::verifier: @param consumer_version_tags = 0x0
2024-07-10T11:55:53.086901Z TRACE ThreadId(01) pact_ffi::verifier: @param consumer_version_tags_len = 65535            &lt;-------------```</div></div></div><br/>
<div><a id="1720614154.193979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720614154.193979" ><div class="time">2024-07-10 12:22</div></a><div class="msg">The `provider_tags_len` suggests the FFI function will read 65535 characters from `provider_tags`, so probably isn?t reading anything after that property</div></div></div><br/>
<div><a id="1720614511.083109"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720614511.083109" ><div class="time">2024-07-10 12:28</div></a><div class="msg">Oh? the provider tags len is set to -1 by pact_erlang.. wasn?t too suspicious of that at first, but I can change it to 0 to test </div></div></div><br/>
<div><a id="1720614665.625919"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720614665.625919" ><div class="time">2024-07-10 12:31</div></a><div class="msg">that didn't change anything either.</div></div></div><br/>
<div><a id="1720614930.420949"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720614930.420949" ><div class="time">2024-07-10 12:35</div></a><div class="msg">Hold up, there were two values as -1. Trying with the following setup now

```pactffi_verifier_broker_source_with_selectors(verifierhandle, broker_url, NULL, NULL, broker_token, enable_pending, NULL, NULL, 0, branch, mockSelectors, 1, NULL, 0);```
where...
```void pactffi_verifier_broker_source_with_selectors(struct VerifierHandle *handle,
                                                   const char *url,
                                                   const char *username,
                                                   const char *password,
                                                   const char *token,
                                                   unsigned char enable_pending,
                                                   const char *include_wip_pacts_since,
                                                   const char *const *provider_tags,
                                                   unsigned short provider_tags_len,
                                                   const char *provider_branch,
                                                   const char *const *consumer_version_selectors,
                                                   unsigned short consumer_version_selectors_len,
                                                   const char *const *consumer_version_tags,
                                                   unsigned short consumer_version_tags_len);```</div></div></div><br/>
<div><a id="1720615036.362979"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615036.362979" ><div class="time">2024-07-10 12:37</div></a><div class="msg">Mock selectors can't be 1, it needs to be the length of the char*</div></div></div><br/>
<div><a id="1720615080.626969"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615080.626969" ><div class="time">2024-07-10 12:38</div></a><div class="msg">When I do that, it's the same thing as before. <a href="https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1720611052682929?thread_ts=1720608735.110079&amp;cid=C02BXLDJ7JR">https://pact-foundation.slack.com/archives/C02BXLDJ7JR/p1720611052682929?thread_ts=1720608735.110079&amp;cid=C02BXLDJ7JR</a></div></div></div><br/>
<div><a id="1720615124.218949"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615124.218949" ><div class="time">2024-07-10 12:38</div></a><div class="msg">I got logs for that run, sec</div></div></div><br/>
<div><a id="1720615193.495089"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615193.495089" ><div class="time">2024-07-10 12:39</div></a><div class="msg">My apologies I just looked at my Go client and it IS the length of the array. Sorry, I'm tired :rolling_on_the_floor_laughing:</div></div></div><br/>
<div><a id="1720615214.291669"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615214.291669" ><div class="time">2024-07-10 12:40</div></a><div class="msg">All good, you are a champion for bearing with me here so long :bow:</div></div></div><br/>
<div><a id="1720615265.313719"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615265.313719" ><div class="time">2024-07-10 12:41</div></a><div class="msg">In case helpful: <a href="https://github.com/pact-foundation/pact-go/blob/a396cace434c0559d0aaf737f278b38b12bcc510/internal/native/verifier.go#L182">https://github.com/pact-foundation/pact-go/blob/a396cace434c0559d0aaf737f278b38b12bcc510/internal/native/verifier.go#L182</a></div></div></div><br/>
<div><a id="1720615363.460659"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615363.460659" ><div class="time">2024-07-10 12:42</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-go/blob/a396cace434c0559d0aaf737f278b38b12bcc510/internal/native/verifier.go#L235">https://github.com/pact-foundation/pact-go/blob/a396cace434c0559d0aaf737f278b38b12bcc510/internal/native/verifier.go#L235</a></div></div></div><br/>
<div><a id="1720615479.451559"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615479.451559" ><div class="time">2024-07-10 12:44</div></a><div class="msg">So I think the problem is that you're passing a string (which is a JSON array) but it expects an array of strings (JSON objects)

I think this is why the method is dying - it's receiving an array of chars not an array of array of chars</div></div></div><br/>
<div><a id="1720615491.098519"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615491.098519" ><div class="time">2024-07-10 12:44</div></a><div class="msg">oooh</div></div></div><br/>
<div><a id="1720615558.282459"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615558.282459" ><div class="time">2024-07-10 12:45</div></a><div class="msg">I should have looked at the definition at the start. This is why the `len` was confusing me. You're passing a string so its length was the obvious thing to send. But you should be passing an array (of length 1)</div></div></div><br/>
<div><a id="1720615637.697109"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615637.697109" ><div class="time">2024-07-10 12:47</div></a><div class="msg">I was actually beginning to use json with `cJson`  library earlier today, but I stopped for a second and though, "hmm, let me see if there are other examples here" and saw some other thing being passed as json string :smile: Just went from there.</div></div></div><br/>
<div><a id="1720615797.465929"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615797.465929" ><div class="time">2024-07-10 12:49</div></a><div class="msg">So basically you need to give the FFI an array type on the arguments that also take a Len, and each value in the array is simply a JSON object as a string.</div></div></div><br/>
<div><a id="1720615835.720709"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720615835.720709" ><div class="time">2024-07-10 12:50</div></a><div class="msg">I need to head to bed, but will check back in tomorrow</div></div></div><br/>
<div><a id="1720615853.966519"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720615853.966519" ><div class="time">2024-07-10 12:50</div></a><div class="msg">Tyvm! Good night! I will report back the results.</div></div></div><br/>
<div><a id="1720622765.792099"><img src="https://avatars.slack-edge.com/2024-06-20/7289864555959_a963c7ef71602b05500b_72.png" /></a><div class="message"><div class="username">siim.mardus</div><a style="text-decoration: none" href="#1720622765.792099" ><div class="time">2024-07-10 14:46</div></a><div class="msg">In short, I got it working!

```// Works with no errors, tries to get pacts with branch foo-bar. Runs 0 tests
const char *jsonArray[] = {
  "{\"branch\": \"foo-bar\"}",
};

// Works with no errors, fetches pacts with real branch name. Runs tests
const char *jsonArray[] = {
  "{\"branch\": \"&lt;real-branch&gt;\"}",
};

pactffi_verifier_broker_source_with_selectors(..., jsonArray, 1, ..);```</div></div></div><br/>
<div><a id="1720650347.204469"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1720650347.204469" ><div class="time">2024-07-10 22:25</div></a><div class="msg">Woohoo!</div></div></div><br/>
<div><a id="1722431781.191899"><img src="https://avatars.slack-edge.com/2024-07-22/7473704544017_3fe7d14d0f6716108850_72.jpg" /></a><div class="message"><div class="username">erik.hartmann</div><a style="text-decoration: none" href="#1722431781.191899" ><div class="time">2024-07-31 13:16</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1725007612.357959"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1725007612.357959" ><div class="time">2024-08-30 08:46</div></a><div class="msg">Hi,

Anyone tested Pact with `application/x-www-form-urlencoded` ? Does it support matchers?
I try to test it here <a href="https://github.com/pact-foundation/pact-php/pull/627">https://github.com/pact-foundation/pact-php/pull/627</a>, but from the log, look like it doesn't support matchers:

```2024-08-30T08:38:28.146149Z DEBUG tokio-runtime-worker pact_mock_server::hyper_server: Request did not match: Request did not match - HTTP Request ( method: POST, path: /users, query: None, headers: Some({"Accept": ["application/json"], "Content-Type": ["application/x-www-form-urlencoded"]}), body: Present(287 bytes) )    0) $.^_-]{8,}$","value":"user@password111"}} -&gt; Expected form post parameter '^_-]{8,}$","value":"user@password111"}}' but was missing    1) $.email -&gt; Unexpected form post parameter 'email' received    2) $.password -&gt; Unexpected form post parameter 'password' received    3) $.{"fullname":{"pact:matcher:type":"type","value":"User name"},"email":{"pact:matcher:type":"regex","regex":"^[a-zA-Z0-9._% -] @[a-zA-Z0-9.-] .[a-zA-Z]{2,}$","value":"user@email.test"},"password":{"pact:matcher:type":"regex","regex":"^[\\w\\d@$!%*#? -&gt; Expected form post parameter '{"fullname":{"pact:matcher:type":"type","value":"User name"},"email":{"pact:matcher:type":"regex","regex":"^[a-zA-Z0-9._% -] @[a-zA-Z0-9.-] .[a-zA-Z]{2,}$","value":"user@email.test"},"password":{"pact:matcher:type":"regex","regex":"^[\\w\\d@$!%*#?' but was missing    4) $.fullname -&gt; Unexpected form post parameter 'fullname' received```</div></div></div><br/>
<div><a id="1725017746.196729"><img src="https://avatars.slack-edge.com/2018-04-12/346985093526_697d2fedcd27f4fc4996_72.jpg" /></a><div class="message"><div class="username">matt.fellows</div><a style="text-decoration: none" href="#1725017746.196729" ><div class="time">2024-08-30 11:35</div></a><div class="msg">I don't recall matchers working with anything other than JSON</div></div></div><br/>
<div><a id="1725119924.633349"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1725119924.633349" ><div class="time">2024-08-31 15:58</div></a><div class="msg">look like we need to create a new `form_urlencoded` plugin to use matchers in `application/x-www-form-urlencoded`   <a href="https://github.com/pact-foundation/pact-js/issues/767#issuecomment-961556899">https://github.com/pact-foundation/pact-js/issues/767#issuecomment-961556899</a></div></div></div><br/>
<div><a id="1727877739.967999"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727877739.967999" ><div class="time">2024-10-02 14:02</div></a><div class="msg">I'm trying to set multiple values in given namespace for pact metadata but always only get the last value I set. I'm using `pact-python`, but it passes its arguments along to `lib.pactffi_with_pact_metadata(` . My example is this:
```pact.with_metadata('namespace', {'var_1': 'value_1', 'var_2': 'value_2'})```
which breaks down into multiple calls as listed above, but the resulting pact file only contains:
```  "metadata": {
    "namespace": {
      "var_2": "value_2"
    },
    ...```
</div></div></div><br/>
<div><a id="1727879112.982749"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727879112.982749" ><div class="time">2024-10-02 14:25</div></a><div class="msg">You will want to use the v2 function I think

`pactffi_message_with_metadata_v2`

```PactFfi::MessageConsumer.with_metadata_v2(message, "namespace",'{"var_1":"value_1","var_2":"value_2"}')```

```      "metadata": {
        "contentType": "application/json",
        "namespace": {
          "var_1": "value_1",
          "var_2": "value_2"
        }
      },```</div></div></div><br/>
<div><a id="1727879250.743289"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727879250.743289" ><div class="time">2024-10-02 14:27</div></a><div class="msg">Tested using

<a href="https://github.com/YOU54F/pact-ruby-ffi/blob/68ff6ab2b291e231c653f0205d67ba070f7cd4e8/spec/pactffi_create_message_pact_spec.rb#L52">https://github.com/YOU54F/pact-ruby-ffi/blob/68ff6ab2b291e231c653f0205d67ba070f7cd4e8/spec/pactffi_create_message_pact_spec.rb#L52</a>

You?ll note its json but being passed as a string over the ffi barrier</div></div></div><br/>
<div><a id="1727879268.394649"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727879268.394649" ><div class="time">2024-10-02 14:27</div></a><div class="msg">interesting... that's gonna require a change to the clients I think</div></div></div><br/>
<div><a id="1727879328.124549"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727879328.124549" ><div class="time">2024-10-02 14:28</div></a><div class="msg">I think the v2 func was introduced to allow for metadata matchers using the integration json format.</div></div></div><br/>
<div><a id="1727879367.034099"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727879367.034099" ><div class="time">2024-10-02 14:29</div></a><div class="msg">btw good work on getting your matchers first pass in and merged, I?ve got it on my list to take a look this week</div></div></div><br/>
<div><a id="1727879431.083839"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727879431.083839" ><div class="time">2024-10-02 14:30</div></a><div class="msg">It doesn't look like either `pact-js` or `pact-python` use the `v2` function. Guess I'll see about getting that added to those :slightly_smiling_face:. Thanks for the info!</div></div></div><br/>
<div><a id="1727879764.750209"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727879764.750209" ><div class="time">2024-10-02 14:36</div></a><div class="msg">oh wait - this is for `pact_metadata`, not `message_metadata`</div></div></div><br/>
<div><a id="1727879959.335899"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727879959.335899" ><div class="time">2024-10-02 14:39</div></a><div class="msg">Ahh right, I imagine that will be implemented in the same way as the message_metadata(v1) func was, and probably suffers the same fate.

we won?t need the matchers here, but may want to process json payloads with nested keys</div></div></div><br/>
<div><a id="1727880013.009389"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727880013.009389" ><div class="time">2024-10-02 14:40</div></a><div class="msg">what are you trying to set out of interest? pact-python client lib values?</div></div></div><br/>
<div><a id="1727880160.039939"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727880160.039939" ><div class="time">2024-10-02 14:42</div></a><div class="msg">We have a number of different ways our services interact with one another, and I was hoping to use metadata to track that information. I could probably also do it with tags, but that significantly complicates the publishing process for services that have several different pacts. It felt easier to just use metadata since that gets written directly into the pact file itself.</div></div></div><br/>
<div><a id="1727880254.907479"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727880254.907479" ><div class="time">2024-10-02 14:44</div></a><div class="msg">I can still do it with metadata. It's just going to be a little clunky</div></div></div><br/>
<div><a id="1727880276.067259"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727880276.067259" ><div class="time">2024-10-02 14:44</div></a><div class="msg">I don?t think has enough args btw

```pact.with_metadata('namespace', {'var_1': 'value_1', 'var_2': 'value_2'})```

```
/**
 * Sets the additional metadata on the Pact file. Common uses are to add the client library details such as the name and version
 * Returns false if the interaction or Pact can't be modified (i.e. the mock server for it has already started)
 *
 * * `pact` - Handle to a Pact model
 * * `namespace` - the top level metadat key to set any key values on
 * * `name` - the key to set
 * * `value` - the value to set
 */
bool pactffi_with_pact_metadata(PactHandle pact,
                                const char *namespace_,
                                const char *name,
                                const char *value);```
</div></div></div><br/>
<div><a id="1727880328.911429"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727880328.911429" ><div class="time">2024-10-02 14:45</div></a><div class="msg">The python library breaks that dict down into individual calls to `pactffi_with_pact_metadata`</div></div></div><br/>
<div><a id="1727880398.938739"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727880398.938739" ><div class="time">2024-10-02 14:46</div></a><div class="msg">so it really is:
```pactffi_with_pact_metadata('namespace', 'var_1', 'value_1')
pactffi_with_pact_metadata('namespace', 'var_2', 'value_2')```
</div></div></div><br/>
<div><a id="1727880423.281619"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727880423.281619" ><div class="time">2024-10-02 14:47</div></a><div class="msg">ahh yeah, it must be a bug, it is only picking up the last value, where the namespace is not unique</div></div></div><br/>
<div><a id="1727880506.428709"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727880506.428709" ><div class="time">2024-10-02 14:48</div></a><div class="msg">I bet it isn?t cloning the existing items at that namespace before writing the namespace</div></div></div><br/>
<div><a id="1727880582.609149"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727880582.609149" ><div class="time">2024-10-02 14:49</div></a><div class="msg">here is the func

<a href="https://github.com/pact-foundation/pact-reference/blob/f5ddf3d353149ae0fb539a1616eeb8544509fdfc/rust/pact_ffi/src/mock_server/handles.rs#L1140-L1152">https://github.com/pact-foundation/pact-reference/blob/f5ddf3d353149ae0fb539a1616eeb8544509fdfc/rust/pact_ffi/src/mock_server/handles.rs#L1140-L1152</a></div></div></div><br/>
<div><a id="1727881206.542319"><img src="https://avatars.slack-edge.com/2021-12-09/2847110156736_e05273c817f2c1a28851_72.png" /></a><div class="message"><div class="username">yousafn</div><a style="text-decoration: none" href="#1727881206.542319" ><div class="time">2024-10-02 15:00</div></a><div class="msg">raised here Val

<a href="https://github.com/pact-foundation/pact-reference/issues/466">https://github.com/pact-foundation/pact-reference/issues/466</a></div></div></div><br/>
<div><a id="1727881252.561259"><img src="https://avatars.slack-edge.com/2024-05-08/7088200732388_03181829650b2b0460f5_72.png" /></a><div class="message"><div class="username">val.kolovos</div><a style="text-decoration: none" href="#1727881252.561259" ><div class="time">2024-10-02 15:00</div></a><div class="msg">oh cool - thank you!</div></div></div><br/>
<div><a id="1731572834.441839"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1731572834.441839" ><div class="time">2024-11-14 08:27</div></a><div class="msg">Does anyone get this error before?
```pact.so' (/lib/x86_64-linux-gnu/libc.so: invalid ELF header)```
Do you know how to fix it?
Original issue <a href="https://github.com/pact-foundation/pact-php/issues/692">https://github.com/pact-foundation/pact-php/issues/692</a></div></div></div><br/>
<div><a id="1731623088.495769"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1731623088.495769" ><div class="time">2024-11-14 22:24</div></a><div class="msg">It could be the file is corrupted, but I can't tell if it is the pact so or the libc one that is the problem.</div></div></div><br/>
<div><a id="1731623149.480159"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1731623149.480159" ><div class="time">2024-11-14 22:25</div></a><div class="msg">Or are you running this in docker with the wrong architecture? I.e. XF86 distribution on a ARM64 Apple Mac?</div></div></div><br/>
<div><a id="1731631824.703779"><img src="https://secure.gravatar.com/avatar/9f8196b3226c3638b967ba586ad7484f.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" /></a><div class="message"><div class="username">tien.xuan.vo</div><a style="text-decoration: none" href="#1731631824.703779" ><div class="time">2024-11-15 00:50</div></a><div class="msg">&gt;  Or are you running this in docker with the wrong architecture? I.e. XF86 distribution on a ARM64 Apple Mac?
Look like this is what happened

<a href="https://github.com/pact-foundation/pact-php/issues/692">https://github.com/pact-foundation/pact-php/issues/692</a></div></div></div><br/>
<div><a id="1738017482.975039"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017482.975039" ><div class="time">2025-01-27 22:38</div></a><div class="msg">Are there any matcher limitations for query parameters?

I'm setting up a test for PactSwift implementation verifying interactions with query parameters where I'm sending (as per <a href="https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md">https://github.com/pact-foundation/pact-reference/blob/master/rust/pact_ffi/IntegrationJson.md</a>):
```"{\"value\":\"12:12\",\"pact:matcher:type\":\"time\",\"format\":\"HH:mm\"}"```
Into `pactffi_with_query_parameter_v2`

When sent `GET  /interaction?value=10:12`

`pactffi` is complaining with:
```{
  "Request-Mismatch": {
    "method": "GET",
    "path": "/interaction",
    "query": {
      "item": ["10:12"]
    },
    "headers": {
      "host": ["127.0.0.1:5772"],
      "accept-language": ["en-AU", "en;q=0.9"],
      "connection": ["keep-alive"],
      "user-agent": ["xctest/23600 CFNetwork/1568.300.101 Darwin/24.2.0"],
      "accept-encoding": ["gzip", "deflate"],
      "accept": ["*/*"]},
      "body": "Empty",
      "matching_rules": { "rules": {} },    # ?????
      "generators": { "categories": {} }
    }
}```
because `matching_rules`  is missing the matcher value I sent through to FFI.

Both `.v3` and `.v4`

Coming back to this after a very long time time away, so I'm a bit rusty (no pun intended).</div></div></div><br/>
<div><a id="1738017549.353449"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738017549.353449" ><div class="time">2025-01-27 22:39</div></a><div class="msg">Sir! Long time!</div></div></div><br/>
<div><a id="1738017592.685399"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738017592.685399" ><div class="time">2025-01-27 22:39</div></a><div class="msg">There should not be any difference with how matchers on query parameters are handled</div></div></div><br/>
<div><a id="1738017636.060499"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017636.060499" ><div class="time">2025-01-27 22:40</div></a><div class="msg">:wave:

hmm? I?ll dig deeper then, thanks.</div></div></div><br/>
<div><a id="1738017681.042329"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738017681.042329" ><div class="time">2025-01-27 22:41</div></a><div class="msg">Check the debug logs if you can</div></div></div><br/>
<div><a id="1738017689.598749"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017689.598749" ><div class="time">2025-01-27 22:41</div></a><div class="msg">no idea what I'm doing</div></div></div><br/>
<div><a id="1738017708.952489"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017708.952489" ><div class="time">2025-01-27 22:41</div></a><div class="msg">I have debug logs? lots of logs? amazing logs? can?t be bothered reading</div></div></div><br/>
<div><a id="1738017742.662859"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017742.662859" ><div class="time">2025-01-27 22:42</div></a><div class="msg">anyway, picked it up again after almost a year not touching it, a huuuuge refactor and changed DSL so? still chasing my own tail here</div></div></div><br/>
<div><a id="1738017910.003649"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017910.003649" ><div class="time">2025-01-27 22:45</div></a><div class="msg">```2025-01-27T22:22:54.111138Z DEBUG tokio-runtime-worker pact_matching: --&gt; Mismatches: [QueryMismatch { parameter: "$.item", expected: "[\"12:12\"]", actual: "[\"10:12\"]", mismatch: "Unable to match [\"12:12\"] using Time(\"HH:mm\")" }]```
This one confuses me, 'cause I do see the matcher being set `RuleList { rules: [Time("HH:mm")], rule_logic: And, cascaded: false }}` but then it fails with query mismatch :neutral_face:  when verifying</div></div></div><br/>
<div><a id="1738017994.829969"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738017994.829969" ><div class="time">2025-01-27 22:46</div></a><div class="msg">I mean...

```Request did not match: Request did not match - HTTP Request ( method: GET, path: /interaction, query: Some({"item": [Some("12:12")]}), headers: None, body: Missing )    0) Unable to match ["12:12"] using Time("HH:mm")```
A bit rude tbh</div></div></div><br/>
<div><a id="1738018416.280829"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738018416.280829" ><div class="time">2025-01-27 22:53</div></a><div class="msg">That is rude.</div></div></div><br/>
<div><a id="1738018466.954579"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738018466.954579" ><div class="time">2025-01-27 22:54</div></a><div class="msg">I mean, that does look like a very timely value.</div></div></div><br/>
<div><a id="1738018609.706639"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738018609.706639" ><div class="time">2025-01-27 22:56</div></a><div class="msg">I think it is a bug with that matcher, it doesn't like time without seconds</div></div></div><br/>
<div><a id="1738018654.420619"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738018654.420619" ><div class="time">2025-01-27 22:57</div></a><div class="msg">oh cheeky cheeky</div></div></div><br/>
<div><a id="1738018714.475439"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738018714.475439" ><div class="time">2025-01-27 22:58</div></a><div class="msg">want me to raise an issue on github?</div></div></div><br/>
<div><a id="1738018748.288649"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738018748.288649" ><div class="time">2025-01-27 22:59</div></a><div class="msg">Yeah, that would be great</div></div></div><br/>
<div><a id="1738021265.800169"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738021265.800169" ><div class="time">2025-01-27 23:41</div></a><div class="msg"><a href="https://github.com/pact-foundation/pact-reference/issues/483">https://github.com/pact-foundation/pact-reference/issues/483</a></div></div></div><br/>
<div><a id="1738034708.967769"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738034708.967769" ><div class="time">2025-01-28 03:25</div></a><div class="msg">ok, I doubt it's `pactffi` issue now with matchers, but...

Pact setup:
```RefCell { 
  value: PactHandleInner { 
    pact: V4Pact { 
      consumer: Consumer { name: "Consumer" }, 
      provider: Provider { name: "Provider" }, 
      interactions: [
        SynchronousHttp { 
          id: None, 
          key: None, 
          description: "an interaction with query item matcher 'includes'", 
          provider_states: [], 
          request: HttpRequest { 
            method: "GET", 
            path: "/interaction", 
            query: Some({"item": [Some("sub")]}), 
            headers: None, 
            body: Missing, 
            matching_rules: MatchingRules { 
              rules: {
                PATH: MatchingRuleCategory { name: PATH, rules: {} }, 
                QUERY: MatchingRuleCategory { name: QUERY, rules: {
                  DocPath { 
                    path_tokens: [Root, Field("item")], 
                    expr: "$.item" 
                  }: 
                  RuleList { 
                    rules: [Include("sub")], 
                    rule_logic: And, 
                    cascaded: false 
                  }
                } 
              }
            } 
          }, 
          generators: Generators { categories: {} } }, 
          response: HttpResponse { 
            status: 200, 
            headers: None, 
            body: Missing, 
            matching_rules: MatchingRules { rules: {} }, 
            generators: Generators { categories: {} } }, 
            comments: {}, 
            pending: false, 
            plugin_config: {}, 
            interaction_markup: InteractionMarkup { markup: "", markup_type: "" }, 
            transport: None 
          }
        ], 
      metadata: {
        "namespace1": Object {"name1": String("value1")}, 
        "namespace2": Object {"name2": String("value2")}, 
        "pactRust": Object {"ffi": String("0.4.25")}
      }, 
      plugin_data: [] 
    }, 
    mock_server_started: true, 
    specification_version: V4 
  } 
}```
Simple GET request
```----------------------------------------------------------------------------------------
       method: GET
       path: /interaction
       query: Some({"item": [Some("substring")]})
       headers: Some({"accept-language": ["en-AU", "en;q=0.9"], "user-agent": ["xctest/23600 CFNetwork/1568.300.101 Darwin/24.2.0"], "host": ["127.0.0.1:4658"], "accept-encoding": ["gzip", "deflate"], "connection": ["keep-alive"], "accept": ["*/*"]})
       body: Empty
      ----------------------------------------------------------------------------------------```

Failing to verify
```QueryMismatch: Unable to match ["sub"] using Include("sub")
  Expected: ["sub"]
  Actual: ["substring"]
  Parameter: $.item])"```
</div></div></div><br/>
<div><a id="1738034801.844029"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738034801.844029" ><div class="time">2025-01-28 03:26</div></a><div class="msg">Backstory, I've had a major refactor on the back burner for almost 2 years now and some of the tests written already set various matchers for query parameters. Like `Matcher.bool(true)`  which doesn't make sense in URL query parameters, but hey, I'm _fixing_ it now.</div></div></div><br/>
<div><a id="1738034838.177449"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738034838.177449" ><div class="time">2025-01-28 03:27</div></a><div class="msg">But am getting a bit frustrated with these unable to match includes "sub" in "substring" :neutral_face:</div></div></div><br/>
<div><a id="1738034863.853059"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738034863.853059" ><div class="time">2025-01-28 03:27</div></a><div class="msg">any ideas what I am doing wrong are much appreciated</div></div></div><br/>
<div><a id="1738035225.683349"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738035225.683349" ><div class="time">2025-01-28 03:33</div></a><div class="msg">Gah! Another one.</div></div></div><br/>
<div><a id="1738035234.404109"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738035234.404109" ><div class="time">2025-01-28 03:33</div></a><div class="msg">I hope not</div></div></div><br/>
<div><a id="1738035236.872689"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738035236.872689" ><div class="time">2025-01-28 03:33</div></a><div class="msg">Tells how well used these are</div></div></div><br/>
<div><a id="1738035245.356099"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738035245.356099" ><div class="time">2025-01-28 03:34</div></a><div class="msg">:sweat_smile:</div></div></div><br/>
<div><a id="1738035271.420829"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738035271.420829" ><div class="time">2025-01-28 03:34</div></a><div class="msg">should I just redirect myself to github issues?</div></div></div><br/>
<div><a id="1738036107.214639"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738036107.214639" ><div class="time">2025-01-28 03:48</div></a><div class="msg">Yeah</div></div></div><br/>
<div><a id="1738036145.586459"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738036145.586459" ><div class="time">2025-01-28 03:49</div></a><div class="msg">Or you can go back to what you have been doing for the last year and we can pretend we never saw these.</div></div></div><br/>
<div><a id="1738036159.487859"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738036159.487859" ><div class="time">2025-01-28 03:49</div></a><div class="msg">have yet another one, sorry :shrug:, this time a false positive:

```RefCell { 
  value: PactHandleInner { 
    pact: V4Pact { 
      consumer: Consumer { name: "Consumer" }, 
      provider: Provider { name: "Provider" }, 
      interactions: [ 
        SynchronousHttp { 
          id: None, 
          key: None,
          description: "a request for a known path with a body matching number", 
          provider_states: [], 
          request: HttpRequest { 
            method: "POST", 
            path: "/jsonbody", 
            query: None, 
            headers: Some({"Content-Type": ["application/json"]}), 
            
            body: Present(
             b"{\"key1\":123.1,\"key2\":321}", 
             Some(ContentType { main_type: "application", sub_type: "json", attributes: {}, suffix: None }), None
           ),
            
            matching_rules: MatchingRules { rules: {
              PATH: MatchingRuleCategory { name: PATH, rules: {} }, 
              BODY: MatchingRuleCategory { name: BODY, rules: {
                DocPath { 
                  path_tokens: [Root, Field("key2")], expr: "$.key2" 
                }: RuleList { 
                  rules: [Number], 
                  rule_logic: And,
                  cascaded: false 
                }, 
                DocPath { 
                  path_tokens: [Root, Field("key1")], expr: "$.key1" 
                }: RuleList { 
                  rules: [Number], 
                  rule_logic: And, 
                  cascaded: false 
                }, 
                DocPath { path_tokens: [Root], expr: "$" }: RuleList { rules: [Type], rule_logic: And, cascaded: false }} }} 
          }, 
          generators: Generators { categories: {} } }, 
          response: HttpResponse { status: 200, headers: None, body: Missing, matching_rules: MatchingRules { rules: {} }, generators: Generators { categories: {} } }, comments: {}, pending: false, plugin_config: {}, interaction_markup: InteractionMarkup { markup: "", markup_type: "" }, transport: None }], 

metadata: {
  "namespace1": Object {"name1": String("value1")},  
  "namespace2": Object {"name2": String("value2")}, 
  "pactRust": Object {"ffi": String("0.4.25")}}, 
  plugin_data: [] 
}, 
mock_server_started: true, 
specification_version: V4 
} 
}```
Request sending string values instead of expected numbers:
POST /jsonbody
body: `{"key1": "321.1", "key2": "456"}`

```2025-01-28T03:42:33.886570Z INFO tokio-runtime-worker pact_mock_server::hyper_server: Request matched, sending response
2025-01-28T03:42:33.886572Z DEBUG tokio-runtime-worker pact_mock_server::hyper_server: 
     ----------------------------------------------------------------------------------------
      status: 200
      headers: None
      body: Missing
     ----------------------------------------------------------------------------------------```

Should have failed, right?

I mean, matcher said "numeric" value, I sent "string". Something ain't right here.</div></div></div><br/>
<div><a id="1738036217.548709"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738036217.548709" ><div class="time">2025-01-28 03:50</div></a><div class="msg">yup, I like that, that sounds good</div></div></div><br/>
<div><a id="1738036245.416619"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738036245.416619" ><div class="time">2025-01-28 03:50</div></a><div class="msg">I mean, _I_ don't need this working so... why am I making it _our_ problem, right?</div></div></div><br/>
<div><a id="1738036268.565079"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738036268.565079" ><div class="time">2025-01-28 03:51</div></a><div class="msg">I was never here</div></div></div><br/>
<div><a id="1738038360.387799"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738038360.387799" ><div class="time">2025-01-28 04:26</div></a><div class="msg">Raised a couple more. tbh, hope I'm using it wrong</div></div></div><br/>
<div><a id="1738042393.167779"><img src="https://avatars.slack-edge.com/2023-05-18/5280957216389_62abb72cff6ee3137f9a_72.png" /></a><div class="message"><div class="username">surpher</div><a style="text-decoration: none" href="#1738042393.167779" ><div class="time">2025-01-28 05:33</div></a><div class="msg">feel free to ping me here, or in comments, for more info</div></div></div><br/>
<div><a id="1738101360.534019"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1738101360.534019" ><div class="time">2025-01-28 21:56</div></a><div class="msg">I can look into these today</div></div></div><br/>
<div><a id="1743524488.590519"><img src="https://secure.gravatar.com/avatar/389c39ecd3db515eceb92edf0732b501.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png" /></a><div class="message"><div class="username">feisal.ahmad</div><a style="text-decoration: none" href="#1743524488.590519" ><div class="time">2025-04-01 16:21</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1743526336.900179"><img src="https://avatars.slack-edge.com/2023-03-21/4985733134610_360f302037b877a18bff_72.png" /></a><div class="message"><div class="username">jo.laing</div><a style="text-decoration: none" href="#1743526336.900179" ><div class="time">2025-04-01 16:52</div></a><div class="msg">has joined #libpact_ffi-users</div></div></div><br/>
<div><a id="1743545553.337289"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1743545553.337289" ><div class="time">2025-04-01 22:12</div></a><div class="msg">I'll have to investigate that, `arrayContains` is a tricky matching rule to get right</div></div></div><br/>
<div><a id="1743545569.362679"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1743545569.362679" ><div class="time">2025-04-01 22:12</div></a><div class="msg">Can you raise a GitHub issue for that?</div></div></div><br/>
<div><a id="1743545600.148589"><img src="https://secure.gravatar.com/avatar/389c39ecd3db515eceb92edf0732b501.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png" /></a><div class="message"><div class="username">feisal.ahmad</div><a style="text-decoration: none" href="#1743545600.148589" ><div class="time">2025-04-01 22:13</div></a><div class="msg">Sure thing</div></div></div><br/>
<div><a id="1743613599.222569"><img src="https://secure.gravatar.com/avatar/389c39ecd3db515eceb92edf0732b501.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0011-72.png" /></a><div class="message"><div class="username">feisal.ahmad</div><a style="text-decoration: none" href="#1743613599.222569" ><div class="time">2025-04-02 17:06</div></a><div class="msg">@rholshausen I?ve created an issue for it <a href="https://github.com/pact-foundation/pact-reference/issues/491">https://github.com/pact-foundation/pact-reference/issues/491</a></div></div></div><br/>
<div><a id="1751947314.724069"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1751947314.724069" ><div class="time">2025-07-08 04:01</div></a><div class="msg">Hi
According to the documentation of this method -&gt; <a href="https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_add_provider_transport.html">https://docs.rs/pact_ffi/latest/pact_ffi/verifier/fn.pactffi_verifier_add_provider_transport.html</a>, if i set the protocol to ?message?, it will pick up only the message pacts right? Or will the verification also pick up http pacts as well for that provider ?</div></div></div><br/>
<div><a id="1751950292.634589"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1751950292.634589" ><div class="time">2025-07-08 04:51</div></a><div class="msg">That is not a filter, it will try verify all pacts that are provided via a source. Depending on what interactions are found, it will use the configured transports to determine how to verify them.</div></div></div><br/>
<div><a id="1751950340.092319"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1751950340.092319" ><div class="time">2025-07-08 04:52</div></a><div class="msg">So it it gets both HTTP and message interactions, it will try verify both types.</div></div></div><br/>
<div><a id="1751951456.759339"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1751951456.759339" ><div class="time">2025-07-08 05:10</div></a><div class="msg">oh, and so there isn?t any functionality to specify to the source and eventually to the verifier that ?run verification for http pacts only? ?</div></div></div><br/>
<div><a id="1751951855.214049"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1751951855.214049" ><div class="time">2025-07-08 05:17</div></a><div class="msg">No, but there is filtering for consumer or provider name, description, or provider states. If the message interaction has a distinct description or provider state, you can filter on that.</div></div></div><br/>
<div><a id="1751952290.891779"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1751952290.891779" ><div class="time">2025-07-08 05:24</div></a><div class="msg">ok got it, thanks for the quick replies @rholshausen!!

Also i had one more question, what is the protocol here then (message vs http). If i set the `protocol=message`and keep the `scheme=http` , what is the meaning of these two terms when i am verifying a message pact</div></div></div><br/>
<div><a id="1751952525.712029"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1751952525.712029" ><div class="time">2025-07-08 05:28</div></a><div class="msg">Message interactions still use HTTP, but that allows you to specify a different port. With some of the language implementations, HTTP interactions go to the providers port, and message interactions go to a proxy on a different port.</div></div></div><br/>
<div><a id="1751952545.110419"><img src="https://secure.gravatar.com/avatar/3d118b71e69a37138c8e6cf474307507.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0016-72.png" /></a><div class="message"><div class="username">rholshausen</div><a style="text-decoration: none" href="#1751952545.110419" ><div class="time">2025-07-08 05:29</div></a><div class="msg">I think Pact-JS does that.</div></div></div><br/>
<div><a id="1751952707.872179"><img src="https://avatars.slack-edge.com/2023-04-19/5136124493412_67a969f8253ae26fa4cd_72.png" /></a><div class="message"><div class="username">priyaranjanmudliar</div><a style="text-decoration: none" href="#1751952707.872179" ><div class="time">2025-07-08 05:31</div></a><div class="msg">thanks a lot, i think this clears a lot of things for me</div></div></div><br/>
</div></body></html>